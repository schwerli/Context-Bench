{
  "instance_id": "Multi-SWE-Bench__typescript__maintenance__bugfix__0b0f1e0e",
  "original_id": "mui__material-ui-24202",
  "1_model_selected_files": [
    "packages/material-ui/src/useAutocomplete/useAutocomplete.js",
    "packages/material-ui/src/Autocomplete/Autocomplete.js",
    "packages/material-ui/src/Autocomplete/Autocomplete.d.ts",
    "packages/material-ui/src/useAutocomplete/useAutocomplete.d.ts",
    "packages/material-ui-lab/src/Autocomplete/Autocomplete.js"
  ],
  "2_embedding_selected_files": [
    "packages/material-ui/src/Autocomplete/Autocomplete.test.js",
    "packages/material-ui/src/useAutocomplete/useAutocomplete.d.ts",
    "packages/material-ui/src/Autocomplete/Autocomplete.js",
    "packages/material-ui/src/useAutocomplete/useAutocomplete.js",
    "packages/material-ui/src/useAutocomplete/useAutocomplete.spec.ts",
    "packages/material-ui/src/Autocomplete/Autocomplete.d.ts",
    "packages/material-ui-lab/src/Autocomplete/Autocomplete.js",
    "packages/material-ui/src/useAutocomplete/useAutocomplete.test.js",
    "packages/material-ui/src/Select/Select.test.js",
    "packages/material-ui/src/NativeSelect/NativeSelectInput.js",
    "packages/material-ui/src/Select/SelectInput.js",
    "packages/material-ui/src/TextareaAutosize/TextareaAutosize.test.js",
    "packages/material-ui/src/TextareaAutosize/TextareaAutosize.js",
    "packages/material-ui/src/TextareaAutosize/TextareaAutosize.d.ts",
    "packages/material-ui/src/InputBase/InputBase.js",
    "packages/material-ui/src/NativeSelect/NativeSelect.js",
    "packages/material-ui/src/Input/Input.js",
    "packages/material-ui/src/locale/index.ts",
    "packages/material-ui/src/TextField/TextField.js",
    "packages/material-ui/src/InputBase/InputBase.test.js"
  ],
  "3_final_combined_files": [
    "packages/material-ui/src/Autocomplete/Autocomplete.js",
    "packages/material-ui/src/useAutocomplete/useAutocomplete.js",
    "packages/material-ui/src/Autocomplete/Autocomplete.d.ts",
    "packages/material-ui/src/Autocomplete/Autocomplete.test.js",
    "packages/material-ui/src/useAutocomplete/useAutocomplete.d.ts"
  ],
  "4_related_elements": {
    "packages/material-ui/src/Autocomplete/Autocomplete.js": [
      "function: Autocomplete"
    ],
    "packages/material-ui/src/useAutocomplete/useAutocomplete.js": [
      "function: useAutocomplete\nfunction: syncHighlightedIndex\nfunction: validTagIndex\nfunction: handleFocusTag\nfunction: handleKeyDown\nfunction: handleTagDelete\nfunction: getOptionProps\nfunction: changeHighlightedIndex"
    ],
    "packages/material-ui/src/Autocomplete/Autocomplete.d.ts": [
      "function: Autocomplete"
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "packages/material-ui/src/useAutocomplete/useAutocomplete.js": [
          "line: 191\nline: 243\nline: 427\nline: 595\nline: 629\nline: 638\nline: 766\nline: 775\nline: 777\nline: 778\nline: 781\nline: 863\nline: 906\nline: 907\nline: 1002"
        ],
        "packages/material-ui/src/Autocomplete/Autocomplete.js": [
          ""
        ],
        "packages/material-ui/src/Autocomplete/Autocomplete.d.ts": [
          ""
        ]
      },
      "patches": [
        "diff --git a/packages/material-ui/src/useAutocomplete/useAutocomplete.js b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\nindex 7f2482b..b09bc59 100644\n--- a/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n+++ b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n@@ -189,7 +189,7 @@ export default function useAutocomplete(props) {\n         options.filter((option) => {\n           if (\n             filterSelectedOptions &&\n-            (multiple ? value : [value]).some(\n+            (multiple ? (Array.isArray(value) ? value : []) : [value]).some(\n               (value2) => value2 !== null && getOptionSelected(option, value2),\n             )\n           ) {\n@@ -240,7 +240,8 @@ export default function useAutocomplete(props) {\n \n   // Ensure the focusedTag is never inconsistent\n   React.useEffect(() => {\n-    if (multiple && focusedTag > value.length - 1) {\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n+    if (multiple && focusedTag > valueLength - 1) {\n       setFocusedTag(-1);\n       focusTag(-1);\n     }\n@@ -423,7 +424,7 @@ export default function useAutocomplete(props) {\n       return;\n     }\n \n-    const valueItem = multiple ? value[0] : value;\n+    const valueItem = multiple ? (Array.isArray(value) && value.length > 0 ? value[0] : null) : value;\n \n     // The popup is empty, reset\n     if (filteredOptions.length === 0 || valueItem == null) {\n@@ -588,11 +589,12 @@ export default function useAutocomplete(props) {\n     }\n \n     let nextFocus = index;\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n \n     while (true) {\n       // Out of range\n       if (\n-        (direction === 'next' && nextFocus === value.length) ||\n+        (direction === 'next' && nextFocus === valueLength) ||\n         (direction === 'previous' && nextFocus === -1)\n       ) {\n         return -1;\n@@ -622,10 +624,11 @@ export default function useAutocomplete(props) {\n     handleClose(event, 'toggleInput');\n \n     let nextTag = focusedTag;\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n \n     if (focusedTag === -1) {\n       if (inputValue === '' && direction === 'previous') {\n-        nextTag = value.length - 1;\n+        nextTag = valueLength - 1;\n       }\n     } else {\n       nextTag += direction === 'next' ? 1 : -1;\n@@ -634,7 +637,7 @@ export default function useAutocomplete(props) {\n         nextTag = 0;\n       }\n \n-      if (nextTag === value.length) {\n+      if (nextTag === valueLength) {\n         nextTag = -1;\n       }\n     }\n@@ -763,7 +766,7 @@ export default function useAutocomplete(props) {\n             // Avoid the Modal to handle the event.\n             event.stopPropagation();\n             handleClose(event, 'escape');\n-          } else if (clearOnEscape && (inputValue !== '' || (multiple && value.length > 0))) {\n+          } else if (clearOnEscape && (inputValue !== '' || (multiple && (Array.isArray(value) ? value.length : 0) > 0))) {\n             // Avoid Opera to exit fullscreen mode.\n             event.preventDefault();\n             // Avoid the Modal to handle the event.\n@@ -772,13 +775,16 @@ export default function useAutocomplete(props) {\n           }\n           break;\n         case 'Backspace':\n-          if (multiple && inputValue === '' && value.length > 0) {\n-            const index = focusedTag === -1 ? value.length - 1 : focusedTag;\n-            const newValue = value.slice();\n-            newValue.splice(index, 1);\n-            handleValue(event, newValue, 'remove-option', {\n-              option: value[index],\n-            });\n+          {\n+            const valueArray = Array.isArray(value) ? value : [];\n+            if (multiple && inputValue === '' && valueArray.length > 0) {\n+              const index = focusedTag === -1 ? valueArray.length - 1 : focusedTag;\n+              const newValue = valueArray.slice();\n+              newValue.splice(index, 1);\n+              handleValue(event, newValue, 'remove-option', {\n+                option: valueArray[index],\n+              });\n+            }\n           }\n           break;\n         default:\n@@ -860,10 +866,11 @@ export default function useAutocomplete(props) {\n   };\n \n   const handleTagDelete = (index) => (event) => {\n-    const newValue = value.slice();\n+    const valueArray = Array.isArray(value) ? value : [];\n+    const newValue = valueArray.slice();\n     newValue.splice(index, 1);\n     handleValue(event, newValue, 'remove-option', {\n-      option: value[index],\n+      option: valueArray[index],\n     });\n   };\n \n@@ -904,7 +911,8 @@ export default function useAutocomplete(props) {\n   };\n \n   let dirty = freeSolo && inputValue.length > 0;\n-  dirty = dirty || (multiple ? value.length > 0 : value !== null);\n+  const valueLength = Array.isArray(value) ? value.length : 0;\n+  dirty = dirty || (multiple ? valueLength > 0 : value !== null);\n \n   let groupedOptions = filteredOptions;\n   if (groupBy) {\n@@ -999,7 +1007,7 @@ export default function useAutocomplete(props) {\n       },\n     }),\n     getOptionProps: ({ index, option }) => {\n-      const selected = (multiple ? value : [value]).some(\n+      const selected = (multiple ? (Array.isArray(value) ? value : []) : [value]).some(\n         (value2) => value2 != null && getOptionSelected(option, value2),\n       );\n       const disabled = getOptionDisabled ? getOptionDisabled(option) : false;\n",
        "diff --git a/packages/material-ui/src/useAutocomplete/useAutocomplete.js b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\nindex 7f2482b..cbd8b89 100644\n--- a/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n+++ b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n@@ -240,7 +240,8 @@ export default function useAutocomplete(props) {\n \n   // Ensure the focusedTag is never inconsistent\n   React.useEffect(() => {\n-    if (multiple && focusedTag > value.length - 1) {\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n+    if (multiple && focusedTag > valueLength - 1) {\n       setFocusedTag(-1);\n       focusTag(-1);\n     }\n@@ -423,7 +424,7 @@ export default function useAutocomplete(props) {\n       return;\n     }\n \n-    const valueItem = multiple ? value[0] : value;\n+    const valueItem = multiple ? (Array.isArray(value) ? value[0] : null) : value;\n \n     // The popup is empty, reset\n     if (filteredOptions.length === 0 || valueItem == null) {\n@@ -588,11 +589,12 @@ export default function useAutocomplete(props) {\n     }\n \n     let nextFocus = index;\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n \n     while (true) {\n       // Out of range\n       if (\n-        (direction === 'next' && nextFocus === value.length) ||\n+        (direction === 'next' && nextFocus === valueLength) ||\n         (direction === 'previous' && nextFocus === -1)\n       ) {\n         return -1;\n@@ -622,10 +624,11 @@ export default function useAutocomplete(props) {\n     handleClose(event, 'toggleInput');\n \n     let nextTag = focusedTag;\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n \n     if (focusedTag === -1) {\n       if (inputValue === '' && direction === 'previous') {\n-        nextTag = value.length - 1;\n+        nextTag = valueLength - 1;\n       }\n     } else {\n       nextTag += direction === 'next' ? 1 : -1;\n@@ -634,7 +637,7 @@ export default function useAutocomplete(props) {\n         nextTag = 0;\n       }\n \n-      if (nextTag === value.length) {\n+      if (nextTag === valueLength) {\n         nextTag = -1;\n       }\n     }\n@@ -763,7 +766,7 @@ export default function useAutocomplete(props) {\n             // Avoid the Modal to handle the event.\n             event.stopPropagation();\n             handleClose(event, 'escape');\n-          } else if (clearOnEscape && (inputValue !== '' || (multiple && value.length > 0))) {\n+          } else if (clearOnEscape && (inputValue !== '' || (multiple && Array.isArray(value) && value.length > 0))) {\n             // Avoid Opera to exit fullscreen mode.\n             event.preventDefault();\n             // Avoid the Modal to handle the event.\n@@ -772,7 +775,7 @@ export default function useAutocomplete(props) {\n           }\n           break;\n         case 'Backspace':\n-          if (multiple && inputValue === '' && value.length > 0) {\n+          if (multiple && inputValue === '' && Array.isArray(value) && value.length > 0) {\n             const index = focusedTag === -1 ? value.length - 1 : focusedTag;\n             const newValue = value.slice();\n             newValue.splice(index, 1);\n@@ -860,10 +863,12 @@ export default function useAutocomplete(props) {\n   };\n \n   const handleTagDelete = (index) => (event) => {\n-    const newValue = value.slice();\n-    newValue.splice(index, 1);\n+    const newValue = Array.isArray(value) ? value.slice() : [];\n+    if (index >= 0 && index < newValue.length) {\n+      newValue.splice(index, 1);\n+    }\n     handleValue(event, newValue, 'remove-option', {\n-      option: value[index],\n+      option: Array.isArray(value) ? value[index] : undefined,\n     });\n   };\n \n@@ -904,7 +909,7 @@ export default function useAutocomplete(props) {\n   };\n \n   let dirty = freeSolo && inputValue.length > 0;\n-  dirty = dirty || (multiple ? value.length > 0 : value !== null);\n+  dirty = dirty || (multiple ? (Array.isArray(value) && value.length > 0) : value !== null);\n \n   let groupedOptions = filteredOptions;\n   if (groupBy) {\n@@ -999,7 +1004,7 @@ export default function useAutocomplete(props) {\n       },\n     }),\n     getOptionProps: ({ index, option }) => {\n-      const selected = (multiple ? value : [value]).some(\n+      const selected = (multiple ? (Array.isArray(value) ? value : []) : [value]).some(\n         (value2) => value2 != null && getOptionSelected(option, value2),\n       );\n       const disabled = getOptionDisabled ? getOptionDisabled(option) : false;\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "packages/material-ui/src/useAutocomplete/useAutocomplete.js": [
          "line: 243\nline: 426\nline: 595\nline: 627\nline: 637\nline: 774\nline: 775\nline: 862\nline: 865\nline: 907\nline: 1003"
        ],
        "packages/material-ui/src/Autocomplete/Autocomplete.js": [
          ""
        ],
        "packages/material-ui/src/Autocomplete/Autocomplete.d.ts": [
          ""
        ]
      },
      "patches": [
        "diff --git a/packages/material-ui/src/useAutocomplete/useAutocomplete.js b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\nindex 7f2482b..f3ac8d1 100644\n--- a/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n+++ b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n@@ -189,7 +189,7 @@ export default function useAutocomplete(props) {\n         options.filter((option) => {\n           if (\n             filterSelectedOptions &&\n-            (multiple ? value : [value]).some(\n+            (multiple ? (Array.isArray(value) ? value : []) : [value]).some(\n               (value2) => value2 !== null && getOptionSelected(option, value2),\n             )\n           ) {\n@@ -240,7 +240,8 @@ export default function useAutocomplete(props) {\n \n   // Ensure the focusedTag is never inconsistent\n   React.useEffect(() => {\n-    if (multiple && focusedTag > value.length - 1) {\n+    const valueLength = multiple ? (Array.isArray(value) ? value.length : 0) : 0;\n+    if (multiple && focusedTag > valueLength - 1) {\n       setFocusedTag(-1);\n       focusTag(-1);\n     }\n@@ -423,7 +424,7 @@ export default function useAutocomplete(props) {\n       return;\n     }\n \n-    const valueItem = multiple ? value[0] : value;\n+    const valueItem = multiple ? (Array.isArray(value) ? value[0] : null) : value;\n \n     // The popup is empty, reset\n     if (filteredOptions.length === 0 || valueItem == null) {\n@@ -591,8 +592,9 @@ export default function useAutocomplete(props) {\n \n     while (true) {\n       // Out of range\n+      const valueLength = Array.isArray(value) ? value.length : 0;\n       if (\n-        (direction === 'next' && nextFocus === value.length) ||\n+        (direction === 'next' && nextFocus === valueLength) ||\n         (direction === 'previous' && nextFocus === -1)\n       ) {\n         return -1;\n@@ -625,7 +627,8 @@ export default function useAutocomplete(props) {\n \n     if (focusedTag === -1) {\n       if (inputValue === '' && direction === 'previous') {\n-        nextTag = value.length - 1;\n+        const valueLength = Array.isArray(value) ? value.length : 0;\n+        nextTag = valueLength - 1;\n       }\n     } else {\n       nextTag += direction === 'next' ? 1 : -1;\n@@ -634,7 +637,8 @@ export default function useAutocomplete(props) {\n         nextTag = 0;\n       }\n \n-      if (nextTag === value.length) {\n+      const valueLength = Array.isArray(value) ? value.length : 0;\n+      if (nextTag === valueLength) {\n         nextTag = -1;\n       }\n     }\n@@ -763,7 +767,7 @@ export default function useAutocomplete(props) {\n             // Avoid the Modal to handle the event.\n             event.stopPropagation();\n             handleClose(event, 'escape');\n-          } else if (clearOnEscape && (inputValue !== '' || (multiple && value.length > 0))) {\n+          } else if (clearOnEscape && (inputValue !== '' || (multiple && Array.isArray(value) && value.length > 0))) {\n             // Avoid Opera to exit fullscreen mode.\n             event.preventDefault();\n             // Avoid the Modal to handle the event.\n@@ -772,12 +776,13 @@ export default function useAutocomplete(props) {\n           }\n           break;\n         case 'Backspace':\n-          if (multiple && inputValue === '' && value.length > 0) {\n-            const index = focusedTag === -1 ? value.length - 1 : focusedTag;\n-            const newValue = value.slice();\n+          if (multiple && inputValue === '' && Array.isArray(value) && value.length > 0) {\n+            const current = Array.isArray(value) ? value : [];\n+            const index = focusedTag === -1 ? current.length - 1 : focusedTag;\n+            const newValue = current.slice();\n             newValue.splice(index, 1);\n             handleValue(event, newValue, 'remove-option', {\n-              option: value[index],\n+              option: current[index],\n             });\n           }\n           break;\n@@ -860,10 +865,11 @@ export default function useAutocomplete(props) {\n   };\n \n   const handleTagDelete = (index) => (event) => {\n-    const newValue = value.slice();\n+    const current = Array.isArray(value) ? value : [];\n+    const newValue = current.slice();\n     newValue.splice(index, 1);\n     handleValue(event, newValue, 'remove-option', {\n-      option: value[index],\n+      option: current[index],\n     });\n   };\n \n@@ -904,7 +910,8 @@ export default function useAutocomplete(props) {\n   };\n \n   let dirty = freeSolo && inputValue.length > 0;\n-  dirty = dirty || (multiple ? value.length > 0 : value !== null);\n+  const valueLength = multiple ? (Array.isArray(value) ? value.length : 0) : 0;\n+  dirty = dirty || (multiple ? valueLength > 0 : value !== null);\n \n   let groupedOptions = filteredOptions;\n   if (groupBy) {\n@@ -999,7 +1006,7 @@ export default function useAutocomplete(props) {\n       },\n     }),\n     getOptionProps: ({ index, option }) => {\n-      const selected = (multiple ? value : [value]).some(\n+      const selected = (multiple ? (Array.isArray(value) ? value : []) : [value]).some(\n         (value2) => value2 != null && getOptionSelected(option, value2),\n       );\n       const disabled = getOptionDisabled ? getOptionDisabled(option) : false;\n",
        "diff --git a/packages/material-ui/src/useAutocomplete/useAutocomplete.js b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\nindex 7f2482b..5119456 100644\n--- a/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n+++ b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n@@ -240,7 +240,8 @@ export default function useAutocomplete(props) {\n \n   // Ensure the focusedTag is never inconsistent\n   React.useEffect(() => {\n-    if (multiple && focusedTag > value.length - 1) {\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n+    if (multiple && focusedTag > valueLength - 1) {\n       setFocusedTag(-1);\n       focusTag(-1);\n     }\n@@ -423,7 +424,7 @@ export default function useAutocomplete(props) {\n       return;\n     }\n \n-    const valueItem = multiple ? value[0] : value;\n+    const valueItem = multiple ? (Array.isArray(value) ? value[0] : null) : value;\n \n     // The popup is empty, reset\n     if (filteredOptions.length === 0 || valueItem == null) {\n@@ -588,11 +589,12 @@ export default function useAutocomplete(props) {\n     }\n \n     let nextFocus = index;\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n \n     while (true) {\n       // Out of range\n       if (\n-        (direction === 'next' && nextFocus === value.length) ||\n+        (direction === 'next' && nextFocus === valueLength) ||\n         (direction === 'previous' && nextFocus === -1)\n       ) {\n         return -1;\n@@ -622,10 +624,11 @@ export default function useAutocomplete(props) {\n     handleClose(event, 'toggleInput');\n \n     let nextTag = focusedTag;\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n \n     if (focusedTag === -1) {\n       if (inputValue === '' && direction === 'previous') {\n-        nextTag = value.length - 1;\n+        nextTag = valueLength - 1;\n       }\n     } else {\n       nextTag += direction === 'next' ? 1 : -1;\n@@ -634,7 +637,7 @@ export default function useAutocomplete(props) {\n         nextTag = 0;\n       }\n \n-      if (nextTag === value.length) {\n+      if (nextTag === valueLength) {\n         nextTag = -1;\n       }\n     }\n@@ -763,7 +766,7 @@ export default function useAutocomplete(props) {\n             // Avoid the Modal to handle the event.\n             event.stopPropagation();\n             handleClose(event, 'escape');\n-          } else if (clearOnEscape && (inputValue !== '' || (multiple && value.length > 0))) {\n+          } else if (clearOnEscape && (inputValue !== '' || (multiple && Array.isArray(value) && value.length > 0))) {\n             // Avoid Opera to exit fullscreen mode.\n             event.preventDefault();\n             // Avoid the Modal to handle the event.\n@@ -772,13 +775,16 @@ export default function useAutocomplete(props) {\n           }\n           break;\n         case 'Backspace':\n-          if (multiple && inputValue === '' && value.length > 0) {\n-            const index = focusedTag === -1 ? value.length - 1 : focusedTag;\n-            const newValue = value.slice();\n-            newValue.splice(index, 1);\n-            handleValue(event, newValue, 'remove-option', {\n-              option: value[index],\n-            });\n+          {\n+            const valueLength = Array.isArray(value) ? value.length : 0;\n+            if (multiple && inputValue === '' && valueLength > 0) {\n+              const index = focusedTag === -1 ? valueLength - 1 : focusedTag;\n+              const newValue = Array.isArray(value) ? value.slice() : [];\n+              newValue.splice(index, 1);\n+              handleValue(event, newValue, 'remove-option', {\n+                option: Array.isArray(value) ? value[index] : undefined,\n+              });\n+            }\n           }\n           break;\n         default:\n@@ -860,10 +866,10 @@ export default function useAutocomplete(props) {\n   };\n \n   const handleTagDelete = (index) => (event) => {\n-    const newValue = value.slice();\n+    const newValue = Array.isArray(value) ? value.slice() : [];\n     newValue.splice(index, 1);\n     handleValue(event, newValue, 'remove-option', {\n-      option: value[index],\n+      option: Array.isArray(value) ? value[index] : undefined,\n     });\n   };\n \n@@ -904,7 +910,7 @@ export default function useAutocomplete(props) {\n   };\n \n   let dirty = freeSolo && inputValue.length > 0;\n-  dirty = dirty || (multiple ? value.length > 0 : value !== null);\n+  dirty = dirty || (multiple ? (Array.isArray(value) && value.length > 0) : value !== null);\n \n   let groupedOptions = filteredOptions;\n   if (groupBy) {\n@@ -999,7 +1005,7 @@ export default function useAutocomplete(props) {\n       },\n     }),\n     getOptionProps: ({ index, option }) => {\n-      const selected = (multiple ? value : [value]).some(\n+      const selected = ((multiple ? (Array.isArray(value) ? value : []) : [value])).some(\n         (value2) => value2 != null && getOptionSelected(option, value2),\n       );\n       const disabled = getOptionDisabled ? getOptionDisabled(option) : false;\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/packages/material-ui/src/useAutocomplete/useAutocomplete.js b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\nindex 7f2482b..b09bc59 100644\n--- a/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n+++ b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n@@ -189,7 +189,7 @@ export default function useAutocomplete(props) {\n         options.filter((option) => {\n           if (\n             filterSelectedOptions &&\n-            (multiple ? value : [value]).some(\n+            (multiple ? (Array.isArray(value) ? value : []) : [value]).some(\n               (value2) => value2 !== null && getOptionSelected(option, value2),\n             )\n           ) {\n@@ -240,7 +240,8 @@ export default function useAutocomplete(props) {\n \n   // Ensure the focusedTag is never inconsistent\n   React.useEffect(() => {\n-    if (multiple && focusedTag > value.length - 1) {\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n+    if (multiple && focusedTag > valueLength - 1) {\n       setFocusedTag(-1);\n       focusTag(-1);\n     }\n@@ -423,7 +424,7 @@ export default function useAutocomplete(props) {\n       return;\n     }\n \n-    const valueItem = multiple ? value[0] : value;\n+    const valueItem = multiple ? (Array.isArray(value) && value.length > 0 ? value[0] : null) : value;\n \n     // The popup is empty, reset\n     if (filteredOptions.length === 0 || valueItem == null) {\n@@ -588,11 +589,12 @@ export default function useAutocomplete(props) {\n     }\n \n     let nextFocus = index;\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n \n     while (true) {\n       // Out of range\n       if (\n-        (direction === 'next' && nextFocus === value.length) ||\n+        (direction === 'next' && nextFocus === valueLength) ||\n         (direction === 'previous' && nextFocus === -1)\n       ) {\n         return -1;\n@@ -622,10 +624,11 @@ export default function useAutocomplete(props) {\n     handleClose(event, 'toggleInput');\n \n     let nextTag = focusedTag;\n+    const valueLength = Array.isArray(value) ? value.length : 0;\n \n     if (focusedTag === -1) {\n       if (inputValue === '' && direction === 'previous') {\n-        nextTag = value.length - 1;\n+        nextTag = valueLength - 1;\n       }\n     } else {\n       nextTag += direction === 'next' ? 1 : -1;\n@@ -634,7 +637,7 @@ export default function useAutocomplete(props) {\n         nextTag = 0;\n       }\n \n-      if (nextTag === value.length) {\n+      if (nextTag === valueLength) {\n         nextTag = -1;\n       }\n     }\n@@ -763,7 +766,7 @@ export default function useAutocomplete(props) {\n             // Avoid the Modal to handle the event.\n             event.stopPropagation();\n             handleClose(event, 'escape');\n-          } else if (clearOnEscape && (inputValue !== '' || (multiple && value.length > 0))) {\n+          } else if (clearOnEscape && (inputValue !== '' || (multiple && (Array.isArray(value) ? value.length : 0) > 0))) {\n             // Avoid Opera to exit fullscreen mode.\n             event.preventDefault();\n             // Avoid the Modal to handle the event.\n@@ -772,13 +775,16 @@ export default function useAutocomplete(props) {\n           }\n           break;\n         case 'Backspace':\n-          if (multiple && inputValue === '' && value.length > 0) {\n-            const index = focusedTag === -1 ? value.length - 1 : focusedTag;\n-            const newValue = value.slice();\n-            newValue.splice(index, 1);\n-            handleValue(event, newValue, 'remove-option', {\n-              option: value[index],\n-            });\n+          {\n+            const valueArray = Array.isArray(value) ? value : [];\n+            if (multiple && inputValue === '' && valueArray.length > 0) {\n+              const index = focusedTag === -1 ? valueArray.length - 1 : focusedTag;\n+              const newValue = valueArray.slice();\n+              newValue.splice(index, 1);\n+              handleValue(event, newValue, 'remove-option', {\n+                option: valueArray[index],\n+              });\n+            }\n           }\n           break;\n         default:\n@@ -860,10 +866,11 @@ export default function useAutocomplete(props) {\n   };\n \n   const handleTagDelete = (index) => (event) => {\n-    const newValue = value.slice();\n+    const valueArray = Array.isArray(value) ? value : [];\n+    const newValue = valueArray.slice();\n     newValue.splice(index, 1);\n     handleValue(event, newValue, 'remove-option', {\n-      option: value[index],\n+      option: valueArray[index],\n     });\n   };\n \n@@ -904,7 +911,8 @@ export default function useAutocomplete(props) {\n   };\n \n   let dirty = freeSolo && inputValue.length > 0;\n-  dirty = dirty || (multiple ? value.length > 0 : value !== null);\n+  const valueLength = Array.isArray(value) ? value.length : 0;\n+  dirty = dirty || (multiple ? valueLength > 0 : value !== null);\n \n   let groupedOptions = filteredOptions;\n   if (groupBy) {\n@@ -999,7 +1007,7 @@ export default function useAutocomplete(props) {\n       },\n     }),\n     getOptionProps: ({ index, option }) => {\n-      const selected = (multiple ? value : [value]).some(\n+      const selected = (multiple ? (Array.isArray(value) ? value : []) : [value]).some(\n         (value2) => value2 != null && getOptionSelected(option, value2),\n       );\n       const disabled = getOptionDisabled ? getOptionDisabled(option) : false;\n",
  "7_resolved": false
}