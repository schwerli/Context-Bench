{
  "instance_id": "Multi-SWE-Bench__typescript__maintenance__bugfix__1ac0bb81",
  "original_id": "mui__material-ui-33692",
  "1_model_selected_files": [
    "packages/mui-codemod/codemod.js",
    "packages/mui-codemod/src/util/getJSExports.js",
    "packages/mui-codemod/src/util/readFile.js",
    "packages/mui-codemod/src/util/propsToObject.js",
    "packages/mui-codemod/src/util/memoize.js"
  ],
  "2_embedding_selected_files": [
    "packages/mui-codemod/src/v5.0.0/variant-prop.test.js",
    "packages/mui-codemod/src/v5.0.0/variant-prop.js",
    "packages/mui-codemod/src/v5.0.0/variant-prop.test/expected.js",
    "packages/mui-codemod/src/v5.0.0/chip-variant-prop.test.js",
    "packages/mui-codemod/src/v5.0.0/skeleton-variant.test.js",
    "packages/mui-codemod/src/v5.0.0/variant-prop.test/actual.js",
    "packages/mui-codemod/src/v5.0.0/variant-prop.test/mui-import.expected.js",
    "packages/mui-codemod/src/v5.0.0/component-rename-prop.test.js",
    "packages/mui-codemod/src/v5.0.0/button-color-prop.test.js",
    "packages/mui-codemod/src/v5.0.0/fab-variant.test.js",
    "packages/mui-codemod/src/v5.0.0/modal-props.test.js",
    "packages/mui-codemod/src/v5.0.0/material-ui-styles.test.js",
    "packages/mui-codemod/src/v5.0.0/variant-prop.test/mui-import.actual.js",
    "packages/mui-codemod/src/v5.0.0/mui-replace.test.js",
    "packages/mui-codemod/src/v5.0.0/material-ui-types.test.js",
    "packages/mui-codemod/src/v5.0.0/circularprogress-variant.test.js",
    "packages/mui-codemod/src/v5.0.0/theme-options.test.js",
    "packages/mui-codemod/src/v5.0.0/dialog-props.test.js",
    "packages/mui-codemod/src/v5.0.0/theme-typography-round.test.js",
    "packages/mui-codemod/src/v5.0.0/table-props.test.js",
    "packages/mui-codemod/src/v5.0.0/theme-palette-mode.test.js",
    "packages/mui-codemod/src/v5.0.0/dialog-title-props.test.js",
    "packages/mui-codemod/src/v5.0.0/use-transitionprops.test.js",
    "packages/mui-codemod/src/v5.0.0/box-sx-prop.test.js",
    "packages/mui-codemod/src/v5.0.0/box-rename-css.test.js",
    "packages/mui-codemod/src/v5.0.0/textarea-minmax-rows.test.js",
    "packages/mui-codemod/src/v5.0.0/theme-spacing.test.js",
    "packages/mui-codemod/src/v5.0.0/autocomplete-rename-option.test.js",
    "packages/mui-codemod/src/v5.0.0/mui-replace.test/expected.js",
    "packages/mui-codemod/src/v5.0.0/theme-breakpoints-width.test.js",
    "packages/mui-codemod/src/v5.0.0/chip-variant-prop.test/actual.js",
    "packages/mui-codemod/src/v5.0.0/link-underline-hover.test.js",
    "packages/mui-codemod/src/v5.0.0/badge-overlap-value.test.js",
    "packages/mui-codemod/src/v5.0.0/fade-rename-alpha.test.js",
    "packages/mui-codemod/src/v5.0.0/box-rename-gap.test.js",
    "packages/mui-codemod/src/v5.0.0/autocomplete-rename-closeicon.test.js",
    "packages/mui-codemod/src/v5.0.0/preset-safe.test.js",
    "packages/mui-codemod/codemod.js",
    "packages/mui-codemod/src/v5.0.0/use-autocomplete.test.js",
    "packages/mui-codemod/src/v5.0.0/with-width.test.js",
    "packages/mui-codemod/src/v5.0.0/collapse-rename-collapsedheight.test.js",
    "packages/mui-codemod/src/v5.0.0/grid-justify-justifycontent.test.js",
    "packages/mui-codemod/src/v5.0.0/chip-variant-prop.js",
    "packages/mui-codemod/src/v5.0.0/jss-to-tss-react.test.js",
    "packages/mui-codemod/src/v5.0.0/theme-breakpoints.test.js",
    "packages/mui-codemod/src/v5.0.0/box-borderradius-values.test.js",
    "packages/mui-codemod/src/v5.0.0/mui-replace.test/actual.js",
    "packages/mui-codemod/src/v5.0.0/core-styles-import.test.js",
    "packages/mui-codemod/src/v5.0.0/jss-to-styled.test.js",
    "packages/mui-codemod/src/v5.0.0/root-ref.test.js",
    "packages/mui-codemod/src/v1.0.0/menu-item-primary-text.test.js",
    "packages/mui-codemod/src/v5.0.0/icon-button-size.test.js",
    "packages/mui-codemod/src/v5.0.0/moved-lab-modules.test.js",
    "packages/mui-codemod/src/v5.0.0/create-theme.test.js",
    "packages/mui-codemod/src/v5.0.0/chip-variant-prop.test/expected.js",
    "packages/mui-codemod/src/v5.0.0/date-pickers-moved-to-x.test.js",
    "packages/mui-codemod/src/v5.0.0/transitions.test.js",
    "packages/mui-codemod/src/v5.0.0/preset-safe.js",
    "packages/mui-codemod/src/v5.0.0/avatar-circle-circular.test.js",
    "packages/mui-codemod/src/v5.0.0/grid-list-component.test.js",
    "packages/mui-codemod/src/v5.0.0/adapter-v4.test.js",
    "packages/mui-codemod/src/v5.0.0/tabs-scroll-buttons.test.js",
    "packages/mui-codemod/src/v5.0.0/expansion-panel-component.test.js",
    "packages/mui-codemod/src/v5.0.0/styled-engine-provider.test.js",
    "packages/mui-codemod/src/v5.0.0/top-level-imports.test.js",
    "packages/mui-codemod/src/v5.0.0/component-rename-prop.test/expected.js",
    "packages/mui-codemod/src/v4.0.0/theme-spacing-api.test.js",
    "packages/mui-codemod/src/v5.0.0/modal-props.js",
    "packages/mui-codemod/src/v5.0.0/material-ui-styles.test/expected.js",
    "packages/mui-codemod/src/v5.0.0/with-mobile-dialog.test.js",
    "packages/mui-codemod/src/v5.0.0/theme-provider.test.js",
    "packages/mui-codemod/src/v5.0.0/skeleton-variant.test/actual.js",
    "packages/mui-codemod/src/v5.0.0/component-rename-prop.test/actual.js",
    "packages/mui-codemod/src/v4.0.0/top-level-imports.test.js",
    "packages/mui-codemod/src/v5.0.0/skeleton-variant.test/expected.js",
    "packages/mui-codemod/src/v5.0.0/preset-safe.test/expected.js",
    "packages/mui-codemod/src/v5.0.0/jss-to-styled.test/multipleWithStyles.expected.js",
    "packages/mui-codemod/src/v5.0.0/skeleton-variant.js",
    "packages/mui-codemod/src/v5.0.0/fab-variant.test/actual.js",
    "packages/mui-codemod/src/v5.0.0/optimal-imports.test.js",
    "packages/mui-codemod/src/v4.0.0/optimal-imports.test.js",
    "packages/mui-codemod/src/v5.0.0/box-rename-css.test/actual.js"
  ],
  "3_final_combined_files": [
    "packages/mui-codemod/codemod.js",
    "packages/mui-codemod/src/util/getJSExports.js",
    "packages/mui-codemod/src/util/readFile.js",
    "packages/mui-codemod/src/v5.0.0/variant-prop.test.js",
    "packages/mui-codemod/src/v5.0.0/variant-prop.js",
    "packages/mui-codemod/src/v5.0.0/variant-prop.test/expected.js"
  ],
  "4_related_elements": {
    "packages/mui-codemod/codemod.js": [
      "function: runTransform\nfunction: run\nvariable: jscodeshiftDirectory\nvariable: jscodeshiftExecutable"
    ],
    "packages/mui-codemod/src/util/getJSExports.js": [
      "function: getJSExports"
    ],
    "packages/mui-codemod/src/util/readFile.js": [
      "function: readFile"
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "packages/mui-codemod/codemod.js": [
          "line: 45"
        ],
        "packages/mui-codemod/src/util/getJSExports.js": [
          "line: 9\nline: 10\nline: 11\nline: 13\nline: 14\nline: 15\nline: 16\nline: 17"
        ],
        "packages/mui-codemod/src/util/readFile.js": [
          ""
        ]
      },
      "patches": [
        "diff --git a/packages/mui-codemod/src/util/getJSExports.js b/packages/mui-codemod/src/util/getJSExports.js\nindex 633018d..b6f4d7a 100644\n--- a/packages/mui-codemod/src/util/getJSExports.js\n+++ b/packages/mui-codemod/src/util/getJSExports.js\n@@ -1,3 +1,4 @@\n+\n import { readFileSync } from 'fs';\n import { parseSync } from '@babel/core';\n import traverse from '@babel/traverse';\n@@ -8,8 +9,20 @@ const getJSExports = memoize((file) => {\n \n   const ast = parseSync(readFileSync(file, 'utf8'), {\n     filename: file,\n+    // Ensure we can parse package source without relying on user Babel config\n+    babelrc: false,\n+    configFile: false,\n+    parserOpts: {\n+      sourceType: 'module',\n+      // Material packages compile to ESM; be permissive for parsing\n+      plugins: ['jsx', 'typescript', 'exportDefaultFrom'],\n+    },\n   });\n \n+  if (!ast) {\n+    return result;\n+  }\n+\n   traverse(ast, {\n     ExportSpecifier: ({ node: { exported } }) => {\n       result.add(exported.name);\n@@ -19,4 +32,4 @@ const getJSExports = memoize((file) => {\n   return result;\n });\n \n-export default getJSExports;\n+export default getJSExports;\n",
        "diff --git a/packages/mui-codemod/src/util/getJSExports.js b/packages/mui-codemod/src/util/getJSExports.js\nindex 633018d..2197702 100644\n--- a/packages/mui-codemod/src/util/getJSExports.js\n+++ b/packages/mui-codemod/src/util/getJSExports.js\n@@ -1,3 +1,4 @@\n+\n import { readFileSync } from 'fs';\n import { parseSync } from '@babel/core';\n import traverse from '@babel/traverse';\n@@ -6,17 +7,46 @@ import memoize from './memoize';\n const getJSExports = memoize((file) => {\n   const result = new Set();\n \n-  const ast = parseSync(readFileSync(file, 'utf8'), {\n+  const src = readFileSync(file, 'utf8');\n+\n+  const ast = parseSync(src, {\n     filename: file,\n+    sourceType: 'module',\n+    // Ensure we can parse modern syntax used in index files (TS/JSX and re-export syntaxes)\n+    plugins: ['jsx', 'typescript', 'exportDefaultFrom', 'exportNamespaceFrom'],\n   });\n \n+  if (!ast) {\n+    return result;\n+  }\n+\n   traverse(ast, {\n-    ExportSpecifier: ({ node: { exported } }) => {\n-      result.add(exported.name);\n+    // Collect named exports like `export { default as TextField } from './TextField'`\n+    ExportNamedDeclaration(path) {\n+      const { node } = path;\n+      if (node.specifiers && node.specifiers.length > 0) {\n+        node.specifiers.forEach((spec) => {\n+          if (spec.exported && spec.exported.name) {\n+            result.add(spec.exported.name);\n+          }\n+        });\n+      } else if (node.declaration) {\n+        // Handle declarations like `export const Foo = ...`\n+        const decl = node.declaration;\n+        if (decl.id && decl.id.name) {\n+          result.add(decl.id.name);\n+        } else if (Array.isArray(decl.declarations)) {\n+          decl.declarations.forEach((d) => {\n+            if (d.id && d.id.name) {\n+              result.add(d.id.name);\n+            }\n+          });\n+        }\n+      }\n     },\n   });\n \n   return result;\n });\n \n-export default getJSExports;\n+export default getJSExports;\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "packages/mui-codemod/src/util/getJSExports.js": [
          "function: getJSExports\nline: 9\nline: 10\nline: 11\nline: 13\nline: 14\nline: 15\nline: 16\nline: 17"
        ],
        "packages/mui-codemod/codemod.js": [
          "function: runTransform\nline: 45"
        ],
        "packages/mui-codemod/src/util/readFile.js": [
          ""
        ]
      },
      "patches": [
        "diff --git a/packages/mui-codemod/src/util/getJSExports.js b/packages/mui-codemod/src/util/getJSExports.js\nindex 633018d..69dca7a 100644\n--- a/packages/mui-codemod/src/util/getJSExports.js\n+++ b/packages/mui-codemod/src/util/getJSExports.js\n@@ -1,3 +1,4 @@\n+\n import { readFileSync } from 'fs';\n import { parseSync } from '@babel/core';\n import traverse from '@babel/traverse';\n@@ -6,17 +7,64 @@ import memoize from './memoize';\n const getJSExports = memoize((file) => {\n   const result = new Set();\n \n-  const ast = parseSync(readFileSync(file, 'utf8'), {\n-    filename: file,\n-  });\n+  const code = readFileSync(file, 'utf8');\n+\n+  let ast;\n+  try {\n+    ast = parseSync(code, {\n+      filename: file,\n+      // Ensure Babel parses ESM and doesn't depend on the consumer's babel config\n+      sourceType: 'module',\n+      babelrc: false,\n+      configFile: false,\n+      // Support common syntax that might appear in files we analyze\n+      plugins: [\n+        'jsx',\n+        'typescript',\n+        'classProperties',\n+        'exportDefaultFrom',\n+        'exportNamespaceFrom',\n+      ],\n+    });\n+  } catch (e) {\n+    // If parsing fails, return what we have (empty set). Callers should handle empty result.\n+    return result;\n+  }\n+\n+  if (!ast) {\n+    return result;\n+  }\n \n   traverse(ast, {\n     ExportSpecifier: ({ node: { exported } }) => {\n-      result.add(exported.name);\n+      if (exported && exported.name) {\n+        result.add(exported.name);\n+      }\n+    },\n+    // Also handle named declarations like `export const Foo = ...` or `export function Bar() {}`\n+    ExportNamedDeclaration: ({ node }) => {\n+      const { declaration } = node;\n+      if (!declaration) {\n+        return;\n+      }\n+\n+      // function/class declarations: `export function Foo() {}` / `export class Foo {}`\n+      if (declaration.id && declaration.id.name) {\n+        result.add(declaration.id.name);\n+      }\n+\n+      // variable declarations: `export const Foo = ... , Bar = ...;`\n+      if (declaration.declarations && Array.isArray(declaration.declarations)) {\n+        declaration.declarations.forEach((d) => {\n+          if (d.id && d.id.name) {\n+            result.add(d.id.name);\n+          }\n+        });\n+      }\n     },\n   });\n \n   return result;\n });\n \n-export default getJSExports;\n+export default getJSExports;\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/packages/mui-codemod/src/util/getJSExports.js b/packages/mui-codemod/src/util/getJSExports.js\nindex 633018d..b6f4d7a 100644\n--- a/packages/mui-codemod/src/util/getJSExports.js\n+++ b/packages/mui-codemod/src/util/getJSExports.js\n@@ -1,3 +1,4 @@\n+\n import { readFileSync } from 'fs';\n import { parseSync } from '@babel/core';\n import traverse from '@babel/traverse';\n@@ -8,8 +9,20 @@ const getJSExports = memoize((file) => {\n \n   const ast = parseSync(readFileSync(file, 'utf8'), {\n     filename: file,\n+    // Ensure we can parse package source without relying on user Babel config\n+    babelrc: false,\n+    configFile: false,\n+    parserOpts: {\n+      sourceType: 'module',\n+      // Material packages compile to ESM; be permissive for parsing\n+      plugins: ['jsx', 'typescript', 'exportDefaultFrom'],\n+    },\n   });\n \n+  if (!ast) {\n+    return result;\n+  }\n+\n   traverse(ast, {\n     ExportSpecifier: ({ node: { exported } }) => {\n       result.add(exported.name);\n@@ -19,4 +32,4 @@ const getJSExports = memoize((file) => {\n   return result;\n });\n \n-export default getJSExports;\n+export default getJSExports;\n",
  "7_resolved": false
}