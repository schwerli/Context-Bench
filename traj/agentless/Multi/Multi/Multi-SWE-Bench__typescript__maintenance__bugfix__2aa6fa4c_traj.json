{
  "instance_id": "Multi-SWE-Bench__typescript__maintenance__bugfix__2aa6fa4c",
  "original_id": "vuejs__core-11201",
  "1_model_selected_files": [
    "packages/shared/src/toDisplayString.ts",
    "packages/reactivity/src/ref.ts"
  ],
  "2_embedding_selected_files": [
    "packages/runtime-core/__tests__/rendererTemplateRef.spec.ts",
    "packages/shared/__tests__/toDisplayString.spec.ts",
    "packages/shared/src/toDisplayString.ts",
    "packages/runtime-core/src/customFormatter.ts",
    "packages/runtime-core/__tests__/apiSetupContext.spec.ts",
    "packages/runtime-core/src/rendererTemplateRef.ts",
    "packages/reactivity/__tests__/ref.spec.ts",
    "packages/runtime-core/__tests__/helpers/withMemo.spec.ts",
    "packages/runtime-core/__tests__/vnodeHooks.spec.ts",
    "packages/reactivity/__tests__/ref.bench.ts",
    "packages/runtime-core/__tests__/directives.spec.ts",
    "packages/runtime-core/__tests__/apiExpose.spec.ts",
    "packages/runtime-core/__tests__/apiOptions.spec.ts",
    "packages/runtime-core/__tests__/apiAsyncComponent.spec.ts",
    "packages/runtime-core/__tests__/helpers/useModel.spec.ts",
    "packages/runtime-core/__tests__/hydration.spec.ts",
    "packages/runtime-core/__tests__/vnode.spec.ts",
    "packages/runtime-core/__tests__/rendererOptimizedMode.spec.ts",
    "packages/runtime-core/__tests__/rendererAttrsFallthrough.spec.ts",
    "packages/runtime-core/__tests__/rendererFragment.spec.ts",
    "packages/reactivity/src/ref.ts",
    "packages/runtime-core/__tests__/componentPublicInstance.spec.ts",
    "packages/runtime-core/__tests__/apiCreateApp.spec.ts",
    "packages/runtime-core/__tests__/componentProps.spec.ts",
    "packages/runtime-core/src/hydration.ts",
    "packages/runtime-core/__tests__/hmr.spec.ts",
    "packages/reactivity/__tests__/effectScope.spec.ts",
    "packages/runtime-core/__tests__/apiInject.spec.ts",
    "packages/runtime-core/src/hmr.ts",
    "packages/runtime-core/src/index.ts",
    "packages/runtime-core/__tests__/rendererComponent.spec.ts",
    "packages/reactivity/__tests__/computed.spec.ts",
    "packages/runtime-core/__tests__/componentEmits.spec.ts",
    "packages/runtime-core/__tests__/components/Teleport.spec.ts",
    "packages/runtime-core/__tests__/scopeId.spec.ts",
    "packages/runtime-core/__tests__/helpers/resolveAssets.spec.ts",
    "packages/runtime-core/__tests__/apiLifecycle.spec.ts",
    "packages/runtime-core/__tests__/misc.spec.ts",
    "packages/runtime-core/__tests__/componentSlots.spec.ts",
    "packages/runtime-core/src/apiComputed.ts",
    "packages/runtime-core/__tests__/apiWatch.spec.ts",
    "packages/reactivity/src/computed.ts"
  ],
  "3_final_combined_files": [
    "packages/shared/src/toDisplayString.ts",
    "packages/reactivity/src/ref.ts",
    "packages/runtime-core/__tests__/rendererTemplateRef.spec.ts",
    "packages/shared/__tests__/toDisplayString.spec.ts"
  ],
  "4_related_elements": {
    "packages/shared/src/toDisplayString.ts": [
      "function: toDisplayString\nfunction: replacer"
    ],
    "packages/reactivity/src/ref.ts": [
      "function: isRef\nclass: RefImpl\nclass: CustomRefImpl\nclass: ObjectRefImpl\nclass: GetterRefImpl"
    ],
    "packages/runtime-core/__tests__/rendererTemplateRef.spec.ts": [
      ""
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "packages/shared/src/toDisplayString.ts": [
          "function: toDisplayString\nline: 17\nline: 27"
        ],
        "packages/reactivity/src/ref.ts": [
          ""
        ],
        "packages/runtime-core/__tests__/rendererTemplateRef.spec.ts": [
          ""
        ]
      },
      "patches": [
        "diff --git a/packages/shared/src/toDisplayString.ts b/packages/shared/src/toDisplayString.ts\nindex c8cdffe..12e9141 100644\n--- a/packages/shared/src/toDisplayString.ts\n+++ b/packages/shared/src/toDisplayString.ts\n@@ -1,3 +1,4 @@\n+\n import {\n   isArray,\n   isFunction,\n@@ -15,6 +16,10 @@ import {\n  * @private\n  */\n export const toDisplayString = (val: unknown): string => {\n+  // unwrap refs first to avoid JSON.stringify quoting primitive strings\n+  if (val && (val as any).__v_isRef) {\n+    return toDisplayString((val as any).value)\n+  }\n   return isString(val)\n     ? val\n     : val == null\n@@ -56,4 +61,4 @@ const replacer = (_key: string, val: any): any => {\n const stringifySymbol = (v: unknown, i: number | string = ''): any =>\n   // Symbol.description in es2019+ so we need to cast here to pass\n   // the lib: es2016 check\n-  isSymbol(v) ? `Symbol(${(v as any).description ?? i})` : v\n+  isSymbol(v) ? `Symbol(${(v as any).description ?? i})` : v\n",
        "diff --git a/packages/shared/src/toDisplayString.ts b/packages/shared/src/toDisplayString.ts\nindex c8cdffe..a0ffdbb 100644\n--- a/packages/shared/src/toDisplayString.ts\n+++ b/packages/shared/src/toDisplayString.ts\n@@ -1,3 +1,4 @@\n+\n import {\n   isArray,\n   isFunction,\n@@ -15,6 +16,10 @@ import {\n  * @private\n  */\n export const toDisplayString = (val: unknown): string => {\n+  // unwrap top-level refs to avoid JSON-stringifying string values\n+  if ((val as any)?.__v_isRef) {\n+    return toDisplayString((val as any).value)\n+  }\n   return isString(val)\n     ? val\n     : val == null\n@@ -56,4 +61,4 @@ const replacer = (_key: string, val: any): any => {\n const stringifySymbol = (v: unknown, i: number | string = ''): any =>\n   // Symbol.description in es2019+ so we need to cast here to pass\n   // the lib: es2016 check\n-  isSymbol(v) ? `Symbol(${(v as any).description ?? i})` : v\n+  isSymbol(v) ? `Symbol(${(v as any).description ?? i})` : v\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "packages/shared/src/toDisplayString.ts": [
          "function: toDisplayString"
        ],
        "packages/reactivity/src/ref.ts": [
          "class: RefImpl\nclass: CustomRefImpl\nclass: ObjectRefImpl\nclass: GetterRefImpl"
        ],
        "packages/runtime-core/__tests__/rendererTemplateRef.spec.ts": [
          ""
        ]
      },
      "patches": [
        "diff --git a/packages/shared/src/toDisplayString.ts b/packages/shared/src/toDisplayString.ts\nindex c8cdffe..0b3960e 100644\n--- a/packages/shared/src/toDisplayString.ts\n+++ b/packages/shared/src/toDisplayString.ts\n@@ -1,3 +1,4 @@\n+\n import {\n   isArray,\n   isFunction,\n@@ -15,15 +16,17 @@ import {\n  * @private\n  */\n export const toDisplayString = (val: unknown): string => {\n-  return isString(val)\n-    ? val\n-    : val == null\n+  // unwrap top-level refs to avoid quoting strings via JSON.stringify\n+  const resolved = (val as any)?.__v_isRef ? (val as any).value : val\n+  return isString(resolved)\n+    ? resolved\n+    : resolved == null\n       ? ''\n-      : isArray(val) ||\n-          (isObject(val) &&\n-            (val.toString === objectToString || !isFunction(val.toString)))\n-        ? JSON.stringify(val, replacer, 2)\n-        : String(val)\n+      : isArray(resolved) ||\n+          (isObject(resolved) &&\n+            (resolved.toString === objectToString || !isFunction(resolved.toString)))\n+        ? JSON.stringify(resolved, replacer, 2)\n+        : String(resolved)\n }\n \n const replacer = (_key: string, val: any): any => {\n@@ -56,4 +59,4 @@ const replacer = (_key: string, val: any): any => {\n const stringifySymbol = (v: unknown, i: number | string = ''): any =>\n   // Symbol.description in es2019+ so we need to cast here to pass\n   // the lib: es2016 check\n-  isSymbol(v) ? `Symbol(${(v as any).description ?? i})` : v\n+  isSymbol(v) ? `Symbol(${(v as any).description ?? i})` : v\n",
        "diff --git a/packages/shared/src/toDisplayString.ts b/packages/shared/src/toDisplayString.ts\nindex c8cdffe..8922f9e 100644\n--- a/packages/shared/src/toDisplayString.ts\n+++ b/packages/shared/src/toDisplayString.ts\n@@ -1,3 +1,4 @@\n+\n import {\n   isArray,\n   isFunction,\n@@ -15,6 +16,10 @@ import {\n  * @private\n  */\n export const toDisplayString = (val: unknown): string => {\n+  // unwrap refs at root to avoid JSON.stringify adding quotes for string values\n+  if (val && (val as any).__v_isRef) {\n+    return toDisplayString((val as any).value)\n+  }\n   return isString(val)\n     ? val\n     : val == null\n@@ -56,4 +61,4 @@ const replacer = (_key: string, val: any): any => {\n const stringifySymbol = (v: unknown, i: number | string = ''): any =>\n   // Symbol.description in es2019+ so we need to cast here to pass\n   // the lib: es2016 check\n-  isSymbol(v) ? `Symbol(${(v as any).description ?? i})` : v\n+  isSymbol(v) ? `Symbol(${(v as any).description ?? i})` : v\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/packages/shared/src/toDisplayString.ts b/packages/shared/src/toDisplayString.ts\nindex c8cdffe..12e9141 100644\n--- a/packages/shared/src/toDisplayString.ts\n+++ b/packages/shared/src/toDisplayString.ts\n@@ -1,3 +1,4 @@\n+\n import {\n   isArray,\n   isFunction,\n@@ -15,6 +16,10 @@ import {\n  * @private\n  */\n export const toDisplayString = (val: unknown): string => {\n+  // unwrap refs first to avoid JSON.stringify quoting primitive strings\n+  if (val && (val as any).__v_isRef) {\n+    return toDisplayString((val as any).value)\n+  }\n   return isString(val)\n     ? val\n     : val == null\n@@ -56,4 +61,4 @@ const replacer = (_key: string, val: any): any => {\n const stringifySymbol = (v: unknown, i: number | string = ''): any =>\n   // Symbol.description in es2019+ so we need to cast here to pass\n   // the lib: es2016 check\n-  isSymbol(v) ? `Symbol(${(v as any).description ?? i})` : v\n+  isSymbol(v) ? `Symbol(${(v as any).description ?? i})` : v\n",
  "7_resolved": true
}