{
  "instance_id": "Multi-SWE-Bench__typescript__maintenance__bugfix__04c51be7",
  "original_id": "vuejs__core-10004",
  "1_model_selected_files": [
    "packages/runtime-core/src/hydration.ts",
    "packages/runtime-core/src/component.ts",
    "packages/runtime-core/src/renderer.ts",
    "packages/runtime-core/src/scheduler.ts",
    "packages/server-renderer/src/renderToString.ts"
  ],
  "2_embedding_selected_files": [
    "packages/runtime-core/src/hydration.ts",
    "packages/runtime-core/src/renderer.ts",
    "packages/runtime-core/src/index.ts",
    "packages/runtime-dom/src/index.ts",
    "packages/server-renderer/src/helpers/ssrRenderTeleport.ts",
    "packages/runtime-core/src/components/Suspense.ts",
    "packages/compiler-ssr/src/transforms/ssrTransformTransition.ts",
    "packages/server-renderer/src/render.ts",
    "packages/compiler-ssr/src/transforms/ssrTransformTransitionGroup.ts",
    "packages/compiler-ssr/src/transforms/ssrVShow.ts",
    "packages/server-renderer/src/helpers/ssrRenderSlot.ts",
    "packages/compiler-ssr/src/transforms/ssrTransformElement.ts",
    "packages/server-renderer/src/internal.ts",
    "packages/server-renderer/src/helpers/ssrRenderComponent.ts",
    "packages/server-renderer/src/helpers/ssrRenderAttrs.ts",
    "packages/compiler-ssr/src/transforms/ssrTransformSuspense.ts",
    "packages/compiler-ssr/src/transforms/ssrTransformTeleport.ts",
    "packages/compiler-ssr/src/transforms/ssrInjectFallthroughAttrs.ts",
    "packages/compiler-ssr/src/transforms/ssrInjectCssVars.ts",
    "packages/compiler-ssr/src/transforms/ssrVModel.ts",
    "packages/server-renderer/src/renderToString.ts",
    "packages/compiler-ssr/src/transforms/ssrTransformComponent.ts",
    "packages/runtime-core/src/components/Teleport.ts",
    "packages/compiler-ssr/src/runtimeHelpers.ts",
    "packages/server-renderer/src/helpers/ssrInterpolate.ts",
    "packages/runtime-core/src/hmr.ts",
    "packages/server-renderer/src/helpers/ssrVModelHelpers.ts",
    "packages/runtime-core/src/component.ts",
    "packages/server-renderer/src/helpers/ssrRenderList.ts",
    "packages/runtime-dom/src/directives/vShow.ts",
    "packages/compiler-ssr/src/transforms/ssrTransformSlotOutlet.ts",
    "packages/runtime-core/src/componentRenderUtils.ts",
    "packages/compiler-ssr/src/errors.ts",
    "packages/server-renderer/src/renderToStream.ts",
    "packages/runtime-core/src/compat/global.ts",
    "packages/compiler-ssr/src/transforms/ssrVFor.ts",
    "packages/server-renderer/src/index.ts",
    "packages/runtime-core/src/compat/renderHelpers.ts",
    "packages/runtime-dom/src/apiCustomElement.ts",
    "packages/compiler-ssr/src/transforms/ssrVIf.ts"
  ],
  "3_final_combined_files": [
    "packages/runtime-core/src/hydration.ts",
    "packages/runtime-core/src/renderer.ts",
    "packages/runtime-core/src/component.ts",
    "packages/runtime-core/src/index.ts"
  ],
  "4_related_elements": {
    "packages/runtime-core/src/hydration.ts": [
      "variable: hasMismatch\nfunction: createHydrationFunctions\nfunction: hydrate\nfunction: hydrateNode\nfunction: hydrateElement\nfunction: hydrateChildren\nfunction: hydrateFragment\nfunction: handleMismatch\nfunction: locateClosingAnchor\nfunction: replaceNode\nfunction: propHasMismatch\nfunction: isTemplateNode"
    ],
    "packages/runtime-core/src/renderer.ts": [
      "function: createHydrationRenderer\nfunction: baseCreateRenderer\nfunction: patch\nfunction: processComponent\nfunction: mountComponent\nfunction: setupRenderEffect\nfunction: render"
    ],
    "packages/runtime-core/src/component.ts": [
      "variable: uid\nfunction: createComponentInstance\nvariable: isInSSRComponentSetup\nfunction: setupComponent\nfunction: setupStatefulComponent\nfunction: finishComponentSetup"
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "packages/runtime-core/src/hydration.ts": [
          "function: propHasMismatch\nline: 451\nfunction: hydrateElement"
        ],
        "packages/runtime-core/src/renderer.ts": [
          ""
        ],
        "packages/runtime-core/src/component.ts": [
          ""
        ]
      },
      "patches": [
        "diff --git a/packages/runtime-core/src/hydration.ts b/packages/runtime-core/src/hydration.ts\nindex 11a0a76..7b9553d 100644\n--- a/packages/runtime-core/src/hydration.ts\n+++ b/packages/runtime-core/src/hydration.ts\n@@ -1,3 +1,4 @@\n+\n import {\n   Comment,\n   Fragment,\n@@ -717,6 +718,14 @@ function propHasMismatch(el: Element, key: string, clientValue: any): boolean {\n   let mismatchKey: string | undefined\n   let actual: any\n   let expected: any\n+\n+  // IDs are often generated uniquely per SSR request (e.g. libraries like HeadlessUI),\n+  // which will naturally differ from client-rendered IDs during hydration.\n+  // Treating these differences as mismatches causes false positives without\n+  // affecting actual behavior. Skip 'id' from hydration mismatch checks.\n+  if (key === 'id') {\n+    return false\n+  }\n   if (key === 'class') {\n     // classes might be in different order, but that doesn't affect cascade\n     // so we just need to check if the class lists contain the same classes.\n@@ -782,4 +791,4 @@ function isSetEqual(a: Set<string>, b: Set<string>): boolean {\n     }\n   }\n   return true\n-}\n+}\n",
        "diff --git a/packages/runtime-core/src/hydration.ts b/packages/runtime-core/src/hydration.ts\nindex 11a0a76..da49235 100644\n--- a/packages/runtime-core/src/hydration.ts\n+++ b/packages/runtime-core/src/hydration.ts\n@@ -1,3 +1,4 @@\n+\n import {\n   Comment,\n   Fragment,\n@@ -734,8 +735,13 @@ function propHasMismatch(el: Element, key: string, clientValue: any): boolean {\n       mismatchType = mismatchKey = 'style'\n     }\n   } else if (\n-    (el instanceof SVGElement && isKnownSvgAttr(key)) ||\n-    (el instanceof HTMLElement && (isBooleanAttr(key) || isKnownHtmlAttr(key)))\n+    // Skip dev-only hydration mismatch checks for \"id\" since many libraries\n+    // intentionally generate client-only IDs for accessibility (e.g. HeadlessUI).\n+    key !== 'id' &&\n+    (\n+      (el instanceof SVGElement && isKnownSvgAttr(key)) ||\n+      (el instanceof HTMLElement && (isBooleanAttr(key) || isKnownHtmlAttr(key)))\n+    )\n   ) {\n     actual = el.hasAttribute(key) && el.getAttribute(key)\n     expected = isBooleanAttr(key)\n@@ -782,4 +788,4 @@ function isSetEqual(a: Set<string>, b: Set<string>): boolean {\n     }\n   }\n   return true\n-}\n+}\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "packages/runtime-core/src/hydration.ts": [
          "function: hydrateNode\nline: 284\nfunction: hydrateElement\nline: 445\nline: 446\nline: 447\nline: 448\nline: 449\nline: 450\nline: 451\nline: 452\nline: 453\nline: 454\nline: 455\nline: 456\nline: 457\nline: 458\nline: 459\nline: 460\nline: 461\nline: 462\nline: 463\nline: 464\nline: 465\nline: 466\nline: 467\nline: 468\nline: 469\nline: 470\nline: 471\nline: 472\nfunction: handleMismatch"
        ],
        "packages/runtime-core/src/renderer.ts": [
          "function: setupRenderEffect\nline: 1347\nline: 1348\nline: 1349\nline: 1350\nline: 1351\nline: 1352\nline: 1353\nline: 1354"
        ],
        "packages/runtime-core/src/component.ts": [
          ""
        ]
      },
      "patches": [
        "diff --git a/packages/runtime-core/src/hydration.ts b/packages/runtime-core/src/hydration.ts\nindex 11a0a76..f736cab 100644\n--- a/packages/runtime-core/src/hydration.ts\n+++ b/packages/runtime-core/src/hydration.ts\n@@ -1,3 +1,4 @@\n+\n import {\n   Comment,\n   Fragment,\n@@ -440,24 +441,31 @@ export function createHydrationFunctions(\n \n       // props\n       if (props) {\n+        const shouldPatchAllProps =\n+          forcePatch || !!(patchFlag & PatchFlags.NEED_HYDRATION)\n+\n         if (\n           __DEV__ ||\n-          forcePatch ||\n+          shouldPatchAllProps ||\n           !optimized ||\n-          patchFlag & (PatchFlags.FULL_PROPS | PatchFlags.NEED_HYDRATION)\n+          patchFlag & PatchFlags.FULL_PROPS\n         ) {\n           for (const key in props) {\n-            // check hydration mismatch\n-            if (__DEV__ && propHasMismatch(el, key, props[key])) {\n+            // When we are going to patch all props for hydration, skip mismatch\n+            // checks to avoid noisy warnings for values that are meant to be\n+            // reconciled (e.g. SSR-generated ids).\n+            if (__DEV__ && !shouldPatchAllProps && propHasMismatch(el, key, props[key])) {\n               hasMismatch = true\n             }\n-            if (\n+            const shouldPatchThisKey =\n+              shouldPatchAllProps ||\n               (forcePatch &&\n                 (key.endsWith('value') || key === 'indeterminate')) ||\n               (isOn(key) && !isReservedProp(key)) ||\n               // force hydrate v-bind with .prop modifiers\n               key[0] === '.'\n-            ) {\n+\n+            if (shouldPatchThisKey) {\n               patchProp(\n                 el,\n                 key,\n@@ -782,4 +790,4 @@ function isSetEqual(a: Set<string>, b: Set<string>): boolean {\n     }\n   }\n   return true\n-}\n+}\n",
        "diff --git a/packages/runtime-core/src/hydration.ts b/packages/runtime-core/src/hydration.ts\nindex 11a0a76..4c0fda6 100644\n--- a/packages/runtime-core/src/hydration.ts\n+++ b/packages/runtime-core/src/hydration.ts\n@@ -1,3 +1,4 @@\n+\n import {\n   Comment,\n   Fragment,\n@@ -447,9 +448,39 @@ export function createHydrationFunctions(\n           patchFlag & (PatchFlags.FULL_PROPS | PatchFlags.NEED_HYDRATION)\n         ) {\n           for (const key in props) {\n-            // check hydration mismatch\n+            // handle \"id\" specially: rectify mismatch without warning\n+            if (__DEV__ && key === 'id') {\n+              const actual = el.getAttribute('id')\n+              const expected =\n+                props[key] == null ? null : String(props[key])\n+              if (actual !== expected) {\n+                hasMismatch = true\n+                patchProp(\n+                  el,\n+                  key,\n+                  null,\n+                  props[key],\n+                  undefined,\n+                  undefined,\n+                  parentComponent,\n+                )\n+                continue\n+              }\n+            }\n+            // check hydration mismatch for other attributes and rectify in dev\n             if (__DEV__ && propHasMismatch(el, key, props[key])) {\n               hasMismatch = true\n+              // rectify mismatched attributes during hydration in dev\n+              patchProp(\n+                el,\n+                key,\n+                null,\n+                props[key],\n+                undefined,\n+                undefined,\n+                parentComponent,\n+              )\n+              continue\n             }\n             if (\n               (forcePatch &&\n@@ -782,4 +813,4 @@ function isSetEqual(a: Set<string>, b: Set<string>): boolean {\n     }\n   }\n   return true\n-}\n+}\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/packages/runtime-core/src/hydration.ts b/packages/runtime-core/src/hydration.ts\nindex 11a0a76..7b9553d 100644\n--- a/packages/runtime-core/src/hydration.ts\n+++ b/packages/runtime-core/src/hydration.ts\n@@ -1,3 +1,4 @@\n+\n import {\n   Comment,\n   Fragment,\n@@ -717,6 +718,14 @@ function propHasMismatch(el: Element, key: string, clientValue: any): boolean {\n   let mismatchKey: string | undefined\n   let actual: any\n   let expected: any\n+\n+  // IDs are often generated uniquely per SSR request (e.g. libraries like HeadlessUI),\n+  // which will naturally differ from client-rendered IDs during hydration.\n+  // Treating these differences as mismatches causes false positives without\n+  // affecting actual behavior. Skip 'id' from hydration mismatch checks.\n+  if (key === 'id') {\n+    return false\n+  }\n   if (key === 'class') {\n     // classes might be in different order, but that doesn't affect cascade\n     // so we just need to check if the class lists contain the same classes.\n@@ -782,4 +791,4 @@ function isSetEqual(a: Set<string>, b: Set<string>): boolean {\n     }\n   }\n   return true\n-}\n+}\n",
  "7_resolved": false
}