{
  "instance_id": "Multi-SWE-Bench__go__maintenance__bugfix__52c152ba",
  "original_id": "cli__cli-6122",
  "1_model_selected_files": [
    "pkg/cmd/config/get/get.go",
    "internal/config/config.go"
  ],
  "2_embedding_selected_files": [
    "pkg/cmd/config/list/list_test.go",
    "internal/config/config.go",
    "pkg/cmd/config/get/get.go",
    "pkg/cmd/config/get/get_test.go",
    "pkg/cmd/factory/remote_resolver_test.go",
    "pkg/cmd/factory/default_test.go",
    "pkg/cmd/config/list/list.go",
    "internal/config/config_mock.go",
    "internal/config/stub.go",
    "pkg/cmd/config/set/set_test.go",
    "pkg/cmd/factory/remote_resolver.go",
    "pkg/cmd/config/config.go",
    "pkg/cmd/config/set/set.go",
    "pkg/cmd/factory/default.go",
    "pkg/iostreams/color_test.go",
    "pkg/findsh/find_windows.go",
    "pkg/jsoncolor/jsoncolor_test.go",
    "pkg/httpmock/legacy.go",
    "pkg/findsh/find.go",
    "pkg/text/truncate_test.go",
    "pkg/text/indent_test.go",
    "pkg/iostreams/iostreams_test.go",
    "pkg/set/string_set_test.go",
    "pkg/jsoncolor/jsoncolor.go",
    "pkg/httpmock/registry.go",
    "pkg/text/convert_test.go",
    "pkg/httpmock/stub.go",
    "pkg/markdown/markdown.go",
    "pkg/text/sanitize_test.go",
    "pkg/iostreams/color.go",
    "pkg/iostreams/tty_size.go",
    "pkg/iostreams/epipe_other.go",
    "pkg/iostreams/iostreams.go",
    "pkg/iostreams/tty_size_windows.go",
    "pkg/iostreams/console_windows.go",
    "pkg/set/string_set.go",
    "pkg/iostreams/console.go",
    "pkg/iostreams/epipe_windows.go",
    "pkg/text/convert.go",
    "pkg/text/indent.go",
    "pkg/text/truncate.go",
    "pkg/text/sanitize.go"
  ],
  "3_final_combined_files": [
    "pkg/cmd/config/get/get.go",
    "internal/config/config.go",
    "pkg/cmd/config/list/list_test.go"
  ],
  "4_related_elements": {
    "pkg/cmd/config/get/get.go": [
      "function: NewCmdConfigGet\nfunction: getRun"
    ],
    "internal/config/config.go": [
      "class: Config\nfunction: cfg.GetOrDefault\nfunction: cfg.Get\nfunction: cfg.DefaultHost\nfunction: defaultFor\nfunction: defaultExists\nvariable: hosts\nvariable: configOptions"
    ],
    "pkg/cmd/config/list/list_test.go": [
      ""
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "pkg/cmd/config/get/get.go": [
          "function: getRun\nline: 55\nline: 56"
        ],
        "internal/config/config.go": [
          ""
        ],
        "pkg/cmd/config/list/list_test.go": [
          ""
        ]
      },
      "patches": [
        "diff --git a/pkg/cmd/config/get/get.go b/pkg/cmd/config/get/get.go\nindex bcfafb2..3a56344 100644\n--- a/pkg/cmd/config/get/get.go\n+++ b/pkg/cmd/config/get/get.go\n@@ -53,7 +53,7 @@ func NewCmdConfigGet(f *cmdutil.Factory, runF func(*GetOptions) error) *cobra.Co\n }\n \n func getRun(opts *GetOptions) error {\n-\tval, err := opts.Config.GetOrDefault(opts.Hostname, opts.Key)\n+\tval, err := opts.Config.Get(opts.Hostname, opts.Key)\n \tif err != nil {\n \t\treturn err\n \t}\n@@ -62,4 +62,4 @@ func getRun(opts *GetOptions) error {\n \t\tfmt.Fprintf(opts.IO.Out, \"%s\\n\", val)\n \t}\n \treturn nil\n-}\n+}\n",
        "diff --git a/pkg/cmd/config/get/get.go b/pkg/cmd/config/get/get.go\nindex bcfafb2..7deb434 100644\n--- a/pkg/cmd/config/get/get.go\n+++ b/pkg/cmd/config/get/get.go\n@@ -53,7 +53,13 @@ func NewCmdConfigGet(f *cmdutil.Factory, runF func(*GetOptions) error) *cobra.Co\n }\n \n func getRun(opts *GetOptions) error {\n-\tval, err := opts.Config.GetOrDefault(opts.Hostname, opts.Key)\n+\t// Default to github.com when no host is explicitly provided to match `config list` behavior\n+\thostname := opts.Hostname\n+\tif hostname == \"\" {\n+\t\thostname = \"github.com\"\n+\t}\n+\n+\tval, err := opts.Config.GetOrDefault(hostname, opts.Key)\n \tif err != nil {\n \t\treturn err\n \t}\n@@ -62,4 +68,4 @@ func getRun(opts *GetOptions) error {\n \t\tfmt.Fprintf(opts.IO.Out, \"%s\\n\", val)\n \t}\n \treturn nil\n-}\n+}\n"
      ],
      "edit_loc_traj": {
        "prompt": "\nPlease review the following GitHub problem description and relevant files, and provide a set of locations that need to be edited to fix the issue.\nThe locations can be specified as class names, function or method names, or exact line numbers that require modification.\n\n### GitHub Problem Description ###\n`config get` `config list` output is not consistent when per-host config for github.com differs from default\n### Describe the bug\r\n\r\n`config get` `config list` output is not consistent when per-host config for github.com differs from default\r\n\r\n```\r\ngh version 2.14.4 (2022-08-10)\r\nhttps://github.com/cli/cli/releases/tag/v2.14.4\r\n```\r\n\r\n### Steps to reproduce the behavior\r\n\r\n1. Set the following configs:\r\n    `~/.config/gh/config.yml`:\r\n\r\n    ```yaml\r\n    git_protocol: https\r\n    ```\r\n\r\n    `~/.config/gh/hosts.yml`:\r\n\r\n    ```yaml\r\n    github.com:\r\n        git_protocol: ssh\r\n    ```\r\n\r\n2. Now in a github.com repo,\r\n    ```\r\n    $ gh config list\r\n    git_protocol=ssh\r\n    editor=\r\n    prompt=enabled\r\n    pager=\r\n    http_unix_socket=\r\n    browser=\r\n\r\n    $ gh config get git_protocol\r\n    https\r\n    ```\r\n\r\n\r\n### Expected vs actual behavior\r\n\r\nExpected: Both `config list` and `config get` shows configs for github.com\r\n\r\nActual: `config list` shows config for github.com; `config get` shows default config\r\n\r\n### Logs\r\n\r\n(As above)\n\n###\n### pkg/cmd/config/get/get.go\n...\n10|\t\"github.com/spf13/cobra\"\n11|)\n12|\n13|type GetOptions struct {\n14|\tIO     *iostreams.IOStreams\n15|\tConfig config.Config\n16|\n17|\tHostname string\n18|\tKey      string\n19|}\n20|\n21|func NewCmdConfigGet(f *cmdutil.Factory, runF func(*GetOptions) error) *cobra.Command {\n22|\topts := &GetOptions{\n23|\t\tIO: f.IOStreams,\n24|\t}\n25|\n26|\tcmd := &cobra.Command{\n27|\t\tUse:   \"get <key>\",\n28|\t\tShort: \"Print the value of a given configuration key\",\n29|\t\tExample: heredoc.Doc(`\n30|\t\t\t$ gh config get git_protocol\n31|\t\t\thttps\n32|\t\t`),\n33|\t\tArgs: cobra.ExactArgs(1),\n34|\t\tRunE: func(cmd *cobra.Command, args []string) error {\n35|\t\t\tconfig, err := f.Config()\n36|\t\t\tif err != nil {\n37|\t\t\t\treturn err\n38|\t\t\t}\n39|\t\t\topts.Config = config\n40|\t\t\topts.Key = args[0]\n41|\n42|\t\t\tif runF != nil {\n43|\t\t\t\treturn runF(opts)\n44|\t\t\t}\n45|\n46|\t\t\treturn getRun(opts)\n47|\t\t},\n48|\t}\n49|\n50|\tcmd.Flags().StringVarP(&opts.Hostname, \"host\", \"h\", \"\", \"Get per-host setting\")\n51|\n52|\treturn cmd\n53|}\n54|\n55|func getRun(opts *GetOptions) error {\n56|\tval, err := opts.Config.GetOrDefault(opts.Hostname, opts.Key)\n57|\tif err != nil {\n58|\t\treturn err\n59|\t}\n60|\n61|\tif val != \"\" {\n62|\t\tfmt.Fprintf(opts.IO.Out, \"%s\\n\", val)\n63|\t}\n64|\treturn nil\n65|}\n\n\n### internal/config/config.go\n...\n7|\tghAuth \"github.com/cli/go-gh/pkg/auth\"\n8|\tghConfig \"github.com/cli/go-gh/pkg/config\"\n9|)\n10|\n11|const (\n12|\thosts   = \"hosts\"\n13|\taliases = \"aliases\"\n14|)\n15|\n16|// This interface describes interacting with some persistent configuration for gh.\n17|//go:generate moq -rm -out config_mock.go . Config\n18|type Config interface {\n19|\tAuthToken(string) (string, string)\n20|\tGet(string, string) (string, error)\n21|\tGetOrDefault(string, string) (string, error)\n22|\tSet(string, string, string)\n23|\tUnsetHost(string)\n24|\tHosts() []string\n25|\tDefaultHost() (string, string)\n26|\tAliases() *AliasConfig\n27|\tWrite() error\n28|}\n29|\n30|func NewConfig() (Config, error) {\n31|\tc, err := ghConfig.Read()\n32|\tif err != nil {\n33|\t\treturn nil, err\n34|\t}\n35|\treturn &cfg{c}, nil\n36|}\n37|\n...\n100|\treturn ghAuth.DefaultHost()\n101|}\n102|\n103|func (c *cfg) Aliases() *AliasConfig {\n104|\treturn &AliasConfig{cfg: c.cfg}\n105|}\n106|\n107|func (c *cfg) Write() error {\n108|\treturn ghConfig.Write(c.cfg)\n109|}\n110|\n111|func defaultFor(key string) string {\n112|\tfor _, co := range configOptions {\n113|\t\tif co.Key == key {\n114|\t\t\treturn co.DefaultValue\n115|\t\t}\n116|\t}\n117|\treturn \"\"\n118|}\n119|\n120|func defaultExists(key string) bool {\n121|\tfor _, co := range configOptions {\n122|\t\tif co.Key == key {\n123|\t\t\treturn true\n124|\t\t}\n125|\t}\n126|\treturn false\n127|}\n128|\n129|type AliasConfig struct {\n130|\tcfg *ghConfig.Config\n131|}\n132|\n133|func (a *AliasConfig) Get(alias string) (string, error) {\n134|\treturn a.cfg.Get([]string{aliases, alias})\n135|}\n136|\n...\n\n\n\n\n###\n\nPlease provide the class name, function or method name, or the exact line numbers that need to be edited.\nThe possible location outputs should be either \"class\", \"function\" or \"line\".\n\n### Examples:\n```\nfull_path1/file1.go\nline: 10\nclass: MyClass1\nline: 51\n\nfull_path2/file2.go\nfunction: MyClass2.my_method\nline: 12\n\nfull_path3/file3.go\nfunction: my_function\nline: 24\nline: 156\n```\n\nReturn just the location(s) wrapped with ```.\n",
        "response": [
          "```\npkg/cmd/config/get/get.go\nfunction: getRun\nline: 55\nline: 56\n```",
          "```\npkg/cmd/config/get/get.go\nfunction: getRun\n```"
        ],
        "usage": {
          "completion_tokens": 0,
          "prompt_tokens": 0
        }
      },
      "additional_artifact_loc_edit_location": [
        {
          "raw_output_loc": [
            "```\npkg/cmd/config/get/get.go\nfunction: getRun\nline: 55\nline: 56\n```",
            "```\npkg/cmd/config/get/get.go\nfunction: getRun\n```"
          ]
        }
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "pkg/cmd/config/get/get.go": [
          "function: getRun"
        ],
        "internal/config/config.go": [
          ""
        ],
        "pkg/cmd/config/list/list_test.go": [
          ""
        ]
      },
      "patches": [
        "diff --git a/pkg/cmd/config/get/get.go b/pkg/cmd/config/get/get.go\nindex bcfafb2..0d49462 100644\n--- a/pkg/cmd/config/get/get.go\n+++ b/pkg/cmd/config/get/get.go\n@@ -53,7 +53,13 @@ func NewCmdConfigGet(f *cmdutil.Factory, runF func(*GetOptions) error) *cobra.Co\n }\n \n func getRun(opts *GetOptions) error {\n-\tval, err := opts.Config.GetOrDefault(opts.Hostname, opts.Key)\n+\thostname := opts.Hostname\n+\tif hostname == \"\" {\n+\t\t// Default to the primary GitHub host to match `config list` behavior\n+\t\thostname = \"github.com\"\n+\t}\n+\n+\tval, err := opts.Config.GetOrDefault(hostname, opts.Key)\n \tif err != nil {\n \t\treturn err\n \t}\n@@ -62,4 +68,4 @@ func getRun(opts *GetOptions) error {\n \t\tfmt.Fprintf(opts.IO.Out, \"%s\\n\", val)\n \t}\n \treturn nil\n-}\n+}\n",
        "diff --git a/pkg/cmd/config/get/get.go b/pkg/cmd/config/get/get.go\nindex bcfafb2..3ab5e8f 100644\n--- a/pkg/cmd/config/get/get.go\n+++ b/pkg/cmd/config/get/get.go\n@@ -53,7 +53,12 @@ func NewCmdConfigGet(f *cmdutil.Factory, runF func(*GetOptions) error) *cobra.Co\n }\n \n func getRun(opts *GetOptions) error {\n-\tval, err := opts.Config.GetOrDefault(opts.Hostname, opts.Key)\n+\thostname := opts.Hostname\n+\tif hostname == \"\" {\n+\t\t// Default to github.com when no host is specified to match `config list` behavior\n+\t\thostname = \"github.com\"\n+\t}\n+\tval, err := opts.Config.GetOrDefault(hostname, opts.Key)\n \tif err != nil {\n \t\treturn err\n \t}\n@@ -62,4 +67,4 @@ func getRun(opts *GetOptions) error {\n \t\tfmt.Fprintf(opts.IO.Out, \"%s\\n\", val)\n \t}\n \treturn nil\n-}\n+}\n"
      ],
      "edit_loc_traj": {
        "prompt": "\nPlease review the following GitHub problem description and relevant files, and provide a set of locations that need to be edited to fix the issue.\nThe locations can be specified as class names, function or method names, or exact line numbers that require modification.\n\n### GitHub Problem Description ###\n`config get` `config list` output is not consistent when per-host config for github.com differs from default\n### Describe the bug\r\n\r\n`config get` `config list` output is not consistent when per-host config for github.com differs from default\r\n\r\n```\r\ngh version 2.14.4 (2022-08-10)\r\nhttps://github.com/cli/cli/releases/tag/v2.14.4\r\n```\r\n\r\n### Steps to reproduce the behavior\r\n\r\n1. Set the following configs:\r\n    `~/.config/gh/config.yml`:\r\n\r\n    ```yaml\r\n    git_protocol: https\r\n    ```\r\n\r\n    `~/.config/gh/hosts.yml`:\r\n\r\n    ```yaml\r\n    github.com:\r\n        git_protocol: ssh\r\n    ```\r\n\r\n2. Now in a github.com repo,\r\n    ```\r\n    $ gh config list\r\n    git_protocol=ssh\r\n    editor=\r\n    prompt=enabled\r\n    pager=\r\n    http_unix_socket=\r\n    browser=\r\n\r\n    $ gh config get git_protocol\r\n    https\r\n    ```\r\n\r\n\r\n### Expected vs actual behavior\r\n\r\nExpected: Both `config list` and `config get` shows configs for github.com\r\n\r\nActual: `config list` shows config for github.com; `config get` shows default config\r\n\r\n### Logs\r\n\r\n(As above)\n\n###\n### pkg/cmd/config/get/get.go\n...\n10|\t\"github.com/spf13/cobra\"\n11|)\n12|\n13|type GetOptions struct {\n14|\tIO     *iostreams.IOStreams\n15|\tConfig config.Config\n16|\n17|\tHostname string\n18|\tKey      string\n19|}\n20|\n21|func NewCmdConfigGet(f *cmdutil.Factory, runF func(*GetOptions) error) *cobra.Command {\n22|\topts := &GetOptions{\n23|\t\tIO: f.IOStreams,\n24|\t}\n25|\n26|\tcmd := &cobra.Command{\n27|\t\tUse:   \"get <key>\",\n28|\t\tShort: \"Print the value of a given configuration key\",\n29|\t\tExample: heredoc.Doc(`\n30|\t\t\t$ gh config get git_protocol\n31|\t\t\thttps\n32|\t\t`),\n33|\t\tArgs: cobra.ExactArgs(1),\n34|\t\tRunE: func(cmd *cobra.Command, args []string) error {\n35|\t\t\tconfig, err := f.Config()\n36|\t\t\tif err != nil {\n37|\t\t\t\treturn err\n38|\t\t\t}\n39|\t\t\topts.Config = config\n40|\t\t\topts.Key = args[0]\n41|\n42|\t\t\tif runF != nil {\n43|\t\t\t\treturn runF(opts)\n44|\t\t\t}\n45|\n46|\t\t\treturn getRun(opts)\n47|\t\t},\n48|\t}\n49|\n50|\tcmd.Flags().StringVarP(&opts.Hostname, \"host\", \"h\", \"\", \"Get per-host setting\")\n51|\n52|\treturn cmd\n53|}\n54|\n55|func getRun(opts *GetOptions) error {\n56|\tval, err := opts.Config.GetOrDefault(opts.Hostname, opts.Key)\n57|\tif err != nil {\n58|\t\treturn err\n59|\t}\n60|\n61|\tif val != \"\" {\n62|\t\tfmt.Fprintf(opts.IO.Out, \"%s\\n\", val)\n63|\t}\n64|\treturn nil\n65|}\n\n\n### internal/config/config.go\n...\n7|\tghAuth \"github.com/cli/go-gh/pkg/auth\"\n8|\tghConfig \"github.com/cli/go-gh/pkg/config\"\n9|)\n10|\n11|const (\n12|\thosts   = \"hosts\"\n13|\taliases = \"aliases\"\n14|)\n15|\n16|// This interface describes interacting with some persistent configuration for gh.\n17|//go:generate moq -rm -out config_mock.go . Config\n18|type Config interface {\n19|\tAuthToken(string) (string, string)\n20|\tGet(string, string) (string, error)\n21|\tGetOrDefault(string, string) (string, error)\n22|\tSet(string, string, string)\n23|\tUnsetHost(string)\n24|\tHosts() []string\n25|\tDefaultHost() (string, string)\n26|\tAliases() *AliasConfig\n27|\tWrite() error\n28|}\n29|\n30|func NewConfig() (Config, error) {\n31|\tc, err := ghConfig.Read()\n32|\tif err != nil {\n33|\t\treturn nil, err\n34|\t}\n35|\treturn &cfg{c}, nil\n36|}\n37|\n...\n100|\treturn ghAuth.DefaultHost()\n101|}\n102|\n103|func (c *cfg) Aliases() *AliasConfig {\n104|\treturn &AliasConfig{cfg: c.cfg}\n105|}\n106|\n107|func (c *cfg) Write() error {\n108|\treturn ghConfig.Write(c.cfg)\n109|}\n110|\n111|func defaultFor(key string) string {\n112|\tfor _, co := range configOptions {\n113|\t\tif co.Key == key {\n114|\t\t\treturn co.DefaultValue\n115|\t\t}\n116|\t}\n117|\treturn \"\"\n118|}\n119|\n120|func defaultExists(key string) bool {\n121|\tfor _, co := range configOptions {\n122|\t\tif co.Key == key {\n123|\t\t\treturn true\n124|\t\t}\n125|\t}\n126|\treturn false\n127|}\n128|\n129|type AliasConfig struct {\n130|\tcfg *ghConfig.Config\n131|}\n132|\n133|func (a *AliasConfig) Get(alias string) (string, error) {\n134|\treturn a.cfg.Get([]string{aliases, alias})\n135|}\n136|\n...\n\n\n\n\n###\n\nPlease provide the class name, function or method name, or the exact line numbers that need to be edited.\nThe possible location outputs should be either \"class\", \"function\" or \"line\".\n\n### Examples:\n```\nfull_path1/file1.go\nline: 10\nclass: MyClass1\nline: 51\n\nfull_path2/file2.go\nfunction: MyClass2.my_method\nline: 12\n\nfull_path3/file3.go\nfunction: my_function\nline: 24\nline: 156\n```\n\nReturn just the location(s) wrapped with ```.\n",
        "response": [
          "```\npkg/cmd/config/get/get.go\nfunction: getRun\nline: 55\nline: 56\n```",
          "```\npkg/cmd/config/get/get.go\nfunction: getRun\n```"
        ],
        "usage": {
          "completion_tokens": 0,
          "prompt_tokens": 0
        }
      },
      "additional_artifact_loc_edit_location": [
        {
          "raw_output_loc": [
            "```\npkg/cmd/config/get/get.go\nfunction: getRun\nline: 55\nline: 56\n```",
            "```\npkg/cmd/config/get/get.go\nfunction: getRun\n```"
          ]
        }
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/pkg/cmd/config/get/get.go b/pkg/cmd/config/get/get.go\nindex bcfafb2..7deb434 100644\n--- a/pkg/cmd/config/get/get.go\n+++ b/pkg/cmd/config/get/get.go\n@@ -53,7 +53,13 @@ func NewCmdConfigGet(f *cmdutil.Factory, runF func(*GetOptions) error) *cobra.Co\n }\n \n func getRun(opts *GetOptions) error {\n-\tval, err := opts.Config.GetOrDefault(opts.Hostname, opts.Key)\n+\t// Default to github.com when no host is explicitly provided to match `config list` behavior\n+\thostname := opts.Hostname\n+\tif hostname == \"\" {\n+\t\thostname = \"github.com\"\n+\t}\n+\n+\tval, err := opts.Config.GetOrDefault(hostname, opts.Key)\n \tif err != nil {\n \t\treturn err\n \t}\n@@ -62,4 +68,4 @@ func getRun(opts *GetOptions) error {\n \t\tfmt.Fprintf(opts.IO.Out, \"%s\\n\", val)\n \t}\n \treturn nil\n-}\n+}\n",
  "7_resolved": true
}