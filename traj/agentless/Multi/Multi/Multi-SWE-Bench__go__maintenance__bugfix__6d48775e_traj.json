{
  "instance_id": "Multi-SWE-Bench__go__maintenance__bugfix__6d48775e",
  "original_id": "cli__cli-4253",
  "1_model_selected_files": [
    "pkg/cmd/browse/browse.go",
    "pkg/cmd/browse/browse_test.go"
  ],
  "2_embedding_selected_files": [
    "pkg/cmd/browse/browse_test.go",
    "pkg/cmd/browse/browse.go",
    "pkg/cmdutil/web_browser.go",
    "pkg/cmd/factory/default_test.go",
    "pkg/cmd/factory/default.go",
    "pkg/cmd/factory/http_test.go",
    "pkg/cmdutil/json_flags_test.go",
    "pkg/cmdutil/factory.go",
    "pkg/cmdutil/args_test.go",
    "pkg/cmd/factory/remote_resolver_test.go",
    "pkg/cmdutil/legacy.go",
    "pkg/cmd/factory/remote_resolver.go",
    "pkg/cmdutil/args.go",
    "pkg/cmdutil/repo_override.go",
    "pkg/cmdutil/auth_check_test.go",
    "pkg/cmdutil/file_input.go",
    "pkg/cmd/factory/http.go",
    "pkg/cmdutil/json_flags.go",
    "pkg/cmdutil/auth_check.go",
    "pkg/cmdutil/errors.go"
  ],
  "3_final_combined_files": [
    "pkg/cmd/browse/browse.go",
    "pkg/cmd/browse/browse_test.go",
    "pkg/cmdutil/web_browser.go"
  ],
  "4_related_elements": {
    "pkg/cmd/browse/browse.go": [
      "function: NewCmdBrowse\nfunction: runBrowse\nfunction: parseFileArg\nfunction: isNumber"
    ],
    "pkg/cmd/browse/browse_test.go": [
      "function: Test_runBrowse\nfunction: Test_parseFileArg"
    ],
    "pkg/cmdutil/web_browser.go": [
      ""
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "pkg/cmd/browse/browse.go": [
          "function: parseFileArg"
        ],
        "pkg/cmd/browse/browse_test.go": [
          "function: Test_parseFileArg\nfunction: Test_runBrowse"
        ],
        "pkg/cmdutil/web_browser.go": [
          ""
        ]
      },
      "patches": [
        "diff --git a/pkg/cmd/browse/browse.go b/pkg/cmd/browse/browse.go\nindex 79dd77f..590e299 100644\n--- a/pkg/cmd/browse/browse.go\n+++ b/pkg/cmd/browse/browse.go\n@@ -170,10 +170,23 @@ func parseFileArg(fileArg string) (string, error) {\n \t\treturn \"\", fmt.Errorf(\"invalid use of colon\\nUse 'gh browse --help' for more information about browse\\n\")\n \t}\n \tif len(arr) > 1 {\n-\t\tif !isNumber(arr[1]) {\n+\t\tspec := arr[1]\n+\t\tif strings.Contains(spec, \"-\") {\n+\t\t\tparts := strings.Split(spec, \"-\")\n+\t\t\tif len(parts) != 2 || parts[0] == \"\" || parts[1] == \"\" || !isNumber(parts[0]) || !isNumber(parts[1]) {\n+\t\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n+\t\t\t}\n+\t\t\tstart, _ := strconv.Atoi(parts[0])\n+\t\t\tend, _ := strconv.Atoi(parts[1])\n+\t\t\tif start > end {\n+\t\t\t\tstart, end = end, start\n+\t\t\t}\n+\t\t\treturn fmt.Sprintf(\"%s#L%d-L%d\", arr[0], start, end), nil\n+\t\t}\n+\t\tif !isNumber(spec) {\n \t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n \t\t}\n-\t\treturn arr[0] + \"#L\" + arr[1], nil\n+\t\treturn arr[0] + \"#L\" + spec, nil\n \t}\n \treturn arr[0], nil\n }\n",
        "diff --git a/pkg/cmd/browse/browse.go b/pkg/cmd/browse/browse.go\nindex 79dd77f..f511b15 100644\n--- a/pkg/cmd/browse/browse.go\n+++ b/pkg/cmd/browse/browse.go\n@@ -169,11 +169,21 @@ func parseFileArg(fileArg string) (string, error) {\n \tif len(arr) > 2 {\n \t\treturn \"\", fmt.Errorf(\"invalid use of colon\\nUse 'gh browse --help' for more information about browse\\n\")\n \t}\n-\tif len(arr) > 1 {\n-\t\tif !isNumber(arr[1]) {\n-\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n+\tif len(arr) == 2 {\n+\t\tlineSpec := arr[1]\n+\t\t// Single line number\n+\t\tif isNumber(lineSpec) {\n+\t\t\treturn arr[0] + \"#L\" + lineSpec, nil\n \t\t}\n-\t\treturn arr[0] + \"#L\" + arr[1], nil\n+\t\t// Line range, e.g., \"10-20\"\n+\t\tif strings.Contains(lineSpec, \"-\") {\n+\t\t\trangeParts := strings.Split(lineSpec, \"-\")\n+\t\t\tif len(rangeParts) != 2 || rangeParts[0] == \"\" || rangeParts[1] == \"\" || !isNumber(rangeParts[0]) || !isNumber(rangeParts[1]) {\n+\t\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n+\t\t\t}\n+\t\t\treturn arr[0] + \"#L\" + rangeParts[0] + \"-L\" + rangeParts[1], nil\n+\t\t}\n+\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n \t}\n \treturn arr[0], nil\n }\n@@ -181,4 +191,4 @@ func parseFileArg(fileArg string) (string, error) {\n func isNumber(arg string) bool {\n \t_, err := strconv.Atoi(arg)\n \treturn err == nil\n-}\n+}\n"
      ],
      "edit_loc_traj": {
        "prompt": "\nPlease review the following GitHub problem description and relevant files, and provide a set of locations that need to be edited to fix the issue.\nThe locations can be specified as class names, function or method names, or exact line numbers that require modification.\n\n### GitHub Problem Description ###\nAdd support for line number range to 'browse'\n### Describe the feature or problem you’d like to solve\r\n\r\nWould like to open the browser to a specific file, with a range of lines highlighted.\r\n\r\n### Proposed solution\r\n\r\nAllow this:\r\n`gh browse test.go:10-20`\r\n\r\nTo open the test.go file and highlight lines 10-20.\r\n\n\n###\n### pkg/cmd/browse/browse.go\n...\n25|\tIO         *iostreams.IOStreams\n26|\n27|\tSelectorArg string\n28|\n29|\tBranch        string\n30|\tProjectsFlag  bool\n31|\tSettingsFlag  bool\n32|\tWikiFlag      bool\n33|\tNoBrowserFlag bool\n34|}\n35|\n36|func NewCmdBrowse(f *cmdutil.Factory, runF func(*BrowseOptions) error) *cobra.Command {\n37|\topts := &BrowseOptions{\n38|\t\tBrowser:    f.Browser,\n39|\t\tHttpClient: f.HttpClient,\n40|\t\tIO:         f.IOStreams,\n41|\t}\n42|\n43|\tcmd := &cobra.Command{\n44|\t\tLong:  \"Open the GitHub repository in the web browser.\",\n45|\t\tShort: \"Open the repository in the browser\",\n46|\t\tUse:   \"browse [<number> | <path>]\",\n47|\t\tArgs:  cobra.MaximumNArgs(1),\n48|\t\tExample: heredoc.Doc(`\n49|\t\t\t$ gh browse\n50|\t\t\t#=> Open the home page of the current repository\n51|\n52|\t\t\t$ gh browse 217\n53|\t\t\t#=> Open issue or pull request 217\n54|\n55|\t\t\t$ gh browse --settings\n56|\t\t\t#=> Open repository settings\n57|\n58|\t\t\t$ gh browse main.go:312\n59|\t\t\t#=> Open main.go at line 312\n60|\n61|\t\t\t$ gh browse main.go --branch main\n62|\t\t\t#=> Open main.go in the main branch\n63|\t\t`),\n64|\t\tAnnotations: map[string]string{\n65|\t\t\t\"IsCore\": \"true\",\n66|\t\t\t\"help:arguments\": heredoc.Doc(`\n67|\t\t\t\tA browser location can be specified using arguments in the following format:\n68|\t\t\t\t- by number for issue or pull request, e.g. \"123\"; or\n69|\t\t\t\t- by path for opening folders and files, e.g. \"cmd/gh/main.go\"\n70|\t\t\t`),\n71|\t\t\t\"help:environment\": heredoc.Doc(`\n72|\t\t\t\tTo configure a web browser other than the default, use the BROWSER environment variable.\n73|\t\t\t`),\n74|\t\t},\n75|\t\tRunE: func(cmd *cobra.Command, args []string) error {\n76|\t\t\topts.BaseRepo = f.BaseRepo\n77|\n78|\t\t\tif len(args) > 0 {\n79|\t\t\t\topts.SelectorArg = args[0]\n80|\t\t\t}\n81|\n82|\t\t\tif err := cmdutil.MutuallyExclusive(\n83|\t\t\t\t\"specify only one of `--branch`, `--projects`, `--wiki`, or `--settings`\",\n84|\t\t\t\topts.Branch != \"\",\n85|\t\t\t\topts.WikiFlag,\n86|\t\t\t\topts.SettingsFlag,\n87|\t\t\t\topts.ProjectsFlag,\n88|\t\t\t); err != nil {\n89|\t\t\t\treturn err\n90|\t\t\t}\n91|\n92|\t\t\tif runF != nil {\n93|\t\t\t\treturn runF(opts)\n94|\t\t\t}\n95|\t\t\treturn runBrowse(opts)\n96|\t\t},\n97|\t}\n98|\n99|\tcmdutil.EnableRepoOverride(cmd, f)\n100|\tcmd.Flags().BoolVarP(&opts.ProjectsFlag, \"projects\", \"p\", false, \"Open repository projects\")\n101|\tcmd.Flags().BoolVarP(&opts.WikiFlag, \"wiki\", \"w\", false, \"Open repository wiki\")\n102|\tcmd.Flags().BoolVarP(&opts.SettingsFlag, \"settings\", \"s\", false, \"Open repository settings\")\n103|\tcmd.Flags().BoolVarP(&opts.NoBrowserFlag, \"no-browser\", \"n\", false, \"Print destination URL instead of opening the browser\")\n104|\tcmd.Flags().StringVarP(&opts.Branch, \"branch\", \"b\", \"\", \"Select another branch by passing in the branch name\")\n105|\n106|\treturn cmd\n107|}\n108|\n109|func runBrowse(opts *BrowseOptions) error {\n110|\tbaseRepo, err := opts.BaseRepo()\n111|\tif err != nil {\n112|\t\treturn fmt.Errorf(\"unable to determine base repository: %w\", err)\n113|\t}\n114|\n115|\thttpClient, err := opts.HttpClient()\n116|\tif err != nil {\n117|\t\treturn fmt.Errorf(\"unable to create an http client: %w\", err)\n118|\t}\n119|\turl := ghrepo.GenerateRepoURL(baseRepo, \"\")\n120|\n121|\tif opts.SelectorArg == \"\" {\n122|\t\tif opts.ProjectsFlag {\n123|\t\t\turl += \"/projects\"\n124|\t\t}\n125|\t\tif opts.SettingsFlag {\n126|\t\t\turl += \"/settings\"\n127|\t\t}\n128|\t\tif opts.WikiFlag {\n129|\t\t\turl += \"/wiki\"\n130|\t\t}\n131|\t\tif opts.Branch != \"\" {\n132|\t\t\turl += \"/tree/\" + opts.Branch + \"/\"\n133|\t\t}\n134|\t} else {\n135|\t\tif isNumber(opts.SelectorArg) {\n136|\t\t\turl += \"/issues/\" + opts.SelectorArg\n137|\t\t} else {\n138|\t\t\tfileArg, err := parseFileArg(opts.SelectorArg)\n139|\t\t\tif err != nil {\n140|\t\t\t\treturn err\n141|\t\t\t}\n142|\t\t\tif opts.Branch != \"\" {\n143|\t\t\t\turl += \"/tree/\" + opts.Branch + \"/\"\n144|\t\t\t} else {\n145|\t\t\t\tapiClient := api.NewClientFromHTTP(httpClient)\n146|\t\t\t\tbranchName, err := api.RepoDefaultBranch(apiClient, baseRepo)\n147|\t\t\t\tif err != nil {\n148|\t\t\t\t\treturn err\n149|\t\t\t\t}\n150|\t\t\t\turl += \"/tree/\" + branchName + \"/\"\n151|\t\t\t}\n152|\t\t\turl += fileArg\n153|\t\t}\n154|\t}\n155|\n156|\tif opts.NoBrowserFlag {\n157|\t\tfmt.Fprintf(opts.IO.Out, \"%s\\n\", url)\n158|\t\treturn nil\n159|\t} else {\n160|\t\tif opts.IO.IsStdoutTTY() {\n161|\t\t\tfmt.Fprintf(opts.IO.Out, \"now opening %s in browser\\n\", url)\n162|\t\t}\n163|\t\treturn opts.Browser.Browse(url)\n164|\t}\n165|}\n166|\n167|func parseFileArg(fileArg string) (string, error) {\n168|\tarr := strings.Split(fileArg, \":\")\n169|\tif len(arr) > 2 {\n170|\t\treturn \"\", fmt.Errorf(\"invalid use of colon\\nUse 'gh browse --help' for more information about browse\\n\")\n171|\t}\n172|\tif len(arr) > 1 {\n173|\t\tif !isNumber(arr[1]) {\n174|\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n175|\t\t}\n176|\t\treturn arr[0] + \"#L\" + arr[1], nil\n177|\t}\n178|\treturn arr[0], nil\n179|}\n180|\n181|func isNumber(arg string) bool {\n182|\t_, err := strconv.Atoi(arg)\n183|\treturn err == nil\n184|}\n\n\n### pkg/cmd/browse/browse_test.go\n...\n125|\n126|\t\t\tassert.Equal(t, tt.wants.Branch, opts.Branch)\n127|\t\t\tassert.Equal(t, tt.wants.SelectorArg, opts.SelectorArg)\n128|\t\t\tassert.Equal(t, tt.wants.ProjectsFlag, opts.ProjectsFlag)\n129|\t\t\tassert.Equal(t, tt.wants.WikiFlag, opts.WikiFlag)\n130|\t\t\tassert.Equal(t, tt.wants.NoBrowserFlag, opts.NoBrowserFlag)\n131|\t\t\tassert.Equal(t, tt.wants.SettingsFlag, opts.SettingsFlag)\n132|\t\t})\n133|\t}\n134|}\n135|\n136|func Test_runBrowse(t *testing.T) {\n137|\ttests := []struct {\n138|\t\tname          string\n139|\t\topts          BrowseOptions\n140|\t\tbaseRepo      ghrepo.Interface\n141|\t\tdefaultBranch string\n142|\t\texpectedURL   string\n143|\t\twantsErr      bool\n144|\t}{\n145|\t\t{\n146|\t\t\tname: \"no arguments\",\n147|\t\t\topts: BrowseOptions{\n148|\t\t\t\tSelectorArg: \"\",\n149|\t\t\t},\n150|\t\t\tbaseRepo:    ghrepo.New(\"jlsestak\", \"cli\"),\n151|\t\t\texpectedURL: \"https://github.com/jlsestak/cli\",\n152|\t\t},\n153|\t\t{\n154|\t\t\tname: \"settings flag\",\n155|\t\t\topts: BrowseOptions{\n156|\t\t\t\tSettingsFlag: true,\n157|\t\t\t},\n158|\t\t\tbaseRepo:    ghrepo.New(\"bchadwic\", \"ObscuredByClouds\"),\n159|\t\t\texpectedURL: \"https://github.com/bchadwic/ObscuredByClouds/settings\",\n160|\t\t},\n161|\t\t{\n162|\t\t\tname: \"projects flag\",\n163|\t\t\topts: BrowseOptions{\n164|\t\t\t\tProjectsFlag: true,\n165|\t\t\t},\n166|\t\t\tbaseRepo:    ghrepo.New(\"ttran112\", \"7ate9\"),\n167|\t\t\texpectedURL: \"https://github.com/ttran112/7ate9/projects\",\n168|\t\t},\n169|\t\t{\n170|\t\t\tname: \"wiki flag\",\n171|\t\t\topts: BrowseOptions{\n172|\t\t\t\tWikiFlag: true,\n173|\t\t\t},\n174|\t\t\tbaseRepo:    ghrepo.New(\"ravocean\", \"ThreatLevelMidnight\"),\n175|\t\t\texpectedURL: \"https://github.com/ravocean/ThreatLevelMidnight/wiki\",\n176|\t\t},\n177|\t\t{\n178|\t\t\tname:          \"file argument\",\n179|\t\t\topts:          BrowseOptions{SelectorArg: \"path/to/file.txt\"},\n180|\t\t\tbaseRepo:      ghrepo.New(\"ken\", \"mrprofessor\"),\n181|\t\t\tdefaultBranch: \"main\",\n182|\t\t\texpectedURL:   \"https://github.com/ken/mrprofessor/tree/main/path/to/file.txt\",\n183|\t\t},\n184|\t\t{\n185|\t\t\tname: \"issue argument\",\n186|\t\t\topts: BrowseOptions{\n187|\t\t\t\tSelectorArg: \"217\",\n188|\t\t\t},\n189|\t\t\tbaseRepo:    ghrepo.New(\"kevin\", \"MinTy\"),\n190|\t\t\texpectedURL: \"https://github.com/kevin/MinTy/issues/217\",\n191|\t\t},\n192|\t\t{\n193|\t\t\tname: \"branch flag\",\n194|\t\t\topts: BrowseOptions{\n195|\t\t\t\tBranch: \"trunk\",\n196|\t\t\t},\n197|\t\t\tbaseRepo:    ghrepo.New(\"jlsestak\", \"CouldNotThinkOfARepoName\"),\n198|\t\t\texpectedURL: \"https://github.com/jlsestak/CouldNotThinkOfARepoName/tree/trunk/\",\n199|\t\t},\n200|\t\t{\n201|\t\t\tname: \"branch flag with file\",\n202|\t\t\topts: BrowseOptions{\n203|\t\t\t\tBranch:      \"trunk\",\n204|\t\t\t\tSelectorArg: \"main.go\",\n205|\t\t\t},\n206|\t\t\tbaseRepo:    ghrepo.New(\"bchadwic\", \"LedZeppelinIV\"),\n207|\t\t\texpectedURL: \"https://github.com/bchadwic/LedZeppelinIV/tree/trunk/main.go\",\n208|\t\t},\n209|\t\t{\n210|\t\t\tname: \"file with line number\",\n211|\t\t\topts: BrowseOptions{\n212|\t\t\t\tSelectorArg: \"path/to/file.txt:32\",\n213|\t\t\t},\n214|\t\t\tbaseRepo:      ghrepo.New(\"ravocean\", \"angur\"),\n215|\t\t\tdefaultBranch: \"trunk\",\n216|\t\t\texpectedURL:   \"https://github.com/ravocean/angur/tree/trunk/path/to/file.txt#L32\",\n217|\t\t},\n218|\t\t{\n219|\t\t\tname: \"file with invalid line number\",\n220|\t\t\topts: BrowseOptions{\n221|\t\t\t\tSelectorArg: \"path/to/file.txt:32:32\",\n222|\t\t\t},\n223|\t\t\tbaseRepo: ghrepo.New(\"ttran112\", \"ttrain211\"),\n224|\t\t\twantsErr: true,\n225|\t\t},\n226|\t\t{\n227|\t\t\tname: \"branch with issue number\",\n228|\t\t\topts: BrowseOptions{\n229|\t\t\t\tSelectorArg: \"217\",\n230|\t\t\t\tBranch:      \"trunk\",\n231|\t\t\t},\n232|\t\t\tbaseRepo:    ghrepo.New(\"ken\", \"grc\"),\n233|\t\t\twantsErr:    false,\n234|\t\t\texpectedURL: \"https://github.com/ken/grc/issues/217\",\n235|\t\t},\n236|\t\t{\n237|\t\t\tname: \"opening branch file with line number\",\n238|\t\t\topts: BrowseOptions{\n239|\t\t\t\tBranch:      \"first-browse-pull\",\n240|\t\t\t\tSelectorArg: \"browse.go:32\",\n241|\t\t\t},\n242|\t\t\tbaseRepo:    ghrepo.New(\"github\", \"ThankYouGitHub\"),\n243|\t\t\twantsErr:    false,\n244|\t\t\texpectedURL: \"https://github.com/github/ThankYouGitHub/tree/first-browse-pull/browse.go#L32\",\n245|\t\t},\n246|\t\t{\n247|\t\t\tname: \"no browser with branch file and line number\",\n248|\t\t\topts: BrowseOptions{\n249|\t\t\t\tBranch:        \"3-0-stable\",\n250|\t\t\t\tSelectorArg:   \"init.rb:6\",\n251|\t\t\t\tNoBrowserFlag: true,\n252|\t\t\t},\n253|\t\t\tbaseRepo:    ghrepo.New(\"mislav\", \"will_paginate\"),\n254|\t\t\twantsErr:    false,\n255|\t\t\texpectedURL: \"https://github.com/mislav/will_paginate/tree/3-0-stable/init.rb#L6\",\n256|\t\t},\n257|\t}\n258|\n259|\tfor _, tt := range tests {\n260|\t\tt.Run(tt.name, func(t *testing.T) {\n261|\t\t\tio, _, stdout, stderr := iostreams.Test()\n262|\t\t\tbrowser := cmdutil.TestBrowser{}\n263|\n264|\t\t\treg := httpmock.Registry{}\n265|\t\t\tdefer reg.Verify(t)\n266|\t\t\tif tt.defaultBranch != \"\" {\n267|\t\t\t\treg.StubRepoInfoResponse(tt.baseRepo.RepoOwner(), tt.baseRepo.RepoName(), tt.defaultBranch)\n268|\t\t\t}\n269|\n270|\t\t\topts := tt.opts\n271|\t\t\topts.IO = io\n272|\t\t\topts.BaseRepo = func() (ghrepo.Interface, error) {\n273|\t\t\t\treturn tt.baseRepo, nil\n274|\t\t\t}\n275|\t\t\topts.HttpClient = func() (*http.Client, error) {\n276|\t\t\t\treturn &http.Client{Transport: &reg}, nil\n277|\t\t\t}\n278|\t\t\topts.Browser = &browser\n279|\n280|\t\t\terr := runBrowse(&opts)\n281|\t\t\tif tt.wantsErr {\n282|\t\t\t\tassert.Error(t, err)\n283|\t\t\t} else {\n284|\t\t\t\tassert.NoError(t, err)\n285|\t\t\t}\n286|\n287|\t\t\tif opts.NoBrowserFlag {\n288|\t\t\t\tassert.Equal(t, fmt.Sprintf(\"%s\\n\", tt.expectedURL), stdout.String())\n289|\t\t\t\tassert.Equal(t, \"\", stderr.String())\n290|\t\t\t\tbrowser.Verify(t, \"\")\n291|\t\t\t} else {\n292|\t\t\t\tassert.Equal(t, \"\", stdout.String())\n293|\t\t\t\tassert.Equal(t, \"\", stderr.String())\n294|\t\t\t\tbrowser.Verify(t, tt.expectedURL)\n295|\t\t\t}\n296|\t\t})\n297|\t}\n298|}\n299|\n300|func Test_parseFileArg(t *testing.T) {\n301|\ttests := []struct {\n302|\t\tname            string\n303|\t\targ             string\n304|\t\terrorExpected   bool\n305|\t\texpectedFileArg string\n306|\t\tstderrExpected  string\n307|\t}{\n308|\t\t{\n309|\t\t\tname:            \"non line number\",\n310|\t\t\targ:             \"main.go\",\n311|\t\t\terrorExpected:   false,\n312|\t\t\texpectedFileArg: \"main.go\",\n313|\t\t},\n314|\t\t{\n315|\t\t\tname:            \"line number\",\n316|\t\t\targ:             \"main.go:32\",\n317|\t\t\terrorExpected:   false,\n318|\t\t\texpectedFileArg: \"main.go#L32\",\n319|\t\t},\n320|\t\t{\n321|\t\t\tname:           \"non line number error\",\n322|\t\t\targ:            \"ma:in.go\",\n323|\t\t\terrorExpected:  true,\n324|\t\t\tstderrExpected: \"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\",\n325|\t\t},\n326|\t}\n327|\tfor _, tt := range tests {\n328|\t\tfileArg, err := parseFileArg(tt.arg)\n329|\t\tif tt.errorExpected {\n330|\t\t\tassert.Equal(t, err.Error(), tt.stderrExpected)\n331|\t\t} else {\n332|\t\t\tassert.Equal(t, err, nil)\n333|\t\t\tassert.Equal(t, tt.expectedFileArg, fileArg)\n334|\t\t}\n335|\t}\n336|}\n\n\n\n\n###\n\nPlease provide the class name, function or method name, or the exact line numbers that need to be edited.\nThe possible location outputs should be either \"class\", \"function\" or \"line\".\n\n### Examples:\n```\nfull_path1/file1.go\nline: 10\nclass: MyClass1\nline: 51\n\nfull_path2/file2.go\nfunction: MyClass2.my_method\nline: 12\n\nfull_path3/file3.go\nfunction: my_function\nline: 24\nline: 156\n```\n\nReturn just the location(s) wrapped with ```.\n",
        "response": [
          "```\npkg/cmd/browse/browse.go\nfunction: parseFileArg\n\npkg/cmd/browse/browse_test.go\nfunction: Test_parseFileArg\n\npkg/cmd/browse/browse_test.go\nfunction: Test_runBrowse\n```",
          "```\npkg/cmd/browse/browse.go\nfunction: parseFileArg\nfunction: NewCmdBrowse\n\npkg/cmd/browse/browse_test.go\nfunction: Test_parseFileArg\nfunction: Test_runBrowse\n```"
        ],
        "usage": {
          "completion_tokens": 0,
          "prompt_tokens": 0
        }
      },
      "additional_artifact_loc_edit_location": [
        {
          "raw_output_loc": [
            "```\npkg/cmd/browse/browse.go\nfunction: parseFileArg\n\npkg/cmd/browse/browse_test.go\nfunction: Test_parseFileArg\n\npkg/cmd/browse/browse_test.go\nfunction: Test_runBrowse\n```",
            "```\npkg/cmd/browse/browse.go\nfunction: parseFileArg\nfunction: NewCmdBrowse\n\npkg/cmd/browse/browse_test.go\nfunction: Test_parseFileArg\nfunction: Test_runBrowse\n```"
          ]
        }
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "pkg/cmd/browse/browse.go": [
          "function: parseFileArg\nfunction: NewCmdBrowse"
        ],
        "pkg/cmd/browse/browse_test.go": [
          "function: Test_parseFileArg\nfunction: Test_runBrowse"
        ],
        "pkg/cmdutil/web_browser.go": [
          ""
        ]
      },
      "patches": [
        "diff --git a/pkg/cmd/browse/browse.go b/pkg/cmd/browse/browse.go\nindex 79dd77f..170eae1 100644\n--- a/pkg/cmd/browse/browse.go\n+++ b/pkg/cmd/browse/browse.go\n@@ -170,10 +170,26 @@ func parseFileArg(fileArg string) (string, error) {\n \t\treturn \"\", fmt.Errorf(\"invalid use of colon\\nUse 'gh browse --help' for more information about browse\\n\")\n \t}\n \tif len(arr) > 1 {\n-\t\tif !isNumber(arr[1]) {\n+\t\tspec := arr[1]\n+\t\tif spec == \"\" {\n \t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n \t\t}\n-\t\treturn arr[0] + \"#L\" + arr[1], nil\n+\t\tif strings.Contains(spec, \"-\") {\n+\t\t\tparts := strings.Split(spec, \"-\")\n+\t\t\tif len(parts) != 2 || parts[0] == \"\" || parts[1] == \"\" || !isNumber(parts[0]) || !isNumber(parts[1]) {\n+\t\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n+\t\t\t}\n+\t\t\tstart, _ := strconv.Atoi(parts[0])\n+\t\t\tend, _ := strconv.Atoi(parts[1])\n+\t\t\tif start <= 0 || end <= 0 || start > end {\n+\t\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n+\t\t\t}\n+\t\t\treturn arr[0] + \"#L\" + parts[0] + \"-L\" + parts[1], nil\n+\t\t}\n+\t\tif !isNumber(spec) {\n+\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n+\t\t}\n+\t\treturn arr[0] + \"#L\" + spec, nil\n \t}\n \treturn arr[0], nil\n }\n",
        "diff --git a/pkg/cmd/browse/browse.go b/pkg/cmd/browse/browse.go\nindex 79dd77f..cca0dcb 100644\n--- a/pkg/cmd/browse/browse.go\n+++ b/pkg/cmd/browse/browse.go\n@@ -170,10 +170,17 @@ func parseFileArg(fileArg string) (string, error) {\n \t\treturn \"\", fmt.Errorf(\"invalid use of colon\\nUse 'gh browse --help' for more information about browse\\n\")\n \t}\n \tif len(arr) > 1 {\n-\t\tif !isNumber(arr[1]) {\n-\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n+\t\tlineSpec := arr[1]\n+\t\t// single line number\n+\t\tif isNumber(lineSpec) {\n+\t\t\treturn arr[0] + \"#L\" + lineSpec, nil\n \t\t}\n-\t\treturn arr[0] + \"#L\" + arr[1], nil\n+\t\t// range of line numbers: e.g., \"10-20\"\n+\t\trangeParts := strings.Split(lineSpec, \"-\")\n+\t\tif len(rangeParts) == 2 && isNumber(rangeParts[0]) && isNumber(rangeParts[1]) {\n+\t\t\treturn arr[0] + \"#L\" + rangeParts[0] + \"-L\" + rangeParts[1], nil\n+\t\t}\n+\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n \t}\n \treturn arr[0], nil\n }\n@@ -181,4 +188,4 @@ func parseFileArg(fileArg string) (string, error) {\n func isNumber(arg string) bool {\n \t_, err := strconv.Atoi(arg)\n \treturn err == nil\n-}\n+}\n"
      ],
      "edit_loc_traj": {
        "prompt": "\nPlease review the following GitHub problem description and relevant files, and provide a set of locations that need to be edited to fix the issue.\nThe locations can be specified as class names, function or method names, or exact line numbers that require modification.\n\n### GitHub Problem Description ###\nAdd support for line number range to 'browse'\n### Describe the feature or problem you’d like to solve\r\n\r\nWould like to open the browser to a specific file, with a range of lines highlighted.\r\n\r\n### Proposed solution\r\n\r\nAllow this:\r\n`gh browse test.go:10-20`\r\n\r\nTo open the test.go file and highlight lines 10-20.\r\n\n\n###\n### pkg/cmd/browse/browse.go\n...\n25|\tIO         *iostreams.IOStreams\n26|\n27|\tSelectorArg string\n28|\n29|\tBranch        string\n30|\tProjectsFlag  bool\n31|\tSettingsFlag  bool\n32|\tWikiFlag      bool\n33|\tNoBrowserFlag bool\n34|}\n35|\n36|func NewCmdBrowse(f *cmdutil.Factory, runF func(*BrowseOptions) error) *cobra.Command {\n37|\topts := &BrowseOptions{\n38|\t\tBrowser:    f.Browser,\n39|\t\tHttpClient: f.HttpClient,\n40|\t\tIO:         f.IOStreams,\n41|\t}\n42|\n43|\tcmd := &cobra.Command{\n44|\t\tLong:  \"Open the GitHub repository in the web browser.\",\n45|\t\tShort: \"Open the repository in the browser\",\n46|\t\tUse:   \"browse [<number> | <path>]\",\n47|\t\tArgs:  cobra.MaximumNArgs(1),\n48|\t\tExample: heredoc.Doc(`\n49|\t\t\t$ gh browse\n50|\t\t\t#=> Open the home page of the current repository\n51|\n52|\t\t\t$ gh browse 217\n53|\t\t\t#=> Open issue or pull request 217\n54|\n55|\t\t\t$ gh browse --settings\n56|\t\t\t#=> Open repository settings\n57|\n58|\t\t\t$ gh browse main.go:312\n59|\t\t\t#=> Open main.go at line 312\n60|\n61|\t\t\t$ gh browse main.go --branch main\n62|\t\t\t#=> Open main.go in the main branch\n63|\t\t`),\n64|\t\tAnnotations: map[string]string{\n65|\t\t\t\"IsCore\": \"true\",\n66|\t\t\t\"help:arguments\": heredoc.Doc(`\n67|\t\t\t\tA browser location can be specified using arguments in the following format:\n68|\t\t\t\t- by number for issue or pull request, e.g. \"123\"; or\n69|\t\t\t\t- by path for opening folders and files, e.g. \"cmd/gh/main.go\"\n70|\t\t\t`),\n71|\t\t\t\"help:environment\": heredoc.Doc(`\n72|\t\t\t\tTo configure a web browser other than the default, use the BROWSER environment variable.\n73|\t\t\t`),\n74|\t\t},\n75|\t\tRunE: func(cmd *cobra.Command, args []string) error {\n76|\t\t\topts.BaseRepo = f.BaseRepo\n77|\n78|\t\t\tif len(args) > 0 {\n79|\t\t\t\topts.SelectorArg = args[0]\n80|\t\t\t}\n81|\n82|\t\t\tif err := cmdutil.MutuallyExclusive(\n83|\t\t\t\t\"specify only one of `--branch`, `--projects`, `--wiki`, or `--settings`\",\n84|\t\t\t\topts.Branch != \"\",\n85|\t\t\t\topts.WikiFlag,\n86|\t\t\t\topts.SettingsFlag,\n87|\t\t\t\topts.ProjectsFlag,\n88|\t\t\t); err != nil {\n89|\t\t\t\treturn err\n90|\t\t\t}\n91|\n92|\t\t\tif runF != nil {\n93|\t\t\t\treturn runF(opts)\n94|\t\t\t}\n95|\t\t\treturn runBrowse(opts)\n96|\t\t},\n97|\t}\n98|\n99|\tcmdutil.EnableRepoOverride(cmd, f)\n100|\tcmd.Flags().BoolVarP(&opts.ProjectsFlag, \"projects\", \"p\", false, \"Open repository projects\")\n101|\tcmd.Flags().BoolVarP(&opts.WikiFlag, \"wiki\", \"w\", false, \"Open repository wiki\")\n102|\tcmd.Flags().BoolVarP(&opts.SettingsFlag, \"settings\", \"s\", false, \"Open repository settings\")\n103|\tcmd.Flags().BoolVarP(&opts.NoBrowserFlag, \"no-browser\", \"n\", false, \"Print destination URL instead of opening the browser\")\n104|\tcmd.Flags().StringVarP(&opts.Branch, \"branch\", \"b\", \"\", \"Select another branch by passing in the branch name\")\n105|\n106|\treturn cmd\n107|}\n108|\n109|func runBrowse(opts *BrowseOptions) error {\n110|\tbaseRepo, err := opts.BaseRepo()\n111|\tif err != nil {\n112|\t\treturn fmt.Errorf(\"unable to determine base repository: %w\", err)\n113|\t}\n114|\n115|\thttpClient, err := opts.HttpClient()\n116|\tif err != nil {\n117|\t\treturn fmt.Errorf(\"unable to create an http client: %w\", err)\n118|\t}\n119|\turl := ghrepo.GenerateRepoURL(baseRepo, \"\")\n120|\n121|\tif opts.SelectorArg == \"\" {\n122|\t\tif opts.ProjectsFlag {\n123|\t\t\turl += \"/projects\"\n124|\t\t}\n125|\t\tif opts.SettingsFlag {\n126|\t\t\turl += \"/settings\"\n127|\t\t}\n128|\t\tif opts.WikiFlag {\n129|\t\t\turl += \"/wiki\"\n130|\t\t}\n131|\t\tif opts.Branch != \"\" {\n132|\t\t\turl += \"/tree/\" + opts.Branch + \"/\"\n133|\t\t}\n134|\t} else {\n135|\t\tif isNumber(opts.SelectorArg) {\n136|\t\t\turl += \"/issues/\" + opts.SelectorArg\n137|\t\t} else {\n138|\t\t\tfileArg, err := parseFileArg(opts.SelectorArg)\n139|\t\t\tif err != nil {\n140|\t\t\t\treturn err\n141|\t\t\t}\n142|\t\t\tif opts.Branch != \"\" {\n143|\t\t\t\turl += \"/tree/\" + opts.Branch + \"/\"\n144|\t\t\t} else {\n145|\t\t\t\tapiClient := api.NewClientFromHTTP(httpClient)\n146|\t\t\t\tbranchName, err := api.RepoDefaultBranch(apiClient, baseRepo)\n147|\t\t\t\tif err != nil {\n148|\t\t\t\t\treturn err\n149|\t\t\t\t}\n150|\t\t\t\turl += \"/tree/\" + branchName + \"/\"\n151|\t\t\t}\n152|\t\t\turl += fileArg\n153|\t\t}\n154|\t}\n155|\n156|\tif opts.NoBrowserFlag {\n157|\t\tfmt.Fprintf(opts.IO.Out, \"%s\\n\", url)\n158|\t\treturn nil\n159|\t} else {\n160|\t\tif opts.IO.IsStdoutTTY() {\n161|\t\t\tfmt.Fprintf(opts.IO.Out, \"now opening %s in browser\\n\", url)\n162|\t\t}\n163|\t\treturn opts.Browser.Browse(url)\n164|\t}\n165|}\n166|\n167|func parseFileArg(fileArg string) (string, error) {\n168|\tarr := strings.Split(fileArg, \":\")\n169|\tif len(arr) > 2 {\n170|\t\treturn \"\", fmt.Errorf(\"invalid use of colon\\nUse 'gh browse --help' for more information about browse\\n\")\n171|\t}\n172|\tif len(arr) > 1 {\n173|\t\tif !isNumber(arr[1]) {\n174|\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n175|\t\t}\n176|\t\treturn arr[0] + \"#L\" + arr[1], nil\n177|\t}\n178|\treturn arr[0], nil\n179|}\n180|\n181|func isNumber(arg string) bool {\n182|\t_, err := strconv.Atoi(arg)\n183|\treturn err == nil\n184|}\n\n\n### pkg/cmd/browse/browse_test.go\n...\n125|\n126|\t\t\tassert.Equal(t, tt.wants.Branch, opts.Branch)\n127|\t\t\tassert.Equal(t, tt.wants.SelectorArg, opts.SelectorArg)\n128|\t\t\tassert.Equal(t, tt.wants.ProjectsFlag, opts.ProjectsFlag)\n129|\t\t\tassert.Equal(t, tt.wants.WikiFlag, opts.WikiFlag)\n130|\t\t\tassert.Equal(t, tt.wants.NoBrowserFlag, opts.NoBrowserFlag)\n131|\t\t\tassert.Equal(t, tt.wants.SettingsFlag, opts.SettingsFlag)\n132|\t\t})\n133|\t}\n134|}\n135|\n136|func Test_runBrowse(t *testing.T) {\n137|\ttests := []struct {\n138|\t\tname          string\n139|\t\topts          BrowseOptions\n140|\t\tbaseRepo      ghrepo.Interface\n141|\t\tdefaultBranch string\n142|\t\texpectedURL   string\n143|\t\twantsErr      bool\n144|\t}{\n145|\t\t{\n146|\t\t\tname: \"no arguments\",\n147|\t\t\topts: BrowseOptions{\n148|\t\t\t\tSelectorArg: \"\",\n149|\t\t\t},\n150|\t\t\tbaseRepo:    ghrepo.New(\"jlsestak\", \"cli\"),\n151|\t\t\texpectedURL: \"https://github.com/jlsestak/cli\",\n152|\t\t},\n153|\t\t{\n154|\t\t\tname: \"settings flag\",\n155|\t\t\topts: BrowseOptions{\n156|\t\t\t\tSettingsFlag: true,\n157|\t\t\t},\n158|\t\t\tbaseRepo:    ghrepo.New(\"bchadwic\", \"ObscuredByClouds\"),\n159|\t\t\texpectedURL: \"https://github.com/bchadwic/ObscuredByClouds/settings\",\n160|\t\t},\n161|\t\t{\n162|\t\t\tname: \"projects flag\",\n163|\t\t\topts: BrowseOptions{\n164|\t\t\t\tProjectsFlag: true,\n165|\t\t\t},\n166|\t\t\tbaseRepo:    ghrepo.New(\"ttran112\", \"7ate9\"),\n167|\t\t\texpectedURL: \"https://github.com/ttran112/7ate9/projects\",\n168|\t\t},\n169|\t\t{\n170|\t\t\tname: \"wiki flag\",\n171|\t\t\topts: BrowseOptions{\n172|\t\t\t\tWikiFlag: true,\n173|\t\t\t},\n174|\t\t\tbaseRepo:    ghrepo.New(\"ravocean\", \"ThreatLevelMidnight\"),\n175|\t\t\texpectedURL: \"https://github.com/ravocean/ThreatLevelMidnight/wiki\",\n176|\t\t},\n177|\t\t{\n178|\t\t\tname:          \"file argument\",\n179|\t\t\topts:          BrowseOptions{SelectorArg: \"path/to/file.txt\"},\n180|\t\t\tbaseRepo:      ghrepo.New(\"ken\", \"mrprofessor\"),\n181|\t\t\tdefaultBranch: \"main\",\n182|\t\t\texpectedURL:   \"https://github.com/ken/mrprofessor/tree/main/path/to/file.txt\",\n183|\t\t},\n184|\t\t{\n185|\t\t\tname: \"issue argument\",\n186|\t\t\topts: BrowseOptions{\n187|\t\t\t\tSelectorArg: \"217\",\n188|\t\t\t},\n189|\t\t\tbaseRepo:    ghrepo.New(\"kevin\", \"MinTy\"),\n190|\t\t\texpectedURL: \"https://github.com/kevin/MinTy/issues/217\",\n191|\t\t},\n192|\t\t{\n193|\t\t\tname: \"branch flag\",\n194|\t\t\topts: BrowseOptions{\n195|\t\t\t\tBranch: \"trunk\",\n196|\t\t\t},\n197|\t\t\tbaseRepo:    ghrepo.New(\"jlsestak\", \"CouldNotThinkOfARepoName\"),\n198|\t\t\texpectedURL: \"https://github.com/jlsestak/CouldNotThinkOfARepoName/tree/trunk/\",\n199|\t\t},\n200|\t\t{\n201|\t\t\tname: \"branch flag with file\",\n202|\t\t\topts: BrowseOptions{\n203|\t\t\t\tBranch:      \"trunk\",\n204|\t\t\t\tSelectorArg: \"main.go\",\n205|\t\t\t},\n206|\t\t\tbaseRepo:    ghrepo.New(\"bchadwic\", \"LedZeppelinIV\"),\n207|\t\t\texpectedURL: \"https://github.com/bchadwic/LedZeppelinIV/tree/trunk/main.go\",\n208|\t\t},\n209|\t\t{\n210|\t\t\tname: \"file with line number\",\n211|\t\t\topts: BrowseOptions{\n212|\t\t\t\tSelectorArg: \"path/to/file.txt:32\",\n213|\t\t\t},\n214|\t\t\tbaseRepo:      ghrepo.New(\"ravocean\", \"angur\"),\n215|\t\t\tdefaultBranch: \"trunk\",\n216|\t\t\texpectedURL:   \"https://github.com/ravocean/angur/tree/trunk/path/to/file.txt#L32\",\n217|\t\t},\n218|\t\t{\n219|\t\t\tname: \"file with invalid line number\",\n220|\t\t\topts: BrowseOptions{\n221|\t\t\t\tSelectorArg: \"path/to/file.txt:32:32\",\n222|\t\t\t},\n223|\t\t\tbaseRepo: ghrepo.New(\"ttran112\", \"ttrain211\"),\n224|\t\t\twantsErr: true,\n225|\t\t},\n226|\t\t{\n227|\t\t\tname: \"branch with issue number\",\n228|\t\t\topts: BrowseOptions{\n229|\t\t\t\tSelectorArg: \"217\",\n230|\t\t\t\tBranch:      \"trunk\",\n231|\t\t\t},\n232|\t\t\tbaseRepo:    ghrepo.New(\"ken\", \"grc\"),\n233|\t\t\twantsErr:    false,\n234|\t\t\texpectedURL: \"https://github.com/ken/grc/issues/217\",\n235|\t\t},\n236|\t\t{\n237|\t\t\tname: \"opening branch file with line number\",\n238|\t\t\topts: BrowseOptions{\n239|\t\t\t\tBranch:      \"first-browse-pull\",\n240|\t\t\t\tSelectorArg: \"browse.go:32\",\n241|\t\t\t},\n242|\t\t\tbaseRepo:    ghrepo.New(\"github\", \"ThankYouGitHub\"),\n243|\t\t\twantsErr:    false,\n244|\t\t\texpectedURL: \"https://github.com/github/ThankYouGitHub/tree/first-browse-pull/browse.go#L32\",\n245|\t\t},\n246|\t\t{\n247|\t\t\tname: \"no browser with branch file and line number\",\n248|\t\t\topts: BrowseOptions{\n249|\t\t\t\tBranch:        \"3-0-stable\",\n250|\t\t\t\tSelectorArg:   \"init.rb:6\",\n251|\t\t\t\tNoBrowserFlag: true,\n252|\t\t\t},\n253|\t\t\tbaseRepo:    ghrepo.New(\"mislav\", \"will_paginate\"),\n254|\t\t\twantsErr:    false,\n255|\t\t\texpectedURL: \"https://github.com/mislav/will_paginate/tree/3-0-stable/init.rb#L6\",\n256|\t\t},\n257|\t}\n258|\n259|\tfor _, tt := range tests {\n260|\t\tt.Run(tt.name, func(t *testing.T) {\n261|\t\t\tio, _, stdout, stderr := iostreams.Test()\n262|\t\t\tbrowser := cmdutil.TestBrowser{}\n263|\n264|\t\t\treg := httpmock.Registry{}\n265|\t\t\tdefer reg.Verify(t)\n266|\t\t\tif tt.defaultBranch != \"\" {\n267|\t\t\t\treg.StubRepoInfoResponse(tt.baseRepo.RepoOwner(), tt.baseRepo.RepoName(), tt.defaultBranch)\n268|\t\t\t}\n269|\n270|\t\t\topts := tt.opts\n271|\t\t\topts.IO = io\n272|\t\t\topts.BaseRepo = func() (ghrepo.Interface, error) {\n273|\t\t\t\treturn tt.baseRepo, nil\n274|\t\t\t}\n275|\t\t\topts.HttpClient = func() (*http.Client, error) {\n276|\t\t\t\treturn &http.Client{Transport: &reg}, nil\n277|\t\t\t}\n278|\t\t\topts.Browser = &browser\n279|\n280|\t\t\terr := runBrowse(&opts)\n281|\t\t\tif tt.wantsErr {\n282|\t\t\t\tassert.Error(t, err)\n283|\t\t\t} else {\n284|\t\t\t\tassert.NoError(t, err)\n285|\t\t\t}\n286|\n287|\t\t\tif opts.NoBrowserFlag {\n288|\t\t\t\tassert.Equal(t, fmt.Sprintf(\"%s\\n\", tt.expectedURL), stdout.String())\n289|\t\t\t\tassert.Equal(t, \"\", stderr.String())\n290|\t\t\t\tbrowser.Verify(t, \"\")\n291|\t\t\t} else {\n292|\t\t\t\tassert.Equal(t, \"\", stdout.String())\n293|\t\t\t\tassert.Equal(t, \"\", stderr.String())\n294|\t\t\t\tbrowser.Verify(t, tt.expectedURL)\n295|\t\t\t}\n296|\t\t})\n297|\t}\n298|}\n299|\n300|func Test_parseFileArg(t *testing.T) {\n301|\ttests := []struct {\n302|\t\tname            string\n303|\t\targ             string\n304|\t\terrorExpected   bool\n305|\t\texpectedFileArg string\n306|\t\tstderrExpected  string\n307|\t}{\n308|\t\t{\n309|\t\t\tname:            \"non line number\",\n310|\t\t\targ:             \"main.go\",\n311|\t\t\terrorExpected:   false,\n312|\t\t\texpectedFileArg: \"main.go\",\n313|\t\t},\n314|\t\t{\n315|\t\t\tname:            \"line number\",\n316|\t\t\targ:             \"main.go:32\",\n317|\t\t\terrorExpected:   false,\n318|\t\t\texpectedFileArg: \"main.go#L32\",\n319|\t\t},\n320|\t\t{\n321|\t\t\tname:           \"non line number error\",\n322|\t\t\targ:            \"ma:in.go\",\n323|\t\t\terrorExpected:  true,\n324|\t\t\tstderrExpected: \"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\",\n325|\t\t},\n326|\t}\n327|\tfor _, tt := range tests {\n328|\t\tfileArg, err := parseFileArg(tt.arg)\n329|\t\tif tt.errorExpected {\n330|\t\t\tassert.Equal(t, err.Error(), tt.stderrExpected)\n331|\t\t} else {\n332|\t\t\tassert.Equal(t, err, nil)\n333|\t\t\tassert.Equal(t, tt.expectedFileArg, fileArg)\n334|\t\t}\n335|\t}\n336|}\n\n\n\n\n###\n\nPlease provide the class name, function or method name, or the exact line numbers that need to be edited.\nThe possible location outputs should be either \"class\", \"function\" or \"line\".\n\n### Examples:\n```\nfull_path1/file1.go\nline: 10\nclass: MyClass1\nline: 51\n\nfull_path2/file2.go\nfunction: MyClass2.my_method\nline: 12\n\nfull_path3/file3.go\nfunction: my_function\nline: 24\nline: 156\n```\n\nReturn just the location(s) wrapped with ```.\n",
        "response": [
          "```\npkg/cmd/browse/browse.go\nfunction: parseFileArg\n\npkg/cmd/browse/browse_test.go\nfunction: Test_parseFileArg\n\npkg/cmd/browse/browse_test.go\nfunction: Test_runBrowse\n```",
          "```\npkg/cmd/browse/browse.go\nfunction: parseFileArg\nfunction: NewCmdBrowse\n\npkg/cmd/browse/browse_test.go\nfunction: Test_parseFileArg\nfunction: Test_runBrowse\n```"
        ],
        "usage": {
          "completion_tokens": 0,
          "prompt_tokens": 0
        }
      },
      "additional_artifact_loc_edit_location": [
        {
          "raw_output_loc": [
            "```\npkg/cmd/browse/browse.go\nfunction: parseFileArg\n\npkg/cmd/browse/browse_test.go\nfunction: Test_parseFileArg\n\npkg/cmd/browse/browse_test.go\nfunction: Test_runBrowse\n```",
            "```\npkg/cmd/browse/browse.go\nfunction: parseFileArg\nfunction: NewCmdBrowse\n\npkg/cmd/browse/browse_test.go\nfunction: Test_parseFileArg\nfunction: Test_runBrowse\n```"
          ]
        }
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/pkg/cmd/browse/browse.go b/pkg/cmd/browse/browse.go\nindex 79dd77f..f511b15 100644\n--- a/pkg/cmd/browse/browse.go\n+++ b/pkg/cmd/browse/browse.go\n@@ -169,11 +169,21 @@ func parseFileArg(fileArg string) (string, error) {\n \tif len(arr) > 2 {\n \t\treturn \"\", fmt.Errorf(\"invalid use of colon\\nUse 'gh browse --help' for more information about browse\\n\")\n \t}\n-\tif len(arr) > 1 {\n-\t\tif !isNumber(arr[1]) {\n-\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n+\tif len(arr) == 2 {\n+\t\tlineSpec := arr[1]\n+\t\t// Single line number\n+\t\tif isNumber(lineSpec) {\n+\t\t\treturn arr[0] + \"#L\" + lineSpec, nil\n \t\t}\n-\t\treturn arr[0] + \"#L\" + arr[1], nil\n+\t\t// Line range, e.g., \"10-20\"\n+\t\tif strings.Contains(lineSpec, \"-\") {\n+\t\t\trangeParts := strings.Split(lineSpec, \"-\")\n+\t\t\tif len(rangeParts) != 2 || rangeParts[0] == \"\" || rangeParts[1] == \"\" || !isNumber(rangeParts[0]) || !isNumber(rangeParts[1]) {\n+\t\t\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n+\t\t\t}\n+\t\t\treturn arr[0] + \"#L\" + rangeParts[0] + \"-L\" + rangeParts[1], nil\n+\t\t}\n+\t\treturn \"\", fmt.Errorf(\"invalid line number after colon\\nUse 'gh browse --help' for more information about browse\\n\")\n \t}\n \treturn arr[0], nil\n }\n@@ -181,4 +191,4 @@ func parseFileArg(fileArg string) (string, error) {\n func isNumber(arg string) bool {\n \t_, err := strconv.Atoi(arg)\n \treturn err == nil\n-}\n+}\n",
  "7_resolved": true
}