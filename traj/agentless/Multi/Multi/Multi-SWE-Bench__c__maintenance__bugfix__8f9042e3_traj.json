{
  "instance_id": "Multi-SWE-Bench__c__maintenance__bugfix__8f9042e3",
  "original_id": "ponylang__ponyc-2532",
  "1_model_selected_files": [],
  "2_embedding_selected_files": [
    "src/libponyc/expr/match.c",
    "src/libponyc/type/matchtype.c",
    "src/libponyc/pass/sugar.c",
    "src/libponyc/pass/syntax.c",
    "src/libponyc/type/subtype.c",
    "src/libponyc/pass/casemethod.c",
    "src/libponyc/expr/reference.c",
    "src/libponyc/type/compattype.c",
    "src/libponyc/pass/expr.c",
    "src/libponyc/type/matchtype.h",
    "src/libponyc/type/viewpoint.c",
    "src/libponyc/type/cap.c",
    "src/libponyc/pass/flatten.c",
    "src/libponyc/type/alias.c",
    "src/libponyc/expr/match.h",
    "src/libponyc/expr/operator.c",
    "src/libponyc/pass/traits.c",
    "src/libponyc/pass/names.c",
    "src/libponyc/type/typeparam.c",
    "src/libponyc/expr/postfix.c",
    "src/libponyc/expr/array.c",
    "src/libponyc/pass/scope.c",
    "src/libponyc/expr/ffi.c",
    "src/libponyc/type/reify.c"
  ],
  "3_final_combined_files": [
    "src/libponyc/expr/match.c",
    "src/libponyc/type/matchtype.c",
    "src/libponyc/pass/sugar.c"
  ],
  "4_related_elements": {
    "src/libponyc/type/matchtype.c": [
      "function: is_x_match_tuple\nfunction: is_x_match_nominal\nfunction: is_tuple_match_tuple\nfunction: is_x_match_x\nfunction: is_union_match_x\nfunction: is_x_match_union\nfunction: is_isect_match_x\nfunction: is_x_match_isect"
    ],
    "src/libponyc/expr/match.c": [
      "function: expr_case\nfunction: make_pattern_type\nfunction: is_match_exhaustive\nfunction: case_expr_matches_type_alone\nfunction: expr_match"
    ],
    "src/libponyc/pass/sugar.c": [
      ""
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "src/libponyc/type/matchtype.c": [
          "function: is_x_match_tuple\nline: 194\nline: 195\nline: 196\nfunction: is_x_match_nominal\nline: 385\nline: 386\nline: 387"
        ],
        "src/libponyc/expr/match.c": [
          ""
        ],
        "src/libponyc/pass/sugar.c": [
          ""
        ]
      },
      "patches": [
        "diff --git a/src/libponyc/type/matchtype.c b/src/libponyc/type/matchtype.c\nindex da8193b..e1dbceb 100644\n--- a/src/libponyc/type/matchtype.c\n+++ b/src/libponyc/type/matchtype.c\n@@ -192,6 +192,10 @@ static matchtype_t is_x_match_tuple(ast_t* operand, ast_t* pattern,\n       return is_tuple_match_tuple(operand, pattern, opt);\n \n     case TK_NOMINAL:\n+      // Allow empty interfaces (eg Any) that are supertypes of tuples to match\n+      // tuple patterns of any cardinality.\n+      if(is_subtype(pattern, operand, opt))\n+        return MATCHTYPE_ACCEPT;\n       return MATCHTYPE_REJECT;\n \n     case TK_TYPEPARAMREF:\n",
        "diff --git a/src/libponyc/type/matchtype.c b/src/libponyc/type/matchtype.c\nindex da8193b..65404b2 100644\n--- a/src/libponyc/type/matchtype.c\n+++ b/src/libponyc/type/matchtype.c\n@@ -192,7 +192,14 @@ static matchtype_t is_x_match_tuple(ast_t* operand, ast_t* pattern,\n       return is_tuple_match_tuple(operand, pattern, opt);\n \n     case TK_NOMINAL:\n+    {\n+      // Allow empty interfaces (eg, Any) to match tuples of any cardinality.\n+      AST_GET_CHILDREN(operand, o_pkg, o_id, o_typeargs, o_cap, o_eph);\n+      const char* name = ast_name(o_id);\n+      if((name != NULL) && (strcmp(name, \"Any\") == 0))\n+        return MATCHTYPE_ACCEPT;\n       return MATCHTYPE_REJECT;\n+    }\n \n     case TK_TYPEPARAMREF:\n       return is_typeparam_match_x(operand, pattern, opt);\n@@ -383,7 +390,15 @@ static matchtype_t is_x_match_nominal(ast_t* operand, ast_t* pattern,\n       return is_isect_match_x(operand, pattern, opt);\n \n     case TK_TUPLETYPE:\n+    {\n+      // If the pattern is an empty interface (eg, Any), allow it to match\n+      // tuples of any cardinality.\n+      AST_GET_CHILDREN(pattern, p_pkg, p_id, p_typeargs, p_cap, p_eph);\n+      const char* pname = ast_name(p_id);\n+      if((pname != NULL) && (strcmp(pname, \"Any\") == 0))\n+        return MATCHTYPE_ACCEPT;\n       return MATCHTYPE_REJECT;\n+    }\n \n     case TK_NOMINAL:\n       return is_nominal_match_nominal(operand, pattern, opt);\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "src/libponyc/type/matchtype.c": [
          "function: is_x_match_tuple\nline: 194\nfunction: is_x_match_nominal\nline: 385"
        ],
        "src/libponyc/expr/match.c": [
          ""
        ],
        "src/libponyc/pass/sugar.c": [
          ""
        ]
      },
      "patches": [
        "diff --git a/src/libponyc/type/matchtype.c b/src/libponyc/type/matchtype.c\nindex da8193b..0ce61f3 100644\n--- a/src/libponyc/type/matchtype.c\n+++ b/src/libponyc/type/matchtype.c\n@@ -192,6 +192,10 @@ static matchtype_t is_x_match_tuple(ast_t* operand, ast_t* pattern,\n       return is_tuple_match_tuple(operand, pattern, opt);\n \n     case TK_NOMINAL:\n+      // Allow empty interfaces (eg Any) to match tuples of any cardinality.\n+      // If the tuple pattern is a subtype of the nominal operand, accept.\n+      if(is_subtype(pattern, operand, opt))\n+        return MATCHTYPE_ACCEPT;\n       return MATCHTYPE_REJECT;\n \n     case TK_TYPEPARAMREF:\n",
        "diff --git a/src/libponyc/type/matchtype.c b/src/libponyc/type/matchtype.c\nindex da8193b..d8c00be 100644\n--- a/src/libponyc/type/matchtype.c\n+++ b/src/libponyc/type/matchtype.c\n@@ -192,7 +192,15 @@ static matchtype_t is_x_match_tuple(ast_t* operand, ast_t* pattern,\n       return is_tuple_match_tuple(operand, pattern, opt);\n \n     case TK_NOMINAL:\n+    {\n+      // Allow empty interfaces (e.g., Any) to match tuples of any cardinality.\n+      // We do this by checking whether the tuple pattern type is a subtype of\n+      // the nominal operand type. If it is, the match is possible.\n+      if(is_subtype(pattern, operand, opt))\n+        return MATCHTYPE_ACCEPT;\n+\n       return MATCHTYPE_REJECT;\n+    }\n \n     case TK_TYPEPARAMREF:\n       return is_typeparam_match_x(operand, pattern, opt);\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/src/libponyc/type/matchtype.c b/src/libponyc/type/matchtype.c\nindex da8193b..65404b2 100644\n--- a/src/libponyc/type/matchtype.c\n+++ b/src/libponyc/type/matchtype.c\n@@ -192,7 +192,14 @@ static matchtype_t is_x_match_tuple(ast_t* operand, ast_t* pattern,\n       return is_tuple_match_tuple(operand, pattern, opt);\n \n     case TK_NOMINAL:\n+    {\n+      // Allow empty interfaces (eg, Any) to match tuples of any cardinality.\n+      AST_GET_CHILDREN(operand, o_pkg, o_id, o_typeargs, o_cap, o_eph);\n+      const char* name = ast_name(o_id);\n+      if((name != NULL) && (strcmp(name, \"Any\") == 0))\n+        return MATCHTYPE_ACCEPT;\n       return MATCHTYPE_REJECT;\n+    }\n \n     case TK_TYPEPARAMREF:\n       return is_typeparam_match_x(operand, pattern, opt);\n@@ -383,7 +390,15 @@ static matchtype_t is_x_match_nominal(ast_t* operand, ast_t* pattern,\n       return is_isect_match_x(operand, pattern, opt);\n \n     case TK_TUPLETYPE:\n+    {\n+      // If the pattern is an empty interface (eg, Any), allow it to match\n+      // tuples of any cardinality.\n+      AST_GET_CHILDREN(pattern, p_pkg, p_id, p_typeargs, p_cap, p_eph);\n+      const char* pname = ast_name(p_id);\n+      if((pname != NULL) && (strcmp(pname, \"Any\") == 0))\n+        return MATCHTYPE_ACCEPT;\n       return MATCHTYPE_REJECT;\n+    }\n \n     case TK_NOMINAL:\n       return is_nominal_match_nominal(operand, pattern, opt);\n",
  "7_resolved": false
}