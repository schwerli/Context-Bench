{
  "instance_id": "Multi-SWE-Bench__go__maintenance__bugfix__3deeea9c",
  "original_id": "cli__cli-2250",
  "1_model_selected_files": [
    "pkg/cmd/pr/create/create.go",
    "api/queries_pr.go",
    "pkg/cmd/pr/shared/params.go"
  ],
  "2_embedding_selected_files": [
    "pkg/cmd/pr/create/create.go",
    "pkg/cmd/pr/create/create_test.go",
    "pkg/cmd/pr/pr.go",
    "pkg/cmd/pr/shared/survey.go",
    "pkg/cmd/pr/shared/preserve.go",
    "pkg/cmd/pr/shared/display.go",
    "pkg/cmd/pr/shared/survey_test.go",
    "pkg/cmd/pr/shared/lookup.go",
    "pkg/cmd/pr/shared/preserve_test.go",
    "pkg/cmd/pr/shared/params.go",
    "pkg/cmd/config/set/set.go",
    "internal/config/config_type.go",
    "pkg/cmd/config/config.go",
    "pkg/cmd/pr/shared/state.go",
    "pkg/cmd/pr/shared/comments.go",
    "internal/config/from_env.go",
    "pkg/cmd/config/set/set_test.go",
    "pkg/cmd/pr/create/regexp_writer_test.go",
    "internal/config/from_env_test.go",
    "internal/config/config_type_test.go",
    "pkg/cmd/config/get/get.go",
    "pkg/cmd/pr/shared/display_test.go",
    "pkg/cmd/pr/shared/params_test.go",
    "pkg/cmd/config/get/get_test.go",
    "internal/config/config_file_test.go",
    "pkg/cmd/pr/shared/reaction_groups.go",
    "pkg/cmd/pr/create/regexp_writer.go",
    "internal/config/config_file.go",
    "internal/config/stub.go",
    "internal/config/alias_config.go"
  ],
  "3_final_combined_files": [
    "pkg/cmd/pr/create/create.go",
    "api/queries_pr.go",
    "pkg/cmd/pr/shared/params.go",
    "pkg/cmd/pr/create/create_test.go",
    "pkg/cmd/pr/pr.go"
  ],
  "4_related_elements": {
    "pkg/cmd/pr/create/create.go": [
      "class: CreateOptions\nfunction: NewCmdCreate\nfunction: submitPR\nfunction: generateCompareURL"
    ],
    "api/queries_pr.go": [
      "class: PullRequest\nfunction: CreatePullRequest\nfunction: PullRequestByNumber\nfunction: PullRequestForBranch"
    ],
    "pkg/cmd/pr/shared/params.go": [
      "function: WithPrAndIssueQueryParams"
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "pkg/cmd/pr/create/create.go": [
          "line: 56\nfunction: NewCmdCreate\nfunction: submitPR\nfunction: createRun"
        ],
        "api/queries_pr.go": [
          "function: CreatePullRequest"
        ],
        "pkg/cmd/pr/shared/params.go": [
          ""
        ]
      },
      "patches": [
        "diff --git a/api/queries_pr.go b/api/queries_pr.go\nindex 46fc1dd..fab8862 100644\n--- a/api/queries_pr.go\n+++ b/api/queries_pr.go\n@@ -821,7 +821,7 @@ func CreatePullRequest(client *Client, repo *Repository, params map[string]inter\n \t}\n \tfor key, val := range params {\n \t\tswitch key {\n-\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\":\n+\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\", \"maintainerCanModify\":\n \t\t\tinputParams[key] = val\n \t\t}\n \t}\ndiff --git a/pkg/cmd/pr/create/create.go b/pkg/cmd/pr/create/create.go\nindex acb8d76..b4b3ce6 100644\n--- a/pkg/cmd/pr/create/create.go\n+++ b/pkg/cmd/pr/create/create.go\n@@ -42,11 +42,12 @@ type CreateOptions struct {\n \tWebMode     bool\n \tRecoverFile string\n \n-\tIsDraft    bool\n-\tTitle      string\n-\tBody       string\n-\tBaseBranch string\n-\tHeadBranch string\n+\tIsDraft              bool\n+\tMaintainerCanModify  bool\n+\tTitle                string\n+\tBody                 string\n+\tBaseBranch           string\n+\tHeadBranch           string\n \n \tReviewers []string\n \tAssignees []string\n@@ -128,6 +129,7 @@ func NewCmdCreate(f *cmdutil.Factory, runF func(*CreateOptions) error) *cobra.Co\n \n \tfl := cmd.Flags()\n \tfl.BoolVarP(&opts.IsDraft, \"draft\", \"d\", false, \"Mark pull request as a draft\")\n+\tfl.BoolVar(&opts.MaintainerCanModify, \"maintainer-edit\", true, \"Allow edits and access to secrets by maintainers\")\n \tfl.StringVarP(&opts.Title, \"title\", \"t\", \"\", \"Title for the pull request\")\n \tfl.StringVarP(&opts.Body, \"body\", \"b\", \"\", \"Body for the pull request\")\n \tfl.StringVarP(&opts.BaseBranch, \"base\", \"B\", \"\", \"The `branch` into which you want your code merged\")\n@@ -561,11 +563,12 @@ func submitPR(opts CreateOptions, ctx CreateContext, state shared.IssueMetadataS\n \tclient := ctx.Client\n \n \tparams := map[string]interface{}{\n-\t\t\"title\":       state.Title,\n-\t\t\"body\":        state.Body,\n-\t\t\"draft\":       state.Draft,\n-\t\t\"baseRefName\": ctx.BaseBranch,\n-\t\t\"headRefName\": ctx.HeadBranchLabel,\n+\t\t\"title\":                state.Title,\n+\t\t\"body\":                 state.Body,\n+\t\t\"draft\":                state.Draft,\n+\t\t\"baseRefName\":          ctx.BaseBranch,\n+\t\t\"headRefName\":          ctx.HeadBranchLabel,\n+\t\t\"maintainerCanModify\":  opts.MaintainerCanModify,\n \t}\n \n \tif params[\"title\"] == \"\" {\n",
        "diff --git a/api/queries_pr.go b/api/queries_pr.go\nindex 46fc1dd..fab8862 100644\n--- a/api/queries_pr.go\n+++ b/api/queries_pr.go\n@@ -821,7 +821,7 @@ func CreatePullRequest(client *Client, repo *Repository, params map[string]inter\n \t}\n \tfor key, val := range params {\n \t\tswitch key {\n-\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\":\n+\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\", \"maintainerCanModify\":\n \t\t\tinputParams[key] = val\n \t\t}\n \t}\ndiff --git a/pkg/cmd/pr/create/create.go b/pkg/cmd/pr/create/create.go\nindex acb8d76..b6c469e 100644\n--- a/pkg/cmd/pr/create/create.go\n+++ b/pkg/cmd/pr/create/create.go\n@@ -53,6 +53,8 @@ type CreateOptions struct {\n \tLabels    []string\n \tProjects  []string\n \tMilestone string\n+\n+\tDisallowMaintainerEdits bool\n }\n \n type CreateContext struct {\n@@ -139,6 +141,7 @@ func NewCmdCreate(f *cmdutil.Factory, runF func(*CreateOptions) error) *cobra.Co\n \tfl.StringSliceVarP(&opts.Labels, \"label\", \"l\", nil, \"Add labels by `name`\")\n \tfl.StringSliceVarP(&opts.Projects, \"project\", \"p\", nil, \"Add the pull request to projects by `name`\")\n \tfl.StringVarP(&opts.Milestone, \"milestone\", \"m\", \"\", \"Add the pull request to a milestone by `name`\")\n+\tfl.BoolVar(&opts.DisallowMaintainerEdits, \"no-maintainer-edits\", false, \"Disallow edits and access to secrets by maintainers\")\n \tfl.StringVar(&opts.RecoverFile, \"recover\", \"\", \"Recover input from a failed run of create\")\n \n \treturn cmd\n@@ -568,6 +571,10 @@ func submitPR(opts CreateOptions, ctx CreateContext, state shared.IssueMetadataS\n \t\t\"headRefName\": ctx.HeadBranchLabel,\n \t}\n \n+\tif opts.DisallowMaintainerEdits {\n+\t\tparams[\"maintainerCanModify\"] = false\n+\t}\n+\n \tif params[\"title\"] == \"\" {\n \t\treturn errors.New(\"pull request title must not be blank\")\n \t}\n"
      ],
      "edit_loc_traj": {
        "prompt": "\nPlease review the following GitHub problem description and relevant files, and provide a set of locations that need to be edited to fix the issue.\nThe locations can be specified as class names, function or method names, or exact line numbers that require modification.\n\n### GitHub Problem Description ###\nOption to disallow edits from maintainers\n### Describe the feature or problem you’d like to solve\r\n\r\nI would like to disallow edits by maintainers when creating a PR from the command line. Currently, I have to open the PR in the browser and untick the checkbox (\"Allow edits and access to secrets by maintainers\"). Correct me if I'm wrong, but I could not find an option in [the manual](https://cli.github.com/manual/) or an existing issue.\r\n\r\n### Proposed solution\r\n\r\nAdd a flag and a config option to untick this checkbox / disallow edits from the terminal, so that users do not have to open the browser.\r\n\r\n### Additional context\r\n\r\nHub had an issue for this too. At first, the API did not support this, but later a PR got merged (see end of thread): https://github.com/github/hub/issues/1349\n\n###\n### pkg/cmd/pr/create/create.go\n...\n16|\t\"github.com/cli/cli/git\"\n17|\t\"github.com/cli/cli/internal/config\"\n18|\t\"github.com/cli/cli/internal/ghrepo\"\n19|\t\"github.com/cli/cli/pkg/cmd/pr/shared\"\n20|\t\"github.com/cli/cli/pkg/cmdutil\"\n21|\t\"github.com/cli/cli/pkg/iostreams\"\n22|\t\"github.com/cli/cli/pkg/prompt\"\n23|\t\"github.com/cli/cli/utils\"\n24|\t\"github.com/spf13/cobra\"\n25|)\n26|\n27|type CreateOptions struct {\n28|\t// This struct stores user input and factory functions\n29|\tHttpClient func() (*http.Client, error)\n30|\tConfig     func() (config.Config, error)\n31|\tIO         *iostreams.IOStreams\n32|\tRemotes    func() (context.Remotes, error)\n33|\tBranch     func() (string, error)\n34|\n35|\tTitleProvided bool\n36|\tBodyProvided  bool\n37|\n38|\tRootDirOverride string\n39|\tRepoOverride    string\n40|\n41|\tAutofill    bool\n42|\tWebMode     bool\n43|\tRecoverFile string\n44|\n45|\tIsDraft    bool\n46|\tTitle      string\n47|\tBody       string\n48|\tBaseBranch string\n49|\tHeadBranch string\n50|\n51|\tReviewers []string\n52|\tAssignees []string\n53|\tLabels    []string\n54|\tProjects  []string\n55|\tMilestone string\n56|}\n57|\n58|type CreateContext struct {\n59|\t// This struct stores contextual data about the creation process and is for building up enough\n60|\t// data to create a pull request\n61|\tRepoContext        *context.ResolvedRemotes\n62|\tBaseRepo           ghrepo.Interface\n63|\tHeadRepo           ghrepo.Interface\n64|\tBaseTrackingBranch string\n65|\tBaseBranch         string\n66|\tHeadBranch         string\n67|\tHeadBranchLabel    string\n68|\tHeadRemote         *context.Remote\n69|\tIsPushEnabled      bool\n70|\tClient             *api.Client\n71|}\n72|\n73|func NewCmdCreate(f *cmdutil.Factory, runF func(*CreateOptions) error) *cobra.Command {\n74|\topts := &CreateOptions{\n75|\t\tIO:         f.IOStreams,\n76|\t\tHttpClient: f.HttpClient,\n77|\t\tConfig:     f.Config,\n78|\t\tRemotes:    f.Remotes,\n79|\t\tBranch:     f.Branch,\n80|\t}\n81|\n82|\tcmd := &cobra.Command{\n83|\t\tUse:   \"create\",\n84|\t\tShort: \"Create a pull request\",\n85|\t\tLong: heredoc.Doc(`\n86|\t\t\tCreate a pull request on GitHub.\n87|\n88|\t\t\tWhen the current branch isn't fully pushed to a git remote, a prompt will ask where\n89|\t\t\tto push the branch and offer an option to fork the base repository. Use '--head' to\n90|\t\t\texplicitly skip any forking or pushing behavior.\n91|\n92|\t\t\tA prompt will also ask for the title and the body of the pull request. Use '--title'\n93|\t\t\tand '--body' to skip this, or use '--fill' to autofill these values from git commits.\n94|\t\t`),\n95|\t\tExample: heredoc.Doc(`\n96|\t\t\t$ gh pr create --title \"The bug is fixed\" --body \"Everything works again\"\n97|\t\t\t$ gh pr create --reviewer monalisa,hubot  --reviewer myorg/team-name\n98|\t\t\t$ gh pr create --project \"Roadmap\"\n99|\t\t\t$ gh pr create --base develop --head monalisa:feature\n100|\t\t`),\n101|\t\tArgs: cmdutil.NoArgsQuoteReminder,\n102|\t\tRunE: func(cmd *cobra.Command, args []string) error {\n103|\t\t\topts.TitleProvided = cmd.Flags().Changed(\"title\")\n104|\t\t\topts.BodyProvided = cmd.Flags().Changed(\"body\")\n105|\t\t\topts.RepoOverride, _ = cmd.Flags().GetString(\"repo\")\n106|\n107|\t\t\tif !opts.IO.CanPrompt() && opts.RecoverFile != \"\" {\n108|\t\t\t\treturn &cmdutil.FlagError{Err: errors.New(\"--recover only supported when running interactively\")}\n109|\t\t\t}\n110|\n111|\t\t\tif !opts.IO.CanPrompt() && !opts.WebMode && !opts.TitleProvided && !opts.Autofill {\n112|\t\t\t\treturn &cmdutil.FlagError{Err: errors.New(\"--title or --fill required when not running interactively\")}\n113|\t\t\t}\n114|\n115|\t\t\tif opts.IsDraft && opts.WebMode {\n116|\t\t\t\treturn errors.New(\"the --draft flag is not supported with --web\")\n117|\t\t\t}\n118|\t\t\tif len(opts.Reviewers) > 0 && opts.WebMode {\n119|\t\t\t\treturn errors.New(\"the --reviewer flag is not supported with --web\")\n120|\t\t\t}\n121|\n122|\t\t\tif runF != nil {\n123|\t\t\t\treturn runF(opts)\n124|\t\t\t}\n125|\t\t\treturn createRun(opts)\n126|\t\t},\n127|\t}\n128|\n129|\tfl := cmd.Flags()\n130|\tfl.BoolVarP(&opts.IsDraft, \"draft\", \"d\", false, \"Mark pull request as a draft\")\n131|\tfl.StringVarP(&opts.Title, \"title\", \"t\", \"\", \"Title for the pull request\")\n132|\tfl.StringVarP(&opts.Body, \"body\", \"b\", \"\", \"Body for the pull request\")\n133|\tfl.StringVarP(&opts.BaseBranch, \"base\", \"B\", \"\", \"The `branch` into which you want your code merged\")\n134|\tfl.StringVarP(&opts.HeadBranch, \"head\", \"H\", \"\", \"The `branch` that contains commits for your pull request (default: current branch)\")\n135|\tfl.BoolVarP(&opts.WebMode, \"web\", \"w\", false, \"Open the web browser to create a pull request\")\n136|\tfl.BoolVarP(&opts.Autofill, \"fill\", \"f\", false, \"Do not prompt for title/body and just use commit info\")\n137|\tfl.StringSliceVarP(&opts.Reviewers, \"reviewer\", \"r\", nil, \"Request reviews from people or teams by their `handle`\")\n138|\tfl.StringSliceVarP(&opts.Assignees, \"assignee\", \"a\", nil, \"Assign people by their `login`\")\n139|\tfl.StringSliceVarP(&opts.Labels, \"label\", \"l\", nil, \"Add labels by `name`\")\n140|\tfl.StringSliceVarP(&opts.Projects, \"project\", \"p\", nil, \"Add the pull request to projects by `name`\")\n141|\tfl.StringVarP(&opts.Milestone, \"milestone\", \"m\", \"\", \"Add the pull request to a milestone by `name`\")\n142|\tfl.StringVar(&opts.RecoverFile, \"recover\", \"\", \"Recover input from a failed run of create\")\n143|\n144|\treturn cmd\n145|}\n146|\n147|func createRun(opts *CreateOptions) (err error) {\n148|\tctx, err := NewCreateContext(opts)\n149|\tif err != nil {\n150|\t\treturn\n151|\t}\n152|\n153|\tclient := ctx.Client\n154|\n...\n549|\t\tBaseTrackingBranch: baseTrackingBranch,\n550|\t\tHeadBranch:         headBranch,\n551|\t\tHeadBranchLabel:    headBranchLabel,\n552|\t\tHeadRemote:         headRemote,\n553|\t\tIsPushEnabled:      isPushEnabled,\n554|\t\tRepoContext:        repoContext,\n555|\t\tClient:             client,\n556|\t}, nil\n557|\n558|}\n559|\n560|func submitPR(opts CreateOptions, ctx CreateContext, state shared.IssueMetadataState) error {\n561|\tclient := ctx.Client\n562|\n563|\tparams := map[string]interface{}{\n564|\t\t\"title\":       state.Title,\n565|\t\t\"body\":        state.Body,\n566|\t\t\"draft\":       state.Draft,\n567|\t\t\"baseRefName\": ctx.BaseBranch,\n568|\t\t\"headRefName\": ctx.HeadBranchLabel,\n569|\t}\n570|\n571|\tif params[\"title\"] == \"\" {\n572|\t\treturn errors.New(\"pull request title must not be blank\")\n573|\t}\n574|\n575|\terr := shared.AddMetadataToIssueParams(client, ctx.BaseRepo, params, &state)\n576|\tif err != nil {\n577|\t\treturn err\n578|\t}\n579|\n580|\tpr, err := api.CreatePullRequest(client, ctx.BaseRepo.(*api.Repository), params)\n581|\tif pr != nil {\n582|\t\tfmt.Fprintln(opts.IO.Out, pr.URL)\n583|\t}\n584|\tif err != nil {\n585|\t\tif pr != nil {\n586|\t\t\treturn fmt.Errorf(\"pull request update failed: %w\", err)\n587|\t\t}\n588|\t\treturn fmt.Errorf(\"pull request create failed: %w\", err)\n589|\t}\n590|\treturn nil\n591|}\n592|\n593|func previewPR(opts CreateOptions, ctx CreateContext, state shared.IssueMetadataState) error {\n594|\topenURL, err := generateCompareURL(ctx, state)\n595|\tif err != nil {\n596|\t\treturn err\n597|\t}\n598|\n599|\tif opts.IO.IsStdinTTY() && opts.IO.IsStdoutTTY() {\n600|\t\tfmt.Fprintf(opts.IO.ErrOut, \"Opening %s in your browser.\\n\", utils.DisplayURL(openURL))\n...\n678|\t\t}\n679|\n680|\t\terr := pushBranch()\n681|\t\tif err != nil {\n682|\t\t\treturn err\n683|\t\t}\n684|\t}\n685|\n686|\treturn nil\n687|}\n688|\n689|func generateCompareURL(ctx CreateContext, state shared.IssueMetadataState) (string, error) {\n690|\tu := ghrepo.GenerateRepoURL(\n691|\t\tctx.BaseRepo,\n692|\t\t\"compare/%s...%s?expand=1\",\n693|\t\turl.QueryEscape(ctx.BaseBranch), url.QueryEscape(ctx.HeadBranchLabel))\n694|\turl, err := shared.WithPrAndIssueQueryParams(u, state)\n695|\tif err != nil {\n696|\t\treturn \"\", err\n697|\t}\n698|\treturn url, nil\n699|}\n700|\n701|var gitPushRegexp = regexp.MustCompile(\"^remote: (Create a pull request.*by visiting|[[:space:]]*https://.*/pull/new/).*\\n?$\")\n\n\n### api/queries_pr.go\n...\n32|\tViewerCreated   PullRequestAndTotalCount\n33|\tReviewRequested PullRequestAndTotalCount\n34|\tCurrentPR       *PullRequest\n35|\tDefaultBranch   string\n36|}\n37|\n38|type PullRequestAndTotalCount struct {\n39|\tTotalCount   int\n40|\tPullRequests []PullRequest\n41|}\n42|\n43|type PullRequest struct {\n44|\tID          string\n45|\tNumber      int\n46|\tTitle       string\n47|\tState       string\n48|\tClosed      bool\n49|\tURL         string\n50|\tBaseRefName string\n51|\tHeadRefName string\n52|\tBody        string\n53|\tMergeable   string\n54|\n55|\tAuthor struct {\n56|\t\tLogin string\n57|\t}\n58|\tHeadRepositoryOwner struct {\n59|\t\tLogin string\n60|\t}\n61|\tHeadRepository struct {\n62|\t\tName             string\n63|\t\tDefaultBranchRef struct {\n64|\t\t\tName string\n65|\t\t}\n66|\t}\n67|\tIsCrossRepository   bool\n68|\tIsDraft             bool\n69|\tMaintainerCanModify bool\n70|\n71|\tReviewDecision string\n72|\n73|\tCommits struct {\n74|\t\tTotalCount int\n75|\t\tNodes      []struct {\n76|\t\t\tCommit struct {\n77|\t\t\t\tOid               string\n78|\t\t\t\tStatusCheckRollup struct {\n79|\t\t\t\t\tContexts struct {\n80|\t\t\t\t\t\tNodes []struct {\n81|\t\t\t\t\t\t\tName        string\n82|\t\t\t\t\t\t\tContext     string\n83|\t\t\t\t\t\t\tState       string\n84|\t\t\t\t\t\t\tStatus      string\n85|\t\t\t\t\t\t\tConclusion  string\n86|\t\t\t\t\t\t\tStartedAt   time.Time\n87|\t\t\t\t\t\t\tCompletedAt time.Time\n88|\t\t\t\t\t\t\tDetailsURL  string\n89|\t\t\t\t\t\t\tTargetURL   string\n90|\t\t\t\t\t\t}\n91|\t\t\t\t\t}\n92|\t\t\t\t}\n93|\t\t\t}\n94|\t\t}\n95|\t}\n96|\tReviewRequests struct {\n97|\t\tNodes []struct {\n98|\t\t\tRequestedReviewer struct {\n99|\t\t\t\tTypeName string `json:\"__typename\"`\n100|\t\t\t\tLogin    string\n101|\t\t\t\tName     string\n102|\t\t\t}\n103|\t\t}\n104|\t\tTotalCount int\n105|\t}\n106|\tReviews struct {\n107|\t\tNodes []struct {\n108|\t\t\tAuthor struct {\n109|\t\t\t\tLogin string\n110|\t\t\t}\n111|\t\t\tState string\n112|\t\t}\n113|\t}\n114|\tAssignees struct {\n115|\t\tNodes []struct {\n116|\t\t\tLogin string\n117|\t\t}\n118|\t\tTotalCount int\n119|\t}\n120|\tLabels struct {\n121|\t\tNodes []struct {\n122|\t\t\tName string\n123|\t\t}\n124|\t\tTotalCount int\n125|\t}\n126|\tProjectCards struct {\n127|\t\tNodes []struct {\n128|\t\t\tProject struct {\n129|\t\t\t\tName string\n130|\t\t\t}\n131|\t\t\tColumn struct {\n132|\t\t\t\tName string\n133|\t\t\t}\n134|\t\t}\n135|\t\tTotalCount int\n136|\t}\n137|\tMilestone struct {\n138|\t\tTitle string\n139|\t}\n140|\tComments       Comments\n141|\tReactionGroups ReactionGroups\n142|}\n143|\n144|type NotFoundError struct {\n145|\terror\n146|}\n147|\n148|func (err *NotFoundError) Unwrap() error {\n149|\treturn err.error\n150|}\n151|\n...\n509|\t\t\t\t\t\t\t\tdetailsUrl\n510|\t\t\t\t\t\t\t}\n511|\t\t\t\t\t\t}\n512|\t\t\t\t\t}\n513|\t\t\t\t}\n514|\t\t\t}\n515|\t\t}\n516|\t}\n517|\t`, nil\n518|}\n519|\n520|func PullRequestByNumber(client *Client, repo ghrepo.Interface, number int) (*PullRequest, error) {\n521|\ttype response struct {\n522|\t\tRepository struct {\n523|\t\t\tPullRequest PullRequest\n524|\t\t}\n525|\t}\n526|\n527|\tstatusesFragment, err := prCommitsFragment(client.http, repo.RepoHost())\n528|\tif err != nil {\n529|\t\treturn nil, err\n530|\t}\n531|\n532|\tquery := `\n533|\tquery PullRequestByNumber($owner: String!, $repo: String!, $pr_number: Int!) {\n534|\t\trepository(owner: $owner, name: $repo) {\n535|\t\t\tpullRequest(number: $pr_number) {\n536|\t\t\t\tid\n537|\t\t\t\turl\n538|\t\t\t\tnumber\n539|\t\t\t\ttitle\n540|\t\t\t\tstate\n541|\t\t\t\tclosed\n542|\t\t\t\tbody\n543|\t\t\t\tmergeable\n544|\t\t\t\tauthor {\n545|\t\t\t\t  login\n546|\t\t\t\t}\n547|\t\t\t\t` + statusesFragment + `\n548|\t\t\t\tbaseRefName\n549|\t\t\t\theadRefName\n550|\t\t\t\theadRepositoryOwner {\n551|\t\t\t\t\tlogin\n552|\t\t\t\t}\n553|\t\t\t\theadRepository {\n554|\t\t\t\t\tname\n555|\t\t\t\t}\n556|\t\t\t\tisCrossRepository\n557|\t\t\t\tisDraft\n558|\t\t\t\tmaintainerCanModify\n559|\t\t\t\treviewRequests(first: 100) {\n560|\t\t\t\t\tnodes {\n561|\t\t\t\t\t\trequestedReviewer {\n562|\t\t\t\t\t\t\t__typename\n563|\t\t\t\t\t\t\t...on User {\n564|\t\t\t\t\t\t\t\tlogin\n565|\t\t\t\t\t\t\t}\n566|\t\t\t\t\t\t\t...on Team {\n567|\t\t\t\t\t\t\t\tname\n568|\t\t\t\t\t\t\t}\n569|\t\t\t\t\t\t}\n570|\t\t\t\t\t}\n571|\t\t\t\t\ttotalCount\n572|\t\t\t\t}\n573|\t\t\t\treviews(last: 100) {\n574|\t\t\t\t\tnodes {\n575|\t\t\t\t\t\tauthor {\n576|\t\t\t\t\t\t  login\n577|\t\t\t\t\t\t}\n578|\t\t\t\t\t\tstate\n579|\t\t\t\t\t}\n580|\t\t\t\t\ttotalCount\n581|\t\t\t\t}\n582|\t\t\t\tassignees(first: 100) {\n583|\t\t\t\t\tnodes {\n584|\t\t\t\t\t\tlogin\n585|\t\t\t\t\t}\n586|\t\t\t\t\ttotalCount\n587|\t\t\t\t}\n588|\t\t\t\tlabels(first: 100) {\n589|\t\t\t\t\tnodes {\n590|\t\t\t\t\t\tname\n591|\t\t\t\t\t}\n592|\t\t\t\t\ttotalCount\n593|\t\t\t\t}\n594|\t\t\t\tprojectCards(first: 100) {\n595|\t\t\t\t\tnodes {\n596|\t\t\t\t\t\tproject {\n597|\t\t\t\t\t\t\tname\n598|\t\t\t\t\t\t}\n599|\t\t\t\t\t\tcolumn {\n600|\t\t\t\t\t\t\tname\n601|\t\t\t\t\t\t}\n602|\t\t\t\t\t}\n603|\t\t\t\t\ttotalCount\n604|\t\t\t\t}\n605|\t\t\t\tmilestone{\n606|\t\t\t\t\ttitle\n607|\t\t\t\t}\n608|\t\t\t\tcomments(last: 1) {\n609|\t\t\t\t\tnodes {\n610|\t\t\t\t\t\tauthor {\n611|\t\t\t\t\t\t\tlogin\n612|\t\t\t\t\t\t}\n613|\t\t\t\t\t\tauthorAssociation\n614|\t\t\t\t\t\tbody\n615|\t\t\t\t\t\tcreatedAt\n616|\t\t\t\t\t\tincludesCreatedEdit\n617|\t\t\t\t\t\treactionGroups {\n618|\t\t\t\t\t\t\tcontent\n619|\t\t\t\t\t\t\tusers {\n620|\t\t\t\t\t\t\t\ttotalCount\n621|\t\t\t\t\t\t\t}\n622|\t\t\t\t\t\t}\n623|\t\t\t\t\t}\n624|\t\t\t\t\ttotalCount\n625|\t\t\t\t}\n626|\t\t\t\treactionGroups {\n627|\t\t\t\t\tcontent\n628|\t\t\t\t\tusers {\n629|\t\t\t\t\t\ttotalCount\n630|\t\t\t\t\t}\n631|\t\t\t\t}\n632|\t\t\t}\n633|\t\t}\n634|\t}`\n635|\n636|\tvariables := map[string]interface{}{\n637|\t\t\"owner\":     repo.RepoOwner(),\n638|\t\t\"repo\":      repo.RepoName(),\n639|\t\t\"pr_number\": number,\n640|\t}\n641|\n642|\tvar resp response\n643|\terr = client.GraphQL(repo.RepoHost(), query, variables, &resp)\n644|\tif err != nil {\n645|\t\treturn nil, err\n646|\t}\n647|\n648|\treturn &resp.Repository.PullRequest, nil\n649|}\n650|\n651|func PullRequestForBranch(client *Client, repo ghrepo.Interface, baseBranch, headBranch string, stateFilters []string) (*PullRequest, error) {\n652|\ttype response struct {\n653|\t\tRepository struct {\n654|\t\t\tPullRequests struct {\n655|\t\t\t\tNodes []PullRequest\n656|\t\t\t}\n657|\t\t}\n658|\t}\n659|\n660|\tstatusesFragment, err := prCommitsFragment(client.http, repo.RepoHost())\n661|\tif err != nil {\n662|\t\treturn nil, err\n663|\t}\n664|\n665|\tquery := `\n666|\tquery PullRequestForBranch($owner: String!, $repo: String!, $headRefName: String!, $states: [PullRequestState!]) {\n667|\t\trepository(owner: $owner, name: $repo) {\n668|\t\t\tpullRequests(headRefName: $headRefName, states: $states, first: 30, orderBy: { field: CREATED_AT, direction: DESC }) {\n669|\t\t\t\tnodes {\n670|\t\t\t\t\tid\n671|\t\t\t\t\tnumber\n672|\t\t\t\t\ttitle\n673|\t\t\t\t\tstate\n674|\t\t\t\t\tbody\n675|\t\t\t\t\tmergeable\n676|\t\t\t\t\tauthor {\n677|\t\t\t\t\t\tlogin\n678|\t\t\t\t\t}\n679|\t\t\t\t\t` + statusesFragment + `\n680|\t\t\t\t\turl\n681|\t\t\t\t\tbaseRefName\n682|\t\t\t\t\theadRefName\n683|\t\t\t\t\theadRepositoryOwner {\n684|\t\t\t\t\t\tlogin\n685|\t\t\t\t\t}\n686|\t\t\t\t\theadRepository {\n687|\t\t\t\t\t\tname\n688|\t\t\t\t\t}\n689|\t\t\t\t\tisCrossRepository\n690|\t\t\t\t\tisDraft\n691|\t\t\t\t\tmaintainerCanModify\n692|\t\t\t\t\treviewRequests(first: 100) {\n693|\t\t\t\t\t\tnodes {\n694|\t\t\t\t\t\t\trequestedReviewer {\n695|\t\t\t\t\t\t\t\t__typename\n696|\t\t\t\t\t\t\t\t...on User {\n697|\t\t\t\t\t\t\t\t\tlogin\n698|\t\t\t\t\t\t\t\t}\n699|\t\t\t\t\t\t\t\t...on Team {\n700|\t\t\t\t\t\t\t\t\tname\n701|\t\t\t\t\t\t\t\t}\n702|\t\t\t\t\t\t\t}\n703|\t\t\t\t\t\t}\n704|\t\t\t\t\t\ttotalCount\n705|\t\t\t\t\t}\n706|\t\t\t\t\treviews(last: 100) {\n707|\t\t\t\t\t\tnodes {\n708|\t\t\t\t\t\t\tauthor {\n709|\t\t\t\t\t\t\t  login\n710|\t\t\t\t\t\t\t}\n711|\t\t\t\t\t\t\tstate\n712|\t\t\t\t\t\t}\n713|\t\t\t\t\t\ttotalCount\n714|\t\t\t\t\t}\n715|\t\t\t\t\tassignees(first: 100) {\n716|\t\t\t\t\t\tnodes {\n717|\t\t\t\t\t\t\tlogin\n718|\t\t\t\t\t\t}\n719|\t\t\t\t\t\ttotalCount\n720|\t\t\t\t\t}\n721|\t\t\t\t\tlabels(first: 100) {\n722|\t\t\t\t\t\tnodes {\n723|\t\t\t\t\t\t\tname\n724|\t\t\t\t\t\t}\n725|\t\t\t\t\t\ttotalCount\n726|\t\t\t\t\t}\n727|\t\t\t\t\tprojectCards(first: 100) {\n728|\t\t\t\t\t\tnodes {\n729|\t\t\t\t\t\t\tproject {\n730|\t\t\t\t\t\t\t\tname\n731|\t\t\t\t\t\t\t}\n732|\t\t\t\t\t\t\tcolumn {\n733|\t\t\t\t\t\t\t\tname\n734|\t\t\t\t\t\t\t}\n735|\t\t\t\t\t\t}\n736|\t\t\t\t\t\ttotalCount\n737|\t\t\t\t\t}\n738|\t\t\t\t\tmilestone{\n739|\t\t\t\t\t\ttitle\n740|\t\t\t\t\t}\n741|\t\t\t\t\tcomments(last: 1) {\n742|\t\t\t\t\t\tnodes {\n743|\t\t\t\t\t\t\tauthor {\n744|\t\t\t\t\t\t\t\tlogin\n745|\t\t\t\t\t\t\t}\n746|\t\t\t\t\t\t\tauthorAssociation\n747|\t\t\t\t\t\t\tbody\n748|\t\t\t\t\t\t\tcreatedAt\n749|\t\t\t\t\t\t\tincludesCreatedEdit\n750|\t\t\t\t\t\t\treactionGroups {\n751|\t\t\t\t\t\t\t\tcontent\n752|\t\t\t\t\t\t\t\tusers {\n753|\t\t\t\t\t\t\t\t\ttotalCount\n754|\t\t\t\t\t\t\t\t}\n755|\t\t\t\t\t\t\t}\n756|\t\t\t\t\t\t}\n757|\t\t\t\t\t\ttotalCount\n758|\t\t\t\t\t}\n759|\t\t\t\t\treactionGroups {\n760|\t\t\t\t\t\tcontent\n761|\t\t\t\t\t\tusers {\n762|\t\t\t\t\t\t\ttotalCount\n763|\t\t\t\t\t\t}\n764|\t\t\t\t\t}\n765|\t\t\t\t}\n766|\t\t\t}\n767|\t\t}\n768|\t}`\n769|\n770|\tbranchWithoutOwner := headBranch\n771|\tif idx := strings.Index(headBranch, \":\"); idx >= 0 {\n772|\t\tbranchWithoutOwner = headBranch[idx+1:]\n773|\t}\n774|\n775|\tvariables := map[string]interface{}{\n776|\t\t\"owner\":       repo.RepoOwner(),\n777|\t\t\"repo\":        repo.RepoName(),\n778|\t\t\"headRefName\": branchWithoutOwner,\n779|\t\t\"states\":      stateFilters,\n780|\t}\n781|\n782|\tvar resp response\n783|\terr = client.GraphQL(repo.RepoHost(), query, variables, &resp)\n784|\tif err != nil {\n785|\t\treturn nil, err\n786|\t}\n787|\n788|\tprs := resp.Repository.PullRequests.Nodes\n789|\tsortPullRequestsByState(prs)\n790|\n791|\tfor _, pr := range prs {\n792|\t\tif pr.HeadLabel() == headBranch && (baseBranch == \"\" || pr.BaseRefName == baseBranch) {\n793|\t\t\treturn &pr, nil\n794|\t\t}\n795|\t}\n796|\n797|\treturn nil, &NotFoundError{fmt.Errorf(\"no pull requests found for branch %q\", headBranch)}\n798|}\n799|\n800|// sortPullRequestsByState sorts a PullRequest slice by open-first\n801|func sortPullRequestsByState(prs []PullRequest) {\n802|\tsort.SliceStable(prs, func(a, b int) bool {\n803|\t\treturn prs[a].State == \"OPEN\"\n804|\t})\n805|}\n806|\n807|// CreatePullRequest creates a pull request in a GitHub repository\n808|func CreatePullRequest(client *Client, repo *Repository, params map[string]interface{}) (*PullRequest, error) {\n809|\tquery := `\n810|\t\tmutation PullRequestCreate($input: CreatePullRequestInput!) {\n811|\t\t\tcreatePullRequest(input: $input) {\n812|\t\t\t\tpullRequest {\n813|\t\t\t\t\tid\n814|\t\t\t\t\turl\n815|\t\t\t\t}\n816|\t\t\t}\n817|\t}`\n818|\n819|\tinputParams := map[string]interface{}{\n820|\t\t\"repositoryId\": repo.ID,\n821|\t}\n822|\tfor key, val := range params {\n823|\t\tswitch key {\n824|\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\":\n825|\t\t\tinputParams[key] = val\n826|\t\t}\n827|\t}\n828|\tvariables := map[string]interface{}{\n829|\t\t\"input\": inputParams,\n830|\t}\n831|\n832|\tresult := struct {\n833|\t\tCreatePullRequest struct {\n834|\t\t\tPullRequest PullRequest\n835|\t\t}\n836|\t}{}\n837|\n838|\terr := client.GraphQL(repo.RepoHost(), query, variables, &result)\n839|\tif err != nil {\n840|\t\treturn nil, err\n841|\t}\n842|\tpr := &result.CreatePullRequest.PullRequest\n843|\n844|\t// metadata parameters aren't currently available in `createPullRequest`,\n845|\t// but they are in `updatePullRequest`\n846|\tupdateParams := make(map[string]interface{})\n847|\tfor key, val := range params {\n848|\t\tswitch key {\n849|\t\tcase \"assigneeIds\", \"labelIds\", \"projectIds\", \"milestoneId\":\n850|\t\t\tif !isBlank(val) {\n851|\t\t\t\tupdateParams[key] = val\n852|\t\t\t}\n853|\t\t}\n854|\t}\n855|\tif len(updateParams) > 0 {\n856|\t\tupdateQuery := `\n857|\t\tmutation PullRequestCreateMetadata($input: UpdatePullRequestInput!) {\n858|\t\t\tupdatePullRequest(input: $input) { clientMutationId }\n859|\t\t}`\n860|\t\tupdateParams[\"pullRequestId\"] = pr.ID\n861|\t\tvariables := map[string]interface{}{\n862|\t\t\t\"input\": updateParams,\n863|\t\t}\n864|\t\terr := client.GraphQL(repo.RepoHost(), updateQuery, variables, &result)\n865|\t\tif err != nil {\n866|\t\t\treturn pr, err\n867|\t\t}\n868|\t}\n869|\n870|\t// reviewers are requested in yet another additional mutation\n871|\treviewParams := make(map[string]interface{})\n872|\tif ids, ok := params[\"userReviewerIds\"]; ok && !isBlank(ids) {\n873|\t\treviewParams[\"userIds\"] = ids\n874|\t}\n875|\tif ids, ok := params[\"teamReviewerIds\"]; ok && !isBlank(ids) {\n876|\t\treviewParams[\"teamIds\"] = ids\n877|\t}\n878|\n879|\tif len(reviewParams) > 0 {\n880|\t\treviewQuery := `\n881|\t\tmutation PullRequestCreateRequestReviews($input: RequestReviewsInput!) {\n882|\t\t\trequestReviews(input: $input) { clientMutationId }\n883|\t\t}`\n884|\t\treviewParams[\"pullRequestId\"] = pr.ID\n885|\t\treviewParams[\"union\"] = true\n886|\t\tvariables := map[string]interface{}{\n887|\t\t\t\"input\": reviewParams,\n888|\t\t}\n889|\t\terr := client.GraphQL(repo.RepoHost(), reviewQuery, variables, &result)\n890|\t\tif err != nil {\n891|\t\t\treturn pr, err\n892|\t\t}\n893|\t}\n894|\n895|\treturn pr, nil\n896|}\n897|\n898|func isBlank(v interface{}) bool {\n899|\tswitch vv := v.(type) {\n900|\tcase string:\n901|\t\treturn vv == \"\"\n902|\tcase []string:\n903|\t\treturn len(vv) == 0\n904|\tdefault:\n905|\t\treturn true\n...\n\n\n### pkg/cmd/pr/shared/params.go\n...\n1|package shared\n2|\n3|import (\n4|\t\"fmt\"\n5|\t\"net/url\"\n6|\t\"strings\"\n7|\n8|\t\"github.com/cli/cli/api\"\n9|\t\"github.com/cli/cli/internal/ghrepo\"\n10|)\n11|\n12|func WithPrAndIssueQueryParams(baseURL string, state IssueMetadataState) (string, error) {\n13|\tu, err := url.Parse(baseURL)\n14|\tif err != nil {\n15|\t\treturn \"\", err\n16|\t}\n17|\tq := u.Query()\n18|\tif state.Title != \"\" {\n19|\t\tq.Set(\"title\", state.Title)\n20|\t}\n21|\tif state.Body != \"\" {\n22|\t\tq.Set(\"body\", state.Body)\n23|\t}\n24|\tif len(state.Assignees) > 0 {\n25|\t\tq.Set(\"assignees\", strings.Join(state.Assignees, \",\"))\n26|\t}\n27|\tif len(state.Labels) > 0 {\n28|\t\tq.Set(\"labels\", strings.Join(state.Labels, \",\"))\n29|\t}\n30|\tif len(state.Projects) > 0 {\n31|\t\tq.Set(\"projects\", strings.Join(state.Projects, \",\"))\n32|\t}\n33|\tif len(state.Milestones) > 0 {\n34|\t\tq.Set(\"milestone\", state.Milestones[0])\n35|\t}\n36|\tu.RawQuery = q.Encode()\n37|\treturn u.String(), nil\n38|}\n39|\n40|// Ensure that tb.MetadataResult object exists and contains enough pre-fetched API data to be able\n41|// to resolve all object listed in tb to GraphQL IDs.\n42|func fillMetadata(client *api.Client, baseRepo ghrepo.Interface, tb *IssueMetadataState) error {\n43|\tresolveInput := api.RepoResolveInput{}\n44|\n45|\tif len(tb.Assignees) > 0 && (tb.MetadataResult == nil || len(tb.MetadataResult.AssignableUsers) == 0) {\n46|\t\tresolveInput.Assignees = tb.Assignees\n47|\t}\n...\n\n\n\n\n###\n\nPlease provide the class name, function or method name, or the exact line numbers that need to be edited.\nThe possible location outputs should be either \"class\", \"function\" or \"line\".\n\n### Examples:\n```\nfull_path1/file1.go\nline: 10\nclass: MyClass1\nline: 51\n\nfull_path2/file2.go\nfunction: MyClass2.my_method\nline: 12\n\nfull_path3/file3.go\nfunction: my_function\nline: 24\nline: 156\n```\n\nReturn just the location(s) wrapped with ```.\n",
        "response": [
          "```\npkg/cmd/pr/create/create.go\nline: 56\nfunction: NewCmdCreate\nfunction: submitPR\nfunction: createRun\n\napi/queries_pr.go\nfunction: CreatePullRequest\n```",
          "```\npkg/cmd/pr/create/create.go\nclass: CreateOptions\nfunction: NewCmdCreate\nfunction: submitPR\n\napi/queries_pr.go\nfunction: CreatePullRequest\n```"
        ],
        "usage": {
          "completion_tokens": 0,
          "prompt_tokens": 0
        }
      },
      "additional_artifact_loc_edit_location": [
        {
          "raw_output_loc": [
            "```\npkg/cmd/pr/create/create.go\nline: 56\nfunction: NewCmdCreate\nfunction: submitPR\nfunction: createRun\n\napi/queries_pr.go\nfunction: CreatePullRequest\n```",
            "```\npkg/cmd/pr/create/create.go\nclass: CreateOptions\nfunction: NewCmdCreate\nfunction: submitPR\n\napi/queries_pr.go\nfunction: CreatePullRequest\n```"
          ]
        }
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "pkg/cmd/pr/create/create.go": [
          "class: CreateOptions\nfunction: NewCmdCreate\nfunction: submitPR"
        ],
        "api/queries_pr.go": [
          "function: CreatePullRequest"
        ],
        "pkg/cmd/pr/shared/params.go": [
          ""
        ]
      },
      "patches": [
        "diff --git a/api/queries_pr.go b/api/queries_pr.go\nindex 46fc1dd..fab8862 100644\n--- a/api/queries_pr.go\n+++ b/api/queries_pr.go\n@@ -821,7 +821,7 @@ func CreatePullRequest(client *Client, repo *Repository, params map[string]inter\n \t}\n \tfor key, val := range params {\n \t\tswitch key {\n-\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\":\n+\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\", \"maintainerCanModify\":\n \t\t\tinputParams[key] = val\n \t\t}\n \t}\ndiff --git a/pkg/cmd/pr/create/create.go b/pkg/cmd/pr/create/create.go\nindex acb8d76..d655e4f 100644\n--- a/pkg/cmd/pr/create/create.go\n+++ b/pkg/cmd/pr/create/create.go\n@@ -47,6 +47,7 @@ type CreateOptions struct {\n \tBody       string\n \tBaseBranch string\n \tHeadBranch string\n+\tDisallowMaintainerEdits bool\n \n \tReviewers []string\n \tAssignees []string\n@@ -139,6 +140,7 @@ func NewCmdCreate(f *cmdutil.Factory, runF func(*CreateOptions) error) *cobra.Co\n \tfl.StringSliceVarP(&opts.Labels, \"label\", \"l\", nil, \"Add labels by `name`\")\n \tfl.StringSliceVarP(&opts.Projects, \"project\", \"p\", nil, \"Add the pull request to projects by `name`\")\n \tfl.StringVarP(&opts.Milestone, \"milestone\", \"m\", \"\", \"Add the pull request to a milestone by `name`\")\n+\tfl.BoolVar(&opts.DisallowMaintainerEdits, \"no-maintainer-edit\", false, \"Do not allow maintainers to modify this pull request\")\n \tfl.StringVar(&opts.RecoverFile, \"recover\", \"\", \"Recover input from a failed run of create\")\n \n \treturn cmd\n@@ -567,6 +569,9 @@ func submitPR(opts CreateOptions, ctx CreateContext, state shared.IssueMetadataS\n \t\t\"baseRefName\": ctx.BaseBranch,\n \t\t\"headRefName\": ctx.HeadBranchLabel,\n \t}\n+\tif opts.DisallowMaintainerEdits {\n+\t\tparams[\"maintainerCanModify\"] = false\n+\t}\n \n \tif params[\"title\"] == \"\" {\n \t\treturn errors.New(\"pull request title must not be blank\")\n",
        "diff --git a/api/queries_pr.go b/api/queries_pr.go\nindex 46fc1dd..fab8862 100644\n--- a/api/queries_pr.go\n+++ b/api/queries_pr.go\n@@ -821,7 +821,7 @@ func CreatePullRequest(client *Client, repo *Repository, params map[string]inter\n \t}\n \tfor key, val := range params {\n \t\tswitch key {\n-\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\":\n+\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\", \"maintainerCanModify\":\n \t\t\tinputParams[key] = val\n \t\t}\n \t}\ndiff --git a/pkg/cmd/pr/create/create.go b/pkg/cmd/pr/create/create.go\nindex acb8d76..5f27d8a 100644\n--- a/pkg/cmd/pr/create/create.go\n+++ b/pkg/cmd/pr/create/create.go\n@@ -53,6 +53,9 @@ type CreateOptions struct {\n \tLabels    []string\n \tProjects  []string\n \tMilestone string\n+\n+\t// When set, disallow edits and access to secrets by maintainers on fork-originated PRs\n+\tNoMaintainerEdits bool\n }\n \n type CreateContext struct {\n@@ -140,6 +143,7 @@ func NewCmdCreate(f *cmdutil.Factory, runF func(*CreateOptions) error) *cobra.Co\n \tfl.StringSliceVarP(&opts.Projects, \"project\", \"p\", nil, \"Add the pull request to projects by `name`\")\n \tfl.StringVarP(&opts.Milestone, \"milestone\", \"m\", \"\", \"Add the pull request to a milestone by `name`\")\n \tfl.StringVar(&opts.RecoverFile, \"recover\", \"\", \"Recover input from a failed run of create\")\n+\tfl.BoolVar(&opts.NoMaintainerEdits, \"no-maintainer-edit\", false, \"Do not allow edits and access to secrets by maintainers\")\n \n \treturn cmd\n }\n@@ -567,6 +571,10 @@ func submitPR(opts CreateOptions, ctx CreateContext, state shared.IssueMetadataS\n \t\t\"baseRefName\": ctx.BaseBranch,\n \t\t\"headRefName\": ctx.HeadBranchLabel,\n \t}\n+\t// Only set when explicitly requested; default server behavior allows maintainer edits\n+\tif opts.NoMaintainerEdits {\n+\t\tparams[\"maintainerCanModify\"] = false\n+\t}\n \n \tif params[\"title\"] == \"\" {\n \t\treturn errors.New(\"pull request title must not be blank\")\n"
      ],
      "edit_loc_traj": {
        "prompt": "\nPlease review the following GitHub problem description and relevant files, and provide a set of locations that need to be edited to fix the issue.\nThe locations can be specified as class names, function or method names, or exact line numbers that require modification.\n\n### GitHub Problem Description ###\nOption to disallow edits from maintainers\n### Describe the feature or problem you’d like to solve\r\n\r\nI would like to disallow edits by maintainers when creating a PR from the command line. Currently, I have to open the PR in the browser and untick the checkbox (\"Allow edits and access to secrets by maintainers\"). Correct me if I'm wrong, but I could not find an option in [the manual](https://cli.github.com/manual/) or an existing issue.\r\n\r\n### Proposed solution\r\n\r\nAdd a flag and a config option to untick this checkbox / disallow edits from the terminal, so that users do not have to open the browser.\r\n\r\n### Additional context\r\n\r\nHub had an issue for this too. At first, the API did not support this, but later a PR got merged (see end of thread): https://github.com/github/hub/issues/1349\n\n###\n### pkg/cmd/pr/create/create.go\n...\n16|\t\"github.com/cli/cli/git\"\n17|\t\"github.com/cli/cli/internal/config\"\n18|\t\"github.com/cli/cli/internal/ghrepo\"\n19|\t\"github.com/cli/cli/pkg/cmd/pr/shared\"\n20|\t\"github.com/cli/cli/pkg/cmdutil\"\n21|\t\"github.com/cli/cli/pkg/iostreams\"\n22|\t\"github.com/cli/cli/pkg/prompt\"\n23|\t\"github.com/cli/cli/utils\"\n24|\t\"github.com/spf13/cobra\"\n25|)\n26|\n27|type CreateOptions struct {\n28|\t// This struct stores user input and factory functions\n29|\tHttpClient func() (*http.Client, error)\n30|\tConfig     func() (config.Config, error)\n31|\tIO         *iostreams.IOStreams\n32|\tRemotes    func() (context.Remotes, error)\n33|\tBranch     func() (string, error)\n34|\n35|\tTitleProvided bool\n36|\tBodyProvided  bool\n37|\n38|\tRootDirOverride string\n39|\tRepoOverride    string\n40|\n41|\tAutofill    bool\n42|\tWebMode     bool\n43|\tRecoverFile string\n44|\n45|\tIsDraft    bool\n46|\tTitle      string\n47|\tBody       string\n48|\tBaseBranch string\n49|\tHeadBranch string\n50|\n51|\tReviewers []string\n52|\tAssignees []string\n53|\tLabels    []string\n54|\tProjects  []string\n55|\tMilestone string\n56|}\n57|\n58|type CreateContext struct {\n59|\t// This struct stores contextual data about the creation process and is for building up enough\n60|\t// data to create a pull request\n61|\tRepoContext        *context.ResolvedRemotes\n62|\tBaseRepo           ghrepo.Interface\n63|\tHeadRepo           ghrepo.Interface\n64|\tBaseTrackingBranch string\n65|\tBaseBranch         string\n66|\tHeadBranch         string\n67|\tHeadBranchLabel    string\n68|\tHeadRemote         *context.Remote\n69|\tIsPushEnabled      bool\n70|\tClient             *api.Client\n71|}\n72|\n73|func NewCmdCreate(f *cmdutil.Factory, runF func(*CreateOptions) error) *cobra.Command {\n74|\topts := &CreateOptions{\n75|\t\tIO:         f.IOStreams,\n76|\t\tHttpClient: f.HttpClient,\n77|\t\tConfig:     f.Config,\n78|\t\tRemotes:    f.Remotes,\n79|\t\tBranch:     f.Branch,\n80|\t}\n81|\n82|\tcmd := &cobra.Command{\n83|\t\tUse:   \"create\",\n84|\t\tShort: \"Create a pull request\",\n85|\t\tLong: heredoc.Doc(`\n86|\t\t\tCreate a pull request on GitHub.\n87|\n88|\t\t\tWhen the current branch isn't fully pushed to a git remote, a prompt will ask where\n89|\t\t\tto push the branch and offer an option to fork the base repository. Use '--head' to\n90|\t\t\texplicitly skip any forking or pushing behavior.\n91|\n92|\t\t\tA prompt will also ask for the title and the body of the pull request. Use '--title'\n93|\t\t\tand '--body' to skip this, or use '--fill' to autofill these values from git commits.\n94|\t\t`),\n95|\t\tExample: heredoc.Doc(`\n96|\t\t\t$ gh pr create --title \"The bug is fixed\" --body \"Everything works again\"\n97|\t\t\t$ gh pr create --reviewer monalisa,hubot  --reviewer myorg/team-name\n98|\t\t\t$ gh pr create --project \"Roadmap\"\n99|\t\t\t$ gh pr create --base develop --head monalisa:feature\n100|\t\t`),\n101|\t\tArgs: cmdutil.NoArgsQuoteReminder,\n102|\t\tRunE: func(cmd *cobra.Command, args []string) error {\n103|\t\t\topts.TitleProvided = cmd.Flags().Changed(\"title\")\n104|\t\t\topts.BodyProvided = cmd.Flags().Changed(\"body\")\n105|\t\t\topts.RepoOverride, _ = cmd.Flags().GetString(\"repo\")\n106|\n107|\t\t\tif !opts.IO.CanPrompt() && opts.RecoverFile != \"\" {\n108|\t\t\t\treturn &cmdutil.FlagError{Err: errors.New(\"--recover only supported when running interactively\")}\n109|\t\t\t}\n110|\n111|\t\t\tif !opts.IO.CanPrompt() && !opts.WebMode && !opts.TitleProvided && !opts.Autofill {\n112|\t\t\t\treturn &cmdutil.FlagError{Err: errors.New(\"--title or --fill required when not running interactively\")}\n113|\t\t\t}\n114|\n115|\t\t\tif opts.IsDraft && opts.WebMode {\n116|\t\t\t\treturn errors.New(\"the --draft flag is not supported with --web\")\n117|\t\t\t}\n118|\t\t\tif len(opts.Reviewers) > 0 && opts.WebMode {\n119|\t\t\t\treturn errors.New(\"the --reviewer flag is not supported with --web\")\n120|\t\t\t}\n121|\n122|\t\t\tif runF != nil {\n123|\t\t\t\treturn runF(opts)\n124|\t\t\t}\n125|\t\t\treturn createRun(opts)\n126|\t\t},\n127|\t}\n128|\n129|\tfl := cmd.Flags()\n130|\tfl.BoolVarP(&opts.IsDraft, \"draft\", \"d\", false, \"Mark pull request as a draft\")\n131|\tfl.StringVarP(&opts.Title, \"title\", \"t\", \"\", \"Title for the pull request\")\n132|\tfl.StringVarP(&opts.Body, \"body\", \"b\", \"\", \"Body for the pull request\")\n133|\tfl.StringVarP(&opts.BaseBranch, \"base\", \"B\", \"\", \"The `branch` into which you want your code merged\")\n134|\tfl.StringVarP(&opts.HeadBranch, \"head\", \"H\", \"\", \"The `branch` that contains commits for your pull request (default: current branch)\")\n135|\tfl.BoolVarP(&opts.WebMode, \"web\", \"w\", false, \"Open the web browser to create a pull request\")\n136|\tfl.BoolVarP(&opts.Autofill, \"fill\", \"f\", false, \"Do not prompt for title/body and just use commit info\")\n137|\tfl.StringSliceVarP(&opts.Reviewers, \"reviewer\", \"r\", nil, \"Request reviews from people or teams by their `handle`\")\n138|\tfl.StringSliceVarP(&opts.Assignees, \"assignee\", \"a\", nil, \"Assign people by their `login`\")\n139|\tfl.StringSliceVarP(&opts.Labels, \"label\", \"l\", nil, \"Add labels by `name`\")\n140|\tfl.StringSliceVarP(&opts.Projects, \"project\", \"p\", nil, \"Add the pull request to projects by `name`\")\n141|\tfl.StringVarP(&opts.Milestone, \"milestone\", \"m\", \"\", \"Add the pull request to a milestone by `name`\")\n142|\tfl.StringVar(&opts.RecoverFile, \"recover\", \"\", \"Recover input from a failed run of create\")\n143|\n144|\treturn cmd\n145|}\n146|\n147|func createRun(opts *CreateOptions) (err error) {\n148|\tctx, err := NewCreateContext(opts)\n149|\tif err != nil {\n150|\t\treturn\n151|\t}\n152|\n153|\tclient := ctx.Client\n154|\n...\n549|\t\tBaseTrackingBranch: baseTrackingBranch,\n550|\t\tHeadBranch:         headBranch,\n551|\t\tHeadBranchLabel:    headBranchLabel,\n552|\t\tHeadRemote:         headRemote,\n553|\t\tIsPushEnabled:      isPushEnabled,\n554|\t\tRepoContext:        repoContext,\n555|\t\tClient:             client,\n556|\t}, nil\n557|\n558|}\n559|\n560|func submitPR(opts CreateOptions, ctx CreateContext, state shared.IssueMetadataState) error {\n561|\tclient := ctx.Client\n562|\n563|\tparams := map[string]interface{}{\n564|\t\t\"title\":       state.Title,\n565|\t\t\"body\":        state.Body,\n566|\t\t\"draft\":       state.Draft,\n567|\t\t\"baseRefName\": ctx.BaseBranch,\n568|\t\t\"headRefName\": ctx.HeadBranchLabel,\n569|\t}\n570|\n571|\tif params[\"title\"] == \"\" {\n572|\t\treturn errors.New(\"pull request title must not be blank\")\n573|\t}\n574|\n575|\terr := shared.AddMetadataToIssueParams(client, ctx.BaseRepo, params, &state)\n576|\tif err != nil {\n577|\t\treturn err\n578|\t}\n579|\n580|\tpr, err := api.CreatePullRequest(client, ctx.BaseRepo.(*api.Repository), params)\n581|\tif pr != nil {\n582|\t\tfmt.Fprintln(opts.IO.Out, pr.URL)\n583|\t}\n584|\tif err != nil {\n585|\t\tif pr != nil {\n586|\t\t\treturn fmt.Errorf(\"pull request update failed: %w\", err)\n587|\t\t}\n588|\t\treturn fmt.Errorf(\"pull request create failed: %w\", err)\n589|\t}\n590|\treturn nil\n591|}\n592|\n593|func previewPR(opts CreateOptions, ctx CreateContext, state shared.IssueMetadataState) error {\n594|\topenURL, err := generateCompareURL(ctx, state)\n595|\tif err != nil {\n596|\t\treturn err\n597|\t}\n598|\n599|\tif opts.IO.IsStdinTTY() && opts.IO.IsStdoutTTY() {\n600|\t\tfmt.Fprintf(opts.IO.ErrOut, \"Opening %s in your browser.\\n\", utils.DisplayURL(openURL))\n...\n678|\t\t}\n679|\n680|\t\terr := pushBranch()\n681|\t\tif err != nil {\n682|\t\t\treturn err\n683|\t\t}\n684|\t}\n685|\n686|\treturn nil\n687|}\n688|\n689|func generateCompareURL(ctx CreateContext, state shared.IssueMetadataState) (string, error) {\n690|\tu := ghrepo.GenerateRepoURL(\n691|\t\tctx.BaseRepo,\n692|\t\t\"compare/%s...%s?expand=1\",\n693|\t\turl.QueryEscape(ctx.BaseBranch), url.QueryEscape(ctx.HeadBranchLabel))\n694|\turl, err := shared.WithPrAndIssueQueryParams(u, state)\n695|\tif err != nil {\n696|\t\treturn \"\", err\n697|\t}\n698|\treturn url, nil\n699|}\n700|\n701|var gitPushRegexp = regexp.MustCompile(\"^remote: (Create a pull request.*by visiting|[[:space:]]*https://.*/pull/new/).*\\n?$\")\n\n\n### api/queries_pr.go\n...\n32|\tViewerCreated   PullRequestAndTotalCount\n33|\tReviewRequested PullRequestAndTotalCount\n34|\tCurrentPR       *PullRequest\n35|\tDefaultBranch   string\n36|}\n37|\n38|type PullRequestAndTotalCount struct {\n39|\tTotalCount   int\n40|\tPullRequests []PullRequest\n41|}\n42|\n43|type PullRequest struct {\n44|\tID          string\n45|\tNumber      int\n46|\tTitle       string\n47|\tState       string\n48|\tClosed      bool\n49|\tURL         string\n50|\tBaseRefName string\n51|\tHeadRefName string\n52|\tBody        string\n53|\tMergeable   string\n54|\n55|\tAuthor struct {\n56|\t\tLogin string\n57|\t}\n58|\tHeadRepositoryOwner struct {\n59|\t\tLogin string\n60|\t}\n61|\tHeadRepository struct {\n62|\t\tName             string\n63|\t\tDefaultBranchRef struct {\n64|\t\t\tName string\n65|\t\t}\n66|\t}\n67|\tIsCrossRepository   bool\n68|\tIsDraft             bool\n69|\tMaintainerCanModify bool\n70|\n71|\tReviewDecision string\n72|\n73|\tCommits struct {\n74|\t\tTotalCount int\n75|\t\tNodes      []struct {\n76|\t\t\tCommit struct {\n77|\t\t\t\tOid               string\n78|\t\t\t\tStatusCheckRollup struct {\n79|\t\t\t\t\tContexts struct {\n80|\t\t\t\t\t\tNodes []struct {\n81|\t\t\t\t\t\t\tName        string\n82|\t\t\t\t\t\t\tContext     string\n83|\t\t\t\t\t\t\tState       string\n84|\t\t\t\t\t\t\tStatus      string\n85|\t\t\t\t\t\t\tConclusion  string\n86|\t\t\t\t\t\t\tStartedAt   time.Time\n87|\t\t\t\t\t\t\tCompletedAt time.Time\n88|\t\t\t\t\t\t\tDetailsURL  string\n89|\t\t\t\t\t\t\tTargetURL   string\n90|\t\t\t\t\t\t}\n91|\t\t\t\t\t}\n92|\t\t\t\t}\n93|\t\t\t}\n94|\t\t}\n95|\t}\n96|\tReviewRequests struct {\n97|\t\tNodes []struct {\n98|\t\t\tRequestedReviewer struct {\n99|\t\t\t\tTypeName string `json:\"__typename\"`\n100|\t\t\t\tLogin    string\n101|\t\t\t\tName     string\n102|\t\t\t}\n103|\t\t}\n104|\t\tTotalCount int\n105|\t}\n106|\tReviews struct {\n107|\t\tNodes []struct {\n108|\t\t\tAuthor struct {\n109|\t\t\t\tLogin string\n110|\t\t\t}\n111|\t\t\tState string\n112|\t\t}\n113|\t}\n114|\tAssignees struct {\n115|\t\tNodes []struct {\n116|\t\t\tLogin string\n117|\t\t}\n118|\t\tTotalCount int\n119|\t}\n120|\tLabels struct {\n121|\t\tNodes []struct {\n122|\t\t\tName string\n123|\t\t}\n124|\t\tTotalCount int\n125|\t}\n126|\tProjectCards struct {\n127|\t\tNodes []struct {\n128|\t\t\tProject struct {\n129|\t\t\t\tName string\n130|\t\t\t}\n131|\t\t\tColumn struct {\n132|\t\t\t\tName string\n133|\t\t\t}\n134|\t\t}\n135|\t\tTotalCount int\n136|\t}\n137|\tMilestone struct {\n138|\t\tTitle string\n139|\t}\n140|\tComments       Comments\n141|\tReactionGroups ReactionGroups\n142|}\n143|\n144|type NotFoundError struct {\n145|\terror\n146|}\n147|\n148|func (err *NotFoundError) Unwrap() error {\n149|\treturn err.error\n150|}\n151|\n...\n509|\t\t\t\t\t\t\t\tdetailsUrl\n510|\t\t\t\t\t\t\t}\n511|\t\t\t\t\t\t}\n512|\t\t\t\t\t}\n513|\t\t\t\t}\n514|\t\t\t}\n515|\t\t}\n516|\t}\n517|\t`, nil\n518|}\n519|\n520|func PullRequestByNumber(client *Client, repo ghrepo.Interface, number int) (*PullRequest, error) {\n521|\ttype response struct {\n522|\t\tRepository struct {\n523|\t\t\tPullRequest PullRequest\n524|\t\t}\n525|\t}\n526|\n527|\tstatusesFragment, err := prCommitsFragment(client.http, repo.RepoHost())\n528|\tif err != nil {\n529|\t\treturn nil, err\n530|\t}\n531|\n532|\tquery := `\n533|\tquery PullRequestByNumber($owner: String!, $repo: String!, $pr_number: Int!) {\n534|\t\trepository(owner: $owner, name: $repo) {\n535|\t\t\tpullRequest(number: $pr_number) {\n536|\t\t\t\tid\n537|\t\t\t\turl\n538|\t\t\t\tnumber\n539|\t\t\t\ttitle\n540|\t\t\t\tstate\n541|\t\t\t\tclosed\n542|\t\t\t\tbody\n543|\t\t\t\tmergeable\n544|\t\t\t\tauthor {\n545|\t\t\t\t  login\n546|\t\t\t\t}\n547|\t\t\t\t` + statusesFragment + `\n548|\t\t\t\tbaseRefName\n549|\t\t\t\theadRefName\n550|\t\t\t\theadRepositoryOwner {\n551|\t\t\t\t\tlogin\n552|\t\t\t\t}\n553|\t\t\t\theadRepository {\n554|\t\t\t\t\tname\n555|\t\t\t\t}\n556|\t\t\t\tisCrossRepository\n557|\t\t\t\tisDraft\n558|\t\t\t\tmaintainerCanModify\n559|\t\t\t\treviewRequests(first: 100) {\n560|\t\t\t\t\tnodes {\n561|\t\t\t\t\t\trequestedReviewer {\n562|\t\t\t\t\t\t\t__typename\n563|\t\t\t\t\t\t\t...on User {\n564|\t\t\t\t\t\t\t\tlogin\n565|\t\t\t\t\t\t\t}\n566|\t\t\t\t\t\t\t...on Team {\n567|\t\t\t\t\t\t\t\tname\n568|\t\t\t\t\t\t\t}\n569|\t\t\t\t\t\t}\n570|\t\t\t\t\t}\n571|\t\t\t\t\ttotalCount\n572|\t\t\t\t}\n573|\t\t\t\treviews(last: 100) {\n574|\t\t\t\t\tnodes {\n575|\t\t\t\t\t\tauthor {\n576|\t\t\t\t\t\t  login\n577|\t\t\t\t\t\t}\n578|\t\t\t\t\t\tstate\n579|\t\t\t\t\t}\n580|\t\t\t\t\ttotalCount\n581|\t\t\t\t}\n582|\t\t\t\tassignees(first: 100) {\n583|\t\t\t\t\tnodes {\n584|\t\t\t\t\t\tlogin\n585|\t\t\t\t\t}\n586|\t\t\t\t\ttotalCount\n587|\t\t\t\t}\n588|\t\t\t\tlabels(first: 100) {\n589|\t\t\t\t\tnodes {\n590|\t\t\t\t\t\tname\n591|\t\t\t\t\t}\n592|\t\t\t\t\ttotalCount\n593|\t\t\t\t}\n594|\t\t\t\tprojectCards(first: 100) {\n595|\t\t\t\t\tnodes {\n596|\t\t\t\t\t\tproject {\n597|\t\t\t\t\t\t\tname\n598|\t\t\t\t\t\t}\n599|\t\t\t\t\t\tcolumn {\n600|\t\t\t\t\t\t\tname\n601|\t\t\t\t\t\t}\n602|\t\t\t\t\t}\n603|\t\t\t\t\ttotalCount\n604|\t\t\t\t}\n605|\t\t\t\tmilestone{\n606|\t\t\t\t\ttitle\n607|\t\t\t\t}\n608|\t\t\t\tcomments(last: 1) {\n609|\t\t\t\t\tnodes {\n610|\t\t\t\t\t\tauthor {\n611|\t\t\t\t\t\t\tlogin\n612|\t\t\t\t\t\t}\n613|\t\t\t\t\t\tauthorAssociation\n614|\t\t\t\t\t\tbody\n615|\t\t\t\t\t\tcreatedAt\n616|\t\t\t\t\t\tincludesCreatedEdit\n617|\t\t\t\t\t\treactionGroups {\n618|\t\t\t\t\t\t\tcontent\n619|\t\t\t\t\t\t\tusers {\n620|\t\t\t\t\t\t\t\ttotalCount\n621|\t\t\t\t\t\t\t}\n622|\t\t\t\t\t\t}\n623|\t\t\t\t\t}\n624|\t\t\t\t\ttotalCount\n625|\t\t\t\t}\n626|\t\t\t\treactionGroups {\n627|\t\t\t\t\tcontent\n628|\t\t\t\t\tusers {\n629|\t\t\t\t\t\ttotalCount\n630|\t\t\t\t\t}\n631|\t\t\t\t}\n632|\t\t\t}\n633|\t\t}\n634|\t}`\n635|\n636|\tvariables := map[string]interface{}{\n637|\t\t\"owner\":     repo.RepoOwner(),\n638|\t\t\"repo\":      repo.RepoName(),\n639|\t\t\"pr_number\": number,\n640|\t}\n641|\n642|\tvar resp response\n643|\terr = client.GraphQL(repo.RepoHost(), query, variables, &resp)\n644|\tif err != nil {\n645|\t\treturn nil, err\n646|\t}\n647|\n648|\treturn &resp.Repository.PullRequest, nil\n649|}\n650|\n651|func PullRequestForBranch(client *Client, repo ghrepo.Interface, baseBranch, headBranch string, stateFilters []string) (*PullRequest, error) {\n652|\ttype response struct {\n653|\t\tRepository struct {\n654|\t\t\tPullRequests struct {\n655|\t\t\t\tNodes []PullRequest\n656|\t\t\t}\n657|\t\t}\n658|\t}\n659|\n660|\tstatusesFragment, err := prCommitsFragment(client.http, repo.RepoHost())\n661|\tif err != nil {\n662|\t\treturn nil, err\n663|\t}\n664|\n665|\tquery := `\n666|\tquery PullRequestForBranch($owner: String!, $repo: String!, $headRefName: String!, $states: [PullRequestState!]) {\n667|\t\trepository(owner: $owner, name: $repo) {\n668|\t\t\tpullRequests(headRefName: $headRefName, states: $states, first: 30, orderBy: { field: CREATED_AT, direction: DESC }) {\n669|\t\t\t\tnodes {\n670|\t\t\t\t\tid\n671|\t\t\t\t\tnumber\n672|\t\t\t\t\ttitle\n673|\t\t\t\t\tstate\n674|\t\t\t\t\tbody\n675|\t\t\t\t\tmergeable\n676|\t\t\t\t\tauthor {\n677|\t\t\t\t\t\tlogin\n678|\t\t\t\t\t}\n679|\t\t\t\t\t` + statusesFragment + `\n680|\t\t\t\t\turl\n681|\t\t\t\t\tbaseRefName\n682|\t\t\t\t\theadRefName\n683|\t\t\t\t\theadRepositoryOwner {\n684|\t\t\t\t\t\tlogin\n685|\t\t\t\t\t}\n686|\t\t\t\t\theadRepository {\n687|\t\t\t\t\t\tname\n688|\t\t\t\t\t}\n689|\t\t\t\t\tisCrossRepository\n690|\t\t\t\t\tisDraft\n691|\t\t\t\t\tmaintainerCanModify\n692|\t\t\t\t\treviewRequests(first: 100) {\n693|\t\t\t\t\t\tnodes {\n694|\t\t\t\t\t\t\trequestedReviewer {\n695|\t\t\t\t\t\t\t\t__typename\n696|\t\t\t\t\t\t\t\t...on User {\n697|\t\t\t\t\t\t\t\t\tlogin\n698|\t\t\t\t\t\t\t\t}\n699|\t\t\t\t\t\t\t\t...on Team {\n700|\t\t\t\t\t\t\t\t\tname\n701|\t\t\t\t\t\t\t\t}\n702|\t\t\t\t\t\t\t}\n703|\t\t\t\t\t\t}\n704|\t\t\t\t\t\ttotalCount\n705|\t\t\t\t\t}\n706|\t\t\t\t\treviews(last: 100) {\n707|\t\t\t\t\t\tnodes {\n708|\t\t\t\t\t\t\tauthor {\n709|\t\t\t\t\t\t\t  login\n710|\t\t\t\t\t\t\t}\n711|\t\t\t\t\t\t\tstate\n712|\t\t\t\t\t\t}\n713|\t\t\t\t\t\ttotalCount\n714|\t\t\t\t\t}\n715|\t\t\t\t\tassignees(first: 100) {\n716|\t\t\t\t\t\tnodes {\n717|\t\t\t\t\t\t\tlogin\n718|\t\t\t\t\t\t}\n719|\t\t\t\t\t\ttotalCount\n720|\t\t\t\t\t}\n721|\t\t\t\t\tlabels(first: 100) {\n722|\t\t\t\t\t\tnodes {\n723|\t\t\t\t\t\t\tname\n724|\t\t\t\t\t\t}\n725|\t\t\t\t\t\ttotalCount\n726|\t\t\t\t\t}\n727|\t\t\t\t\tprojectCards(first: 100) {\n728|\t\t\t\t\t\tnodes {\n729|\t\t\t\t\t\t\tproject {\n730|\t\t\t\t\t\t\t\tname\n731|\t\t\t\t\t\t\t}\n732|\t\t\t\t\t\t\tcolumn {\n733|\t\t\t\t\t\t\t\tname\n734|\t\t\t\t\t\t\t}\n735|\t\t\t\t\t\t}\n736|\t\t\t\t\t\ttotalCount\n737|\t\t\t\t\t}\n738|\t\t\t\t\tmilestone{\n739|\t\t\t\t\t\ttitle\n740|\t\t\t\t\t}\n741|\t\t\t\t\tcomments(last: 1) {\n742|\t\t\t\t\t\tnodes {\n743|\t\t\t\t\t\t\tauthor {\n744|\t\t\t\t\t\t\t\tlogin\n745|\t\t\t\t\t\t\t}\n746|\t\t\t\t\t\t\tauthorAssociation\n747|\t\t\t\t\t\t\tbody\n748|\t\t\t\t\t\t\tcreatedAt\n749|\t\t\t\t\t\t\tincludesCreatedEdit\n750|\t\t\t\t\t\t\treactionGroups {\n751|\t\t\t\t\t\t\t\tcontent\n752|\t\t\t\t\t\t\t\tusers {\n753|\t\t\t\t\t\t\t\t\ttotalCount\n754|\t\t\t\t\t\t\t\t}\n755|\t\t\t\t\t\t\t}\n756|\t\t\t\t\t\t}\n757|\t\t\t\t\t\ttotalCount\n758|\t\t\t\t\t}\n759|\t\t\t\t\treactionGroups {\n760|\t\t\t\t\t\tcontent\n761|\t\t\t\t\t\tusers {\n762|\t\t\t\t\t\t\ttotalCount\n763|\t\t\t\t\t\t}\n764|\t\t\t\t\t}\n765|\t\t\t\t}\n766|\t\t\t}\n767|\t\t}\n768|\t}`\n769|\n770|\tbranchWithoutOwner := headBranch\n771|\tif idx := strings.Index(headBranch, \":\"); idx >= 0 {\n772|\t\tbranchWithoutOwner = headBranch[idx+1:]\n773|\t}\n774|\n775|\tvariables := map[string]interface{}{\n776|\t\t\"owner\":       repo.RepoOwner(),\n777|\t\t\"repo\":        repo.RepoName(),\n778|\t\t\"headRefName\": branchWithoutOwner,\n779|\t\t\"states\":      stateFilters,\n780|\t}\n781|\n782|\tvar resp response\n783|\terr = client.GraphQL(repo.RepoHost(), query, variables, &resp)\n784|\tif err != nil {\n785|\t\treturn nil, err\n786|\t}\n787|\n788|\tprs := resp.Repository.PullRequests.Nodes\n789|\tsortPullRequestsByState(prs)\n790|\n791|\tfor _, pr := range prs {\n792|\t\tif pr.HeadLabel() == headBranch && (baseBranch == \"\" || pr.BaseRefName == baseBranch) {\n793|\t\t\treturn &pr, nil\n794|\t\t}\n795|\t}\n796|\n797|\treturn nil, &NotFoundError{fmt.Errorf(\"no pull requests found for branch %q\", headBranch)}\n798|}\n799|\n800|// sortPullRequestsByState sorts a PullRequest slice by open-first\n801|func sortPullRequestsByState(prs []PullRequest) {\n802|\tsort.SliceStable(prs, func(a, b int) bool {\n803|\t\treturn prs[a].State == \"OPEN\"\n804|\t})\n805|}\n806|\n807|// CreatePullRequest creates a pull request in a GitHub repository\n808|func CreatePullRequest(client *Client, repo *Repository, params map[string]interface{}) (*PullRequest, error) {\n809|\tquery := `\n810|\t\tmutation PullRequestCreate($input: CreatePullRequestInput!) {\n811|\t\t\tcreatePullRequest(input: $input) {\n812|\t\t\t\tpullRequest {\n813|\t\t\t\t\tid\n814|\t\t\t\t\turl\n815|\t\t\t\t}\n816|\t\t\t}\n817|\t}`\n818|\n819|\tinputParams := map[string]interface{}{\n820|\t\t\"repositoryId\": repo.ID,\n821|\t}\n822|\tfor key, val := range params {\n823|\t\tswitch key {\n824|\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\":\n825|\t\t\tinputParams[key] = val\n826|\t\t}\n827|\t}\n828|\tvariables := map[string]interface{}{\n829|\t\t\"input\": inputParams,\n830|\t}\n831|\n832|\tresult := struct {\n833|\t\tCreatePullRequest struct {\n834|\t\t\tPullRequest PullRequest\n835|\t\t}\n836|\t}{}\n837|\n838|\terr := client.GraphQL(repo.RepoHost(), query, variables, &result)\n839|\tif err != nil {\n840|\t\treturn nil, err\n841|\t}\n842|\tpr := &result.CreatePullRequest.PullRequest\n843|\n844|\t// metadata parameters aren't currently available in `createPullRequest`,\n845|\t// but they are in `updatePullRequest`\n846|\tupdateParams := make(map[string]interface{})\n847|\tfor key, val := range params {\n848|\t\tswitch key {\n849|\t\tcase \"assigneeIds\", \"labelIds\", \"projectIds\", \"milestoneId\":\n850|\t\t\tif !isBlank(val) {\n851|\t\t\t\tupdateParams[key] = val\n852|\t\t\t}\n853|\t\t}\n854|\t}\n855|\tif len(updateParams) > 0 {\n856|\t\tupdateQuery := `\n857|\t\tmutation PullRequestCreateMetadata($input: UpdatePullRequestInput!) {\n858|\t\t\tupdatePullRequest(input: $input) { clientMutationId }\n859|\t\t}`\n860|\t\tupdateParams[\"pullRequestId\"] = pr.ID\n861|\t\tvariables := map[string]interface{}{\n862|\t\t\t\"input\": updateParams,\n863|\t\t}\n864|\t\terr := client.GraphQL(repo.RepoHost(), updateQuery, variables, &result)\n865|\t\tif err != nil {\n866|\t\t\treturn pr, err\n867|\t\t}\n868|\t}\n869|\n870|\t// reviewers are requested in yet another additional mutation\n871|\treviewParams := make(map[string]interface{})\n872|\tif ids, ok := params[\"userReviewerIds\"]; ok && !isBlank(ids) {\n873|\t\treviewParams[\"userIds\"] = ids\n874|\t}\n875|\tif ids, ok := params[\"teamReviewerIds\"]; ok && !isBlank(ids) {\n876|\t\treviewParams[\"teamIds\"] = ids\n877|\t}\n878|\n879|\tif len(reviewParams) > 0 {\n880|\t\treviewQuery := `\n881|\t\tmutation PullRequestCreateRequestReviews($input: RequestReviewsInput!) {\n882|\t\t\trequestReviews(input: $input) { clientMutationId }\n883|\t\t}`\n884|\t\treviewParams[\"pullRequestId\"] = pr.ID\n885|\t\treviewParams[\"union\"] = true\n886|\t\tvariables := map[string]interface{}{\n887|\t\t\t\"input\": reviewParams,\n888|\t\t}\n889|\t\terr := client.GraphQL(repo.RepoHost(), reviewQuery, variables, &result)\n890|\t\tif err != nil {\n891|\t\t\treturn pr, err\n892|\t\t}\n893|\t}\n894|\n895|\treturn pr, nil\n896|}\n897|\n898|func isBlank(v interface{}) bool {\n899|\tswitch vv := v.(type) {\n900|\tcase string:\n901|\t\treturn vv == \"\"\n902|\tcase []string:\n903|\t\treturn len(vv) == 0\n904|\tdefault:\n905|\t\treturn true\n...\n\n\n### pkg/cmd/pr/shared/params.go\n...\n1|package shared\n2|\n3|import (\n4|\t\"fmt\"\n5|\t\"net/url\"\n6|\t\"strings\"\n7|\n8|\t\"github.com/cli/cli/api\"\n9|\t\"github.com/cli/cli/internal/ghrepo\"\n10|)\n11|\n12|func WithPrAndIssueQueryParams(baseURL string, state IssueMetadataState) (string, error) {\n13|\tu, err := url.Parse(baseURL)\n14|\tif err != nil {\n15|\t\treturn \"\", err\n16|\t}\n17|\tq := u.Query()\n18|\tif state.Title != \"\" {\n19|\t\tq.Set(\"title\", state.Title)\n20|\t}\n21|\tif state.Body != \"\" {\n22|\t\tq.Set(\"body\", state.Body)\n23|\t}\n24|\tif len(state.Assignees) > 0 {\n25|\t\tq.Set(\"assignees\", strings.Join(state.Assignees, \",\"))\n26|\t}\n27|\tif len(state.Labels) > 0 {\n28|\t\tq.Set(\"labels\", strings.Join(state.Labels, \",\"))\n29|\t}\n30|\tif len(state.Projects) > 0 {\n31|\t\tq.Set(\"projects\", strings.Join(state.Projects, \",\"))\n32|\t}\n33|\tif len(state.Milestones) > 0 {\n34|\t\tq.Set(\"milestone\", state.Milestones[0])\n35|\t}\n36|\tu.RawQuery = q.Encode()\n37|\treturn u.String(), nil\n38|}\n39|\n40|// Ensure that tb.MetadataResult object exists and contains enough pre-fetched API data to be able\n41|// to resolve all object listed in tb to GraphQL IDs.\n42|func fillMetadata(client *api.Client, baseRepo ghrepo.Interface, tb *IssueMetadataState) error {\n43|\tresolveInput := api.RepoResolveInput{}\n44|\n45|\tif len(tb.Assignees) > 0 && (tb.MetadataResult == nil || len(tb.MetadataResult.AssignableUsers) == 0) {\n46|\t\tresolveInput.Assignees = tb.Assignees\n47|\t}\n...\n\n\n\n\n###\n\nPlease provide the class name, function or method name, or the exact line numbers that need to be edited.\nThe possible location outputs should be either \"class\", \"function\" or \"line\".\n\n### Examples:\n```\nfull_path1/file1.go\nline: 10\nclass: MyClass1\nline: 51\n\nfull_path2/file2.go\nfunction: MyClass2.my_method\nline: 12\n\nfull_path3/file3.go\nfunction: my_function\nline: 24\nline: 156\n```\n\nReturn just the location(s) wrapped with ```.\n",
        "response": [
          "```\npkg/cmd/pr/create/create.go\nline: 56\nfunction: NewCmdCreate\nfunction: submitPR\nfunction: createRun\n\napi/queries_pr.go\nfunction: CreatePullRequest\n```",
          "```\npkg/cmd/pr/create/create.go\nclass: CreateOptions\nfunction: NewCmdCreate\nfunction: submitPR\n\napi/queries_pr.go\nfunction: CreatePullRequest\n```"
        ],
        "usage": {
          "completion_tokens": 0,
          "prompt_tokens": 0
        }
      },
      "additional_artifact_loc_edit_location": [
        {
          "raw_output_loc": [
            "```\npkg/cmd/pr/create/create.go\nline: 56\nfunction: NewCmdCreate\nfunction: submitPR\nfunction: createRun\n\napi/queries_pr.go\nfunction: CreatePullRequest\n```",
            "```\npkg/cmd/pr/create/create.go\nclass: CreateOptions\nfunction: NewCmdCreate\nfunction: submitPR\n\napi/queries_pr.go\nfunction: CreatePullRequest\n```"
          ]
        }
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/api/queries_pr.go b/api/queries_pr.go\nindex 46fc1dd..fab8862 100644\n--- a/api/queries_pr.go\n+++ b/api/queries_pr.go\n@@ -821,7 +821,7 @@ func CreatePullRequest(client *Client, repo *Repository, params map[string]inter\n \t}\n \tfor key, val := range params {\n \t\tswitch key {\n-\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\":\n+\t\tcase \"title\", \"body\", \"draft\", \"baseRefName\", \"headRefName\", \"maintainerCanModify\":\n \t\t\tinputParams[key] = val\n \t\t}\n \t}\ndiff --git a/pkg/cmd/pr/create/create.go b/pkg/cmd/pr/create/create.go\nindex acb8d76..b6c469e 100644\n--- a/pkg/cmd/pr/create/create.go\n+++ b/pkg/cmd/pr/create/create.go\n@@ -53,6 +53,8 @@ type CreateOptions struct {\n \tLabels    []string\n \tProjects  []string\n \tMilestone string\n+\n+\tDisallowMaintainerEdits bool\n }\n \n type CreateContext struct {\n@@ -139,6 +141,7 @@ func NewCmdCreate(f *cmdutil.Factory, runF func(*CreateOptions) error) *cobra.Co\n \tfl.StringSliceVarP(&opts.Labels, \"label\", \"l\", nil, \"Add labels by `name`\")\n \tfl.StringSliceVarP(&opts.Projects, \"project\", \"p\", nil, \"Add the pull request to projects by `name`\")\n \tfl.StringVarP(&opts.Milestone, \"milestone\", \"m\", \"\", \"Add the pull request to a milestone by `name`\")\n+\tfl.BoolVar(&opts.DisallowMaintainerEdits, \"no-maintainer-edits\", false, \"Disallow edits and access to secrets by maintainers\")\n \tfl.StringVar(&opts.RecoverFile, \"recover\", \"\", \"Recover input from a failed run of create\")\n \n \treturn cmd\n@@ -568,6 +571,10 @@ func submitPR(opts CreateOptions, ctx CreateContext, state shared.IssueMetadataS\n \t\t\"headRefName\": ctx.HeadBranchLabel,\n \t}\n \n+\tif opts.DisallowMaintainerEdits {\n+\t\tparams[\"maintainerCanModify\"] = false\n+\t}\n+\n \tif params[\"title\"] == \"\" {\n \t\treturn errors.New(\"pull request title must not be blank\")\n \t}\n",
  "7_resolved": false
}