{
  "instance_id": "SWE-Bench-Verified__python__maintenance__bugfix__9b321036",
  "original_id": "sympy__sympy-15017",
  "1_model_selected_files": [
    "sympy/tensor/array/ndim_array.py"
  ],
  "2_embedding_selected_files": [
    "sympy/tensor/array/ndim_array.py",
    "sympy/tensor/array/__init__.py",
    "sympy/tensor/array/sparse_ndim_array.py",
    "sympy/tensor/array/mutable_ndim_array.py",
    "sympy/tensor/array/dense_ndim_array.py",
    "sympy/tensor/array/arrayop.py",
    "sympy/tensor/indexed.py",
    "sympy/this.py",
    "sympy/__init__.py",
    "sympy/tensor/__init__.py",
    "sympy/release.py",
    "sympy/tensor/tensor.py",
    "sympy/tensor/functions.py",
    "sympy/setup.py",
    "sympy/tensor/index_methods.py",
    "sympy/galgebra.py",
    "sympy/isympy.py",
    "sympy/abc.py",
    ".ci/parse_durations_log.py",
    "sympy/setupegg.py",
    "sympy/conftest.py"
  ],
  "3_final_combined_files": [
    "sympy/tensor/array/ndim_array.py",
    "sympy/tensor/array/__init__.py",
    "sympy/tensor/array/sparse_ndim_array.py"
  ],
  "4_related_elements": {
    "sympy/tensor/array/ndim_array.py": [
      "function: NDimArray.__len__\nfunction: NDimArray.shape\nfunction: NDimArray.rank\nfunction: NDimArray._scan_iterable_shape\nfunction: NDimArray._handle_ndarray_creation_inputs"
    ],
    "sympy/tensor/array/sparse_ndim_array.py": [
      "function: SparseNDimArray.__iter__"
    ],
    "sympy/tensor/array/__init__.py": [
      "variable: Array"
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "sympy/tensor/array/ndim_array.py": [
          "\nfunction: NDimArray.__len__\nline: 178"
        ]
      },
      "patches": [
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..280c148 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -173,8 +173,14 @@ class NDimArray(object):\n         [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\n         >>> len(a)\n         9\n+        >>> from sympy import Array\n+        >>> len(Array(3))  # rank-0 (scalar) array\n+        1\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), there is a single element.\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..e182f31 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -164,6 +164,9 @@ class NDimArray(object):\n     def __len__(self):\n         \"\"\"Overload common function len(). Returns number of elements in array.\n \n+        For rank-0 arrays (scalars), this returns 1, matching the number of\n+        elements yielded by iteration and the behavior of numpy's size.\n+\n         Examples\n         ========\n \n@@ -173,8 +176,12 @@ class NDimArray(object):\n         [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\n         >>> len(a)\n         9\n-\n+        >>> len(MutableDenseNDimArray(3))\n+        1\n         \"\"\"\n+        # A rank-0 array (scalar) has shape () but contains one element.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..371972c 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), treat as having one element\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..dd7774d 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,7 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n-        return self._loop_size\n+        # For rank-0 arrays (scalars), there is a single element.\n+        # Ensure len() reports 1 for scalars, matching iteration behavior and numpy.\n+        return 1 if len(self.shape) == 0 else self._loop_size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..5220080 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,10 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), len should be 1 (the number of elements).\n+        # In that case shape is an empty tuple (), and _loop_size may be 0.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..c01bbe1 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -174,8 +174,11 @@ class NDimArray(object):\n         >>> len(a)\n         9\n \n+        For rank-0 (scalar) arrays, len() returns 1.\n         \"\"\"\n-        return self._loop_size\n+        # For rank-0 arrays (shape == ()), len should be 1, matching the\n+        # number of elements yielded by iteration and numpy's .size.\n+        return 1 if len(self.shape) == 0 else self._loop_size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..6cf4c7d 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -164,6 +164,9 @@ class NDimArray(object):\n     def __len__(self):\n         \"\"\"Overload common function len(). Returns number of elements in array.\n \n+        For rank-0 arrays (scalars) the length is 1, matching the number of\n+        elements yielded by iteration and numpy's behavior.\n+\n         Examples\n         ========\n \n@@ -173,8 +176,13 @@ class NDimArray(object):\n         [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\n         >>> len(a)\n         9\n-\n+        >>> from sympy import Array\n+        >>> len(Array(3))\n+        1\n         \"\"\"\n+        # For scalar (rank-0) arrays, return 1; otherwise use cached size.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..8bc0437 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,7 +175,8 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n-        return self._loop_size\n+        # For rank-0 arrays (scalars), report 1 element to match iterator length.\n+        return 1 if len(self.shape) == 0 else self._loop_size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..bc40c2a 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -174,8 +174,13 @@ class NDimArray(object):\n         >>> len(a)\n         9\n \n+        For rank-0 arrays (scalars), the length is 1, matching the number of\n+        elements produced by iteration.\n+\n         \"\"\"\n-        return self._loop_size\n+        # For 0-D arrays (shape == ()), there is a single element. _loop_size\n+        # can be 0 in that case, so handle the scalar case explicitly.\n+        return 1 if len(self.shape) == 0 else self._loop_size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..2408d2d 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), the number of elements is 1.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "sympy/tensor/array/ndim_array.py": [
          "\nfunction: NDimArray.__len__"
        ]
      },
      "patches": [
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..1c792f1 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), there is a single element.\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..f8d94d4 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -167,15 +167,18 @@ class NDimArray(object):\n         Examples\n         ========\n \n-        >>> from sympy import MutableDenseNDimArray\n+        >>> from sympy import MutableDenseNDimArray, Array\n         >>> a = MutableDenseNDimArray.zeros(3, 3)\n         >>> a\n         [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\n         >>> len(a)\n         9\n+        >>> len(Array(3))\n+        1\n \n         \"\"\"\n-        return self._loop_size\n+        # For rank-0 arrays (scalars), shape is empty and there is a single element.\n+        return self._loop_size if self.shape else 1\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..4191cfe 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,7 +175,12 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n-        return self._loop_size\n+        # Compute the total number of elements from the shape.\n+        # For rank-0 arrays (shape == ()), this correctly returns 1.\n+        size = 1\n+        for dim in self.shape:\n+            size *= int(dim)\n+        return size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..95f8ea8 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -173,8 +173,14 @@ class NDimArray(object):\n         [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\n         >>> len(a)\n         9\n-\n+        >>> from sympy import Array\n+        >>> len(Array(3))\n+        1\n         \"\"\"\n+        # For rank-0 arrays (scalars), return 1 to indicate a single element.\n+        # This matches numpy behavior and the iterator length.\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..9b4916d 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,7 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n-        return self._loop_size\n+        # For rank-0 (scalar) arrays, the number of elements is 1.\n+        # For arrays with any dimension of size 0, _loop_size correctly remains 0.\n+        return 1 if not self.shape else self._loop_size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..b87affd 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -174,7 +174,12 @@ class NDimArray(object):\n         >>> len(a)\n         9\n \n+        For rank-0 arrays (scalars), this returns 1 to match the number of\n+        elements yielded by iteration.\n         \"\"\"\n+        # A rank-0 array (shape == ()) has one element.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..f5bda05 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -174,7 +174,12 @@ class NDimArray(object):\n         >>> len(a)\n         9\n \n+        For rank-0 arrays (scalars), this returns 1.\n+\n         \"\"\"\n+        # For rank-0 arrays (empty shape), the array contains a single element.\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..507d209 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # Rank-0 arrays (scalars) contain a single element\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..876e2b8 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # Rank-0 arrays (scalars) contain a single element\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..9ebfcc6 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -164,17 +164,26 @@ class NDimArray(object):\n     def __len__(self):\n         \"\"\"Overload common function len(). Returns number of elements in array.\n \n+        For rank-0 arrays (scalars), this returns 1 to match the number of\n+        elements yielded by iteration and numpy's behaviour.\n+\n         Examples\n         ========\n \n-        >>> from sympy import MutableDenseNDimArray\n+        >>> from sympy import MutableDenseNDimArray, Array\n         >>> a = MutableDenseNDimArray.zeros(3, 3)\n         >>> a\n         [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\n         >>> len(a)\n         9\n+        >>> len(Array(3))\n+        1\n \n         \"\"\"\n+        # Rank-0 arrays (shape == ()) should report a single element.\n+        shp = self.shape\n+        if shp == tuple() or len(shp) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n"
      ]
    },
    {
      "sample_index": 2,
      "edit_locs": {
        "sympy/tensor/array/ndim_array.py": [
          "\nfunction: NDimArray.__len__\nline: 178"
        ]
      },
      "patches": [
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..876e2b8 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # Rank-0 arrays (scalars) contain a single element\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..d19f9de 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,7 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n-        return self._loop_size\n+        # For rank-0 arrays (scalars), the number of elements is 1.\n+        # For higher-rank arrays, use the precomputed loop size.\n+        return 1 if len(self.shape) == 0 else self._loop_size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..25785f5 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,10 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), len should be 1 (number of elements),\n+        # consistent with numpy and iteration behavior.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..b90f214 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,10 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), there is exactly one element.\n+        # Ensure this matches iteration behaviour and numpy's size semantics.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..83da03d 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,11 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), the number of iterable elements is 1.\n+        # Some internal representations may set _loop_size to 0 when shape is (),\n+        # so we explicitly handle the scalar case here.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..b0eb690 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -174,7 +174,12 @@ class NDimArray(object):\n         >>> len(a)\n         9\n \n+        For rank-0 arrays (scalars), len() returns 1.\n+\n         \"\"\"\n+        # Handle rank-0 arrays (scalars) explicitly: they contain a single element.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..e795657 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -164,6 +164,9 @@ class NDimArray(object):\n     def __len__(self):\n         \"\"\"Overload common function len(). Returns number of elements in array.\n \n+        For scalar (rank-0) arrays, this returns 1, matching the number of\n+        elements produced by iteration.\n+\n         Examples\n         ========\n \n@@ -173,8 +176,13 @@ class NDimArray(object):\n         [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\n         >>> len(a)\n         9\n-\n+        >>> from sympy import Array\n+        >>> len(Array(3))\n+        1\n         \"\"\"\n+        # Scalars (rank-0 arrays) have exactly one element\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..9ba4d25 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -164,6 +164,8 @@ class NDimArray(object):\n     def __len__(self):\n         \"\"\"Overload common function len(). Returns number of elements in array.\n \n+        For rank-0 arrays (scalars) this returns 1, matching numpy's size.\n+\n         Examples\n         ========\n \n@@ -173,8 +175,13 @@ class NDimArray(object):\n         [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\n         >>> len(a)\n         9\n-\n+        >>> from sympy import Array\n+        >>> len(Array(3))\n+        1\n         \"\"\"\n+        # A scalar (rank-0 array) should report one element.\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..c6bbb5b 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,10 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), the number of elements is 1,\n+        # matching the iterator length and NumPy's behavior.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..d0b1be6 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,7 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n-        return self._loop_size\n+        # For rank-0 arrays (scalars), the number of elements is 1.\n+        # Handle empty shape explicitly to match iterator behavior and numpy's size semantics.\n+        return 1 if self.shape == () else self._loop_size\n \n     @property\n     def shape(self):\n"
      ]
    },
    {
      "sample_index": 3,
      "edit_locs": {
        "sympy/tensor/array/ndim_array.py": [
          "\nfunction: NDimArray.__len__\nline: 178"
        ]
      },
      "patches": [
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..e02702d 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -173,8 +173,14 @@ class NDimArray(object):\n         [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\n         >>> len(a)\n         9\n+        >>> from sympy import Array\n+        >>> len(Array(3))\n+        1\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), there is a single element.\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..4c3dd2d 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -174,7 +174,12 @@ class NDimArray(object):\n         >>> len(a)\n         9\n \n+        For rank-0 arrays (scalars), len() returns 1.\n+\n         \"\"\"\n+        # Rank-0 arrays have empty shape but contain a single element.\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..9067702 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -164,6 +164,9 @@ class NDimArray(object):\n     def __len__(self):\n         \"\"\"Overload common function len(). Returns number of elements in array.\n \n+        For zero-dimensional arrays (scalars), this returns 1, matching the\n+        number of elements yielded by iteration.\n+\n         Examples\n         ========\n \n@@ -173,8 +176,14 @@ class NDimArray(object):\n         [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\n         >>> len(a)\n         9\n+        >>> from sympy import Array\n+        >>> len(Array(3))\n+        1\n \n         \"\"\"\n+        # Scalars (rank-0 arrays) have one element.\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..dd6cecd 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -174,8 +174,15 @@ class NDimArray(object):\n         >>> len(a)\n         9\n \n+        For rank-0 arrays (scalars), the number of elements is 1.\n         \"\"\"\n-        return self._loop_size\n+        # For rank-0 arrays (shape == ()), there is a single element.\n+        if not self.shape:\n+            return 1\n+        size = 1\n+        for dim in self.shape:\n+            size *= int(dim)\n+        return size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..e49034d 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,11 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars) the number of elements is 1\n+        # even though the shape is empty. This matches the docstring\n+        # definition (\"number of elements in array\") and iterator length.\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..25bc68d 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,11 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), len should be 1, matching the number\n+        # of elements yielded by iteration and NumPy's .size behaviour.\n+        # For arrays with one or more dimensions, return the total number of elements.\n+        if self.shape == ():\n+            return 1\n         return self._loop_size\n \n     @property\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..4872710 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,7 +175,15 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n-        return self._loop_size\n+        # For rank-0 arrays (scalars), the number of elements is 1.\n+        # For higher-rank arrays, it's the product of the shape dimensions.\n+        # This also correctly returns 0 if any dimension is 0.\n+        if self.shape == ():\n+            return 1\n+        size = 1\n+        for dim in self.shape:\n+            size *= int(dim)\n+        return size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..75c8e7c 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,7 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n-        return self._loop_size\n+        # For rank-0 arrays (scalars), there is a single element even though shape == ().\n+        # For arrays with at least one dimension, return the computed loop size.\n+        return 1 if len(self.shape) == 0 else self._loop_size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..0f1c478 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,7 +175,12 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n-        return self._loop_size\n+        # Return the total number of elements in the array.\n+        # For rank-0 arrays (scalars), this should be 1.\n+        size = 1\n+        for dim in self.shape:\n+            size *= int(dim)\n+        return size\n \n     @property\n     def shape(self):\n",
        "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..27c1881 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -174,7 +174,12 @@ class NDimArray(object):\n         >>> len(a)\n         9\n \n+        For rank-0 arrays (scalars), the number of elements is 1.\n         \"\"\"\n+        # Special-case rank-0 arrays (shape == ()) to report a single element.\n+        # This matches the behavior of iteration and numpy's size semantics.\n+        if hasattr(self, \"shape\") and len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/sympy/tensor/array/ndim_array.py b/sympy/tensor/array/ndim_array.py\nindex 0b1a18b..1c792f1 100644\n--- a/sympy/tensor/array/ndim_array.py\n+++ b/sympy/tensor/array/ndim_array.py\n@@ -175,6 +175,9 @@ class NDimArray(object):\n         9\n \n         \"\"\"\n+        # For rank-0 arrays (scalars), there is a single element.\n+        if len(self.shape) == 0:\n+            return 1\n         return self._loop_size\n \n     @property\n",
  "7_resolved": false
}