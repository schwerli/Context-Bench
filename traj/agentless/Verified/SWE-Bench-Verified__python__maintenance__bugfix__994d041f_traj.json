{
  "instance_id": "SWE-Bench-Verified__python__maintenance__bugfix__994d041f",
  "original_id": "django__django-14792",
  "1_model_selected_files": [
    "django/db/backends/postgresql/operations.py",
    "django/utils/timezone.py",
    "django/db/models/functions/datetime.py"
  ],
  "2_embedding_selected_files": [
    "django/db/models/functions/datetime.py",
    "django/utils/timezone.py",
    "django/utils/dateformat.py",
    "django/utils/dateparse.py",
    "django/db/backends/utils.py",
    "django/utils/duration.py",
    "django/utils/datetime_safe.py",
    "django/db/backends/postgresql/operations.py",
    "django/utils/dates.py",
    "django/db/backends/base/operations.py",
    "django/db/models/fields/__init__.py",
    "django/db/models/lookups.py",
    "django/utils/timesince.py",
    "django/db/backends/postgresql/base.py",
    "django/db/backends/postgresql/__init__.py",
    "django/db/backends/postgresql/features.py",
    "django/db/backends/base/features.py",
    "django/db/backends/postgresql/creation.py",
    "django/utils/version.py",
    "django/db/models/functions/__init__.py",
    "django/db/backends/base/base.py",
    "django/db/backends/postgresql/introspection.py",
    "django/db/backends/base/__init__.py",
    "django/utils/http.py",
    "django/db/models/functions/mixins.py",
    "django/db/backends/__init__.py",
    "django/utils/translation/__init__.py",
    "django/utils/formats.py",
    "django/db/models/__init__.py",
    "django/db/backends/base/creation.py",
    "django/db/backends/base/schema.py",
    "django/db/models/sql/constants.py",
    "django/db/backends/postgresql/schema.py",
    "django/db/models/base.py",
    "django/db/models/sql/query.py",
    "django/db/models/functions/math.py",
    "django/db/__init__.py",
    "django/utils/numberformat.py",
    "django/db/models/functions/window.py",
    "django/db/models/sql/subqueries.py",
    "django/db/models/expressions.py",
    "django/utils/__init__.py",
    "django/db/models/functions/text.py",
    "django/utils/translation/trans_null.py",
    "django/db/models/constants.py",
    "django/db/utils.py",
    "django/db/models/utils.py",
    "django/db/models/sql/__init__.py",
    "django/utils/translation/trans_real.py",
    "django/utils/baseconv.py",
    "django/utils/text.py",
    "django/utils/translation/template.py",
    "django/db/models/constraints.py",
    "django/db/transaction.py",
    "django/db/backends/postgresql/client.py",
    "django/db/backends/base/introspection.py",
    "django/db/models/fields/related.py",
    "django/db/models/sql/compiler.py",
    "django/db/models/manager.py",
    "django/db/models/fields/related_descriptors.py",
    "django/db/models/sql/datastructures.py",
    "django/db/models/query.py",
    "django/db/models/functions/comparison.py",
    "django/__init__.py"
  ],
  "3_final_combined_files": [
    "django/utils/timezone.py",
    "django/db/models/functions/datetime.py",
    "django/db/backends/postgresql/operations.py",
    "django/utils/dateformat.py"
  ],
  "4_related_elements": {
    "django/utils/timezone.py": [
      "function: _get_timezone_name\nfunction: _is_pytz_zone\nvariable: _PYTZ_BASE_CLASSES\nfunction: get_fixed_timezone"
    ],
    "django/db/models/functions/datetime.py": [
      "class: TimezoneMixin\nclass: Extract\nclass: TruncBase\nclass: Trunc\nclass: TruncDate\nclass: TruncTime"
    ],
    "django/db/backends/postgresql/operations.py": [
      "function: DatabaseOperations._prepare_tzname_delta\nfunction: DatabaseOperations._convert_field_to_tz\nfunction: DatabaseOperations.date_trunc_sql\nfunction: DatabaseOperations.datetime_extract_sql\nfunction: DatabaseOperations.datetime_trunc_sql\nfunction: DatabaseOperations.datetime_cast_date_sql\nfunction: DatabaseOperations.datetime_cast_time_sql\nfunction: DatabaseOperations.time_trunc_sql\nfunction: DatabaseOperations.date_extract_sql"
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "django/db/backends/postgresql/operations.py": [
          "\nfunction: DatabaseOperations._prepare_tzname_delta\nline: 46\nline: 47\nline: 48\nline: 49\nline: 50\nline: 51"
        ],
        "django/utils/timezone.py": [
          "\nfunction: _get_timezone_name\nline: 74\nline: 75\nline: 76\nline: 77"
        ],
        "django/db/models/functions/datetime.py": [
          "\nfunction: TimezoneMixin.get_tzname\nline: 17\nline: 18\nline: 19\nline: 20\nline: 21\nline: 22\nline: 23\nline: 24\nline: 25\nline: 26\nline: 27\nline: 28"
        ]
      },
      "patches": [
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..aee62f4 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,10 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only invert the leading sign for numeric UTC offsets (e.g., \"+10\", \"-05:30\").\n+        # Do not alter named time zones like \"Etc/GMT-10\" which include '+' or '-' in the name.\n+        if tzname and tzname[0] in '+-':\n+            return ('-' if tzname[0] == '+' else '+') + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..ac76b36 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,15 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only reverse sign for raw numeric UTC offsets (e.g. \"+10\", \"-03:00\").\n+        # Don't alter named timezones like \"Etc/GMT-10\".\n+        if not tzname:\n+            return tzname\n+        if tzname[0] in ('+', '-'):\n+            rest = tzname[1:]\n+            # Accept formats HH or HH:MM for numeric offsets.\n+            if rest and (rest.isdigit() or (':' in rest and all(p.isdigit() for p in rest.split(':')))):\n+                return ('-' if tzname[0] == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..c73f65c 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,13 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only flip the leading sign for plain numeric offsets (e.g., \"+10\", \"-03:30\").\n+        # Preserve named time zones like \"Etc/GMT-10\" unchanged.\n+        if tzname and tzname[0] in ('+', '-'):\n+            if tzname[0] == '+':\n+                return '-' + tzname[1:]\n+            else:\n+                return '+' + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..506497c 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,11 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only flip the sign for pure numeric UTC offsets (e.g. \"+10\", \"-07:30\").\n+        # Do not modify named time zones like \"Etc/GMT-10\" or \"America/New_York\".\n+        if tzname and tzname[:1] in ('+', '-'):\n+            sign = '-' if tzname[0] == '+' else '+'\n+            return sign + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..ee630c3 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,12 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Reverse the sign only for pure numeric UTC offsets (e.g. \"+10\", \"-08:30\").\n+        # Do not alter named time zones like \"Etc/GMT-10\" which contain '+' or '-'\n+        # as part of their IANA name.\n+        if tzname and tzname[0] in ('+', '-') and tzname[1:].replace(':', '').isdigit():\n+            sign = '-' if tzname[0] == '+' else '+'\n+            return sign + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..11fda98 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,15 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Flip the sign only for pure numeric UTC offsets (e.g. \"+10\", \"-08:30\").\n+        # PostgreSQL expects the opposite sign when using AT TIME ZONE with\n+        # timestamp with time zone. For named time zones (e.g. \"Etc/GMT-10\",\n+        # \"Asia/Tokyo\"), return the identifier unchanged.\n+        if tzname and not any(c.isalpha() for c in tzname):\n+            if tzname[0] == '+':\n+                return '-' + tzname[1:]\n+            elif tzname[0] == '-':\n+                return '+' + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..6e51018 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,10 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only flip the sign for numeric UTC offsets (e.g., '+10', '-05:00').\n+        # Do not alter named time zones like 'Etc/GMT-10' or 'Europe/Paris'.\n+        if tzname and tzname[0] in ('+', '-'):\n+            return ('-' if tzname[0] == '+' else '+') + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..9f4e752 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,16 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        \"\"\"\n+        Reverse the sign only for numeric UTC offsets (e.g. '+10', '-05', '+05:30').\n+        Leave named time zones unchanged (e.g. 'Etc/GMT-10', 'Europe/Paris').\n+        \"\"\"\n+        if tzname:\n+            sign = tzname[0]\n+            rest = tzname[1:]\n+            # Detect simple numeric offset of the form [+|-]HH[:MM]\n+            if sign in ('+', '-') and rest and all(ch.isdigit() or ch == ':' for ch in rest):\n+                return ('-' if sign == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..86c08c3 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,16 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        \"\"\"\n+        Flip sign only for pure numeric offsets (e.g. '+10', '-05:30') to match\n+        PostgreSQL's sign convention. Leave named time zones (e.g. 'Etc/GMT-10',\n+        'America/New_York') unchanged.\n+        \"\"\"\n+        if tzname and tzname[0] in '+-':\n+            rest = tzname[1:]\n+            # Numeric offset consists of digits and optional colon/minutes.\n+            if rest and all(ch.isdigit() or ch == ':' for ch in rest):\n+                return ('-' if tzname[0] == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..2667872 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,13 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Reverse the sign only for plain numeric offsets (e.g., \"+10\", \"-05:30\").\n+        # Do not alter named time zones like \"Etc/GMT-10\" which embed a sign\n+        # as part of the IANA/Posix naming convention.\n+        if tzname and tzname[0] in '+-':\n+            rest = tzname[1:]\n+            if all(c.isdigit() or c == ':' for c in rest):\n+                return ('-' if tzname[0] == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "django/db/backends/postgresql/operations.py": [
          "\nfunction: DatabaseOperations._prepare_tzname_delta"
        ]
      },
      "patches": [
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..5bc869e 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,13 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Flip sign only for pure numeric offsets (e.g., \"+10\", \"-05:30\").\n+        # Named time zones like \"Etc/GMT-10\" or \"Europe/Paris\" should be passed through unchanged.\n+        if tzname and not any(c.isalpha() for c in tzname):\n+            if tzname.startswith('+'):\n+                return '-' + tzname[1:]\n+            elif tzname.startswith('-'):\n+                return '+' + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..c3aabcf 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,13 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only invert the leading sign for pure numeric offsets (e.g., \"+10\", \"-08:30\").\n+        # Do not modify named time zones like \"Etc/GMT-10\" or \"Europe/Paris\".\n+        if tzname and tzname[0] in ('+', '-'):\n+            if tzname[0] == '+':\n+                return '-' + tzname[1:]\n+            else:\n+                return '+' + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..630a2e3 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,16 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        \"\"\"\n+        Reverse the sign only for pure numeric UTC offsets (e.g. '+10', '-06:30').\n+        Named time zones like 'Etc/GMT-10' must be passed through unchanged.\n+        \"\"\"\n+        if tzname and tzname[0] in ('+', '-'):\n+            rest = tzname[1:]\n+            # Accept digits and optional colon in the offset.\n+            if all(ch.isdigit() or ch == ':' for ch in rest) and rest:\n+                sign = '-' if tzname[0] == '+' else '+'\n+                return sign + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..6a4f587 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,17 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only invert the sign for pure numeric offsets (e.g., '+10', '-05:30').\n+        # Named time zones like 'Etc/GMT-10' should be passed through unchanged.\n+        if tzname and tzname[0] in '+-':\n+            offset = tzname[1:]\n+            if offset.isdigit():\n+                return ('-' if tzname[0] == '+' else '+') + offset\n+            else:\n+                # Support hour:minute offsets like '+05:30'\n+                h, sep, m = offset.partition(':')\n+                if sep and h.isdigit() and m.isdigit():\n+                    return ('-' if tzname[0] == '+' else '+') + offset\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..6455280 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,10 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only invert simple UTC offsets like '+HH' or '-HH[:MM]'.\n+        # For named time zones (e.g., 'Etc/GMT-10', 'America/New_York'), return unchanged.\n+        if tzname and tzname[0] in '+-':\n+            return ('-' if tzname[0] == '+' else '+') + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..6ffbacc 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,10 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Flip the sign only for numeric UTC offsets (e.g. \"+10\", \"-05:30\").\n+        # Named time zones like \"Etc/GMT-10\" should be passed through unchanged.\n+        if tzname and tzname[0] in ('+', '-'):\n+            return ('-' if tzname[0] == '+' else '+') + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..a0e3c56 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,12 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only reverse sign for pure offset tznames (e.g. \"+HH\", \"-HH:MM\").\n+        # Do not modify named time zones like \"Etc/GMT-10\".\n+        if tzname and tzname[0] in '+-':\n+            rest = tzname[1:]\n+            if rest and all(ch.isdigit() or ch == ':' for ch in rest):\n+                return ('-' if tzname[0] == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..a59543a 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,10 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only flip the sign for numeric UTC offsets (e.g., \"+10\", \"-05:30\").\n+        # Do not modify named time zones like \"Etc/GMT-10\".\n+        if tzname and tzname[0] in ('+', '-'):\n+            return ('-' if tzname[0] == '+' else '+') + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..af00737 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,13 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only adjust numeric UTC offsets like \"+HH\", \"-HH\", \"+HH:MM\".\n+        # Do not alter IANA time zone names (e.g., \"Etc/GMT-10\").\n+        if tzname and tzname[0] in '+-':\n+            if tzname[0] == '+':\n+                return tzname.replace('+', '-')\n+            else:\n+                return tzname.replace('-', '+')\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..c48111d 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,13 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Reverse the sign only for plain numeric UTC offsets, e.g. \"+10\", \"-05\", \"+10:30\".\n+        # Named time zones like \"Etc/GMT-10\" must be passed through unchanged.\n+        if tzname and tzname[0] in ('+', '-'):\n+            rest = tzname[1:]\n+            # Accept offsets like HH, HHMM, or HH:MM (digits and optional colon).\n+            if rest and all(ch.isdigit() or ch == ':' for ch in rest):\n+                return ('-' if tzname[0] == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n"
      ]
    },
    {
      "sample_index": 2,
      "edit_locs": {
        "django/db/backends/postgresql/operations.py": [
          "\nfunction: DatabaseOperations._prepare_tzname_delta\nline: 46\nline: 47\nline: 48\nline: 49\nline: 50\nline: 51"
        ]
      },
      "patches": [
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..d107577 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,10 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only invert sign for pure numeric offsets (e.g. \"+10\", \"-05:30\").\n+        # For named time zones like \"Etc/GMT-10\", leave as-is.\n+        if tzname and tzname[0] in '+-' and all(c.isdigit() or c == ':' for c in tzname[1:]):\n+            return ('-' if tzname[0] == '+' else '+') + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..a0fdc72 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,13 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only invert the sign for plain numeric offsets (e.g., \"+10\", \"-03:30\").\n+        # Do not alter named time zones like \"Etc/GMT-10\" or \"America/New_York\".\n+        if tzname.startswith(('+', '-')):\n+            if tzname[0] == '+':\n+                return '-' + tzname[1:]\n+            else:\n+                return '+' + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..467d482 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,15 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        \"\"\"\n+        Reverse sign only for pure numeric timezone offsets (e.g. '+10', '-05:30').\n+        Named time zones like 'Etc/GMT-10' already use POSIX-reversed signs and\n+        must not be altered.\n+        \"\"\"\n+        if tzname and tzname[0] in ('+', '-') and all(c.isdigit() or c == ':' for c in tzname[1:]):\n+            # Flip the leading sign for numeric offsets to match Postgres semantics.\n+            flipped = ('-' if tzname[0] == '+' else '+') + tzname[1:]\n+            return flipped\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..c8682f7 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,10 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only invert sign for numeric offset tz strings like '+HH' or '-HH:MM'.\n+        # Do not modify named time zones such as 'Etc/GMT-10' or 'America/New_York'.\n+        if tzname and tzname[0] in ('+', '-'):\n+            return ('-' if tzname[0] == '+' else '+') + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..764cab3 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,11 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only flip the leading sign for plain UTC offset strings (e.g., \"+10\", \"-03:30\").\n+        # Do not alter named time zones such as \"Etc/GMT-10\" which include signs as part of the name.\n+        if tzname and tzname[0] in '+-':\n+            sign = '-' if tzname[0] == '+' else '+'\n+            return sign + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..60009bb 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,13 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only flip the sign for plain numeric offsets (e.g., \"+10\", \"-05:30\").\n+        # Do not alter IANA/zoneinfo names like \"Etc/GMT-10\" or \"Europe/Paris\".\n+        if tzname and tzname[0] in '+-':\n+            if tzname[0] == '+':\n+                return '-' + tzname[1:]\n+            else:\n+                return '+' + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..4af58ca 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,18 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Reverse the sign only for pure numeric offsets like +HH[:MM] or -HH[:MM].\n+        # Do not alter named time zones such as 'Etc/GMT-10'.\n+        if tzname and len(tzname) >= 2 and tzname[0] in '+-':\n+            rest = tzname[1:]\n+            # Simple +HH or -HH\n+            if rest.isdigit():\n+                return ('-' if tzname[0] == '+' else '+') + rest\n+            # Allow +HH:MM or -HH:MM\n+            if ':' in rest:\n+                hours_minutes = rest.split(':', 1)\n+                if len(hours_minutes) == 2 and hours_minutes[0].isdigit() and hours_minutes[1].isdigit():\n+                    return ('-' if tzname[0] == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..b9c4161 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,16 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Flip sign only for simple numeric offsets like \"+10\" or \"-04:30\".\n+        # Do not modify named time zones such as \"Etc/GMT-10\" or \"Europe/Paris\".\n+        if tzname and tzname[0] in ('+', '-'):\n+            rest = tzname[1:]\n+            if rest.isdigit():\n+                return ('-' if tzname[0] == '+' else '+') + rest\n+            if ':' in rest:\n+                hours, minutes = rest.split(':', 1)\n+                if hours.isdigit() and minutes.isdigit():\n+                    return ('-' if tzname[0] == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..1731d75 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,10 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only flip the sign for plain numeric UTC offsets (e.g. \"+10\", \"-0530\").\n+        # Leave named time zones (e.g. \"Etc/GMT-10\") untouched.\n+        if tzname and tzname[:1] in ('+', '-'):\n+            return ('-' if tzname[0] == '+' else '+') + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..f28fce1 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,12 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only invert sign for pure numeric offsets like +HH[:MM[:SS]] or -HH[:MM[:SS]].\n+        # Named timezones (e.g., 'Etc/GMT-10', 'Europe/Paris') should be passed through unchanged.\n+        if tzname and tzname[0] in '+-':\n+            rest = tzname[1:]\n+            if rest and all(ch.isdigit() or ch == ':' for ch in rest):\n+                return ('-' if tzname[0] == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n"
      ]
    },
    {
      "sample_index": 3,
      "edit_locs": {
        "django/db/backends/postgresql/operations.py": [
          "\nfunction: DatabaseOperations._prepare_tzname_delta\nline: 46\nline: 47\nline: 48\nline: 49\nline: 50\nline: 51"
        ]
      },
      "patches": [
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..a3dc226 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,13 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only flip the sign for pure numeric UTC offsets (e.g., \"+10\", \"-03:30\").\n+        # Do not alter named time zones like \"Etc/GMT-10\".\n+        if tzname and tzname[0] in '+-':\n+            if tzname[0] == '+':\n+                return '-' + tzname[1:]\n+            else:\n+                return '+' + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..3faa0c3 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,11 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only reverse timezone sign for simple numeric offsets like \"+HH\" or \"-HH\".\n+        # Do not alter named time zones such as \"Etc/GMT-10\".\n+        if tzname and tzname[0] in ('+', '-'):\n+            flipped = '-' if tzname[0] == '+' else '+'\n+            return flipped + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..79106f7 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,16 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        \"\"\"\n+        Reverse the sign only for pure numeric offsets like '+HH[:MM]' or '-HH[:MM]'.\n+        Named time zones (e.g., 'Etc/GMT-10', 'Europe/Paris') should be passed through unchanged.\n+        \"\"\"\n+        if tzname and tzname[0] in ('+', '-'):\n+            # Validate that the remainder is a numeric offset optionally containing a single colon.\n+            remainder = tzname[1:]\n+            num = remainder.replace(':', '')\n+            if num.isdigit():\n+                return ('-' if tzname[0] == '+' else '+') + remainder\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..87a5739 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,13 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only flip the sign for numeric UTC offsets (e.g. '+10', '-05:30').\n+        # For named time zones like 'Etc/GMT-10', leave the name unchanged.\n+        if tzname and all(ch in '+-:0123456789' for ch in tzname):\n+            if '+' in tzname:\n+                return tzname.replace('+', '-')\n+            elif '-' in tzname:\n+                return tzname.replace('-', '+')\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..d3bcc1a 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,23 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        \"\"\"\n+        Reverse the sign only for plain numeric offsets (e.g. '+10', '-08:30').\n+        Named time zones (e.g. 'Etc/GMT-10') must be passed through unchanged.\n+        \"\"\"\n+        if not tzname:\n+            return tzname\n+        # Only flip sign if tzname is a plain numeric offset like '+HH' or '+HH:MM'.\n+        if tzname[0] in '+-':\n+            rest = tzname[1:]\n+            # '+HH' or '-HH'\n+            if rest.isdigit():\n+                return ('-' if tzname[0] == '+' else '+') + rest\n+            # '+HH:MM' or '-HH:MM'\n+            parts = rest.split(':')\n+            if len(parts) == 2 and parts[0].isdigit() and parts[1].isdigit() and len(parts[1]) == 2:\n+                return ('-' if tzname[0] == '+' else '+') + rest\n+        # Leave named time zones unchanged (e.g., 'Etc/GMT-10').\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..a696b79 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,10 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only invert sign for plain numeric offsets (e.g., \"+10\", \"-05:30\").\n+        # Do not modify named time zones like \"Etc/GMT-10\".\n+        if tzname and tzname[0] in ('+', '-') and set(tzname[1:]).issubset(set('0123456789:')):\n+            return ('-' if tzname[0] == '+' else '+') + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..b3394bd 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,22 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        \"\"\"\n+        Invert the sign for plain numeric timezone offsets (e.g., \"+10\", \"-05:30\")\n+        because PostgreSQL's AT TIME ZONE expects the opposite sign convention.\n+        Do not modify IANA/Olson tz names like \"Etc/GMT-10\" which already encode\n+        their sign semantics.\n+        \"\"\"\n+        if isinstance(tzname, str) and tzname:\n+            # Only flip if tzname is a pure numeric offset.\n+            if tzname[0] in ('+', '-'):\n+                rest = tzname[1:]\n+                if rest.isdigit():\n+                    return ('-' if tzname[0] == '+' else '+') + rest\n+                if ':' in rest:\n+                    parts = rest.split(':')\n+                    if len(parts) == 2 and parts[0].isdigit() and parts[1].isdigit():\n+                        return ('-' if tzname[0] == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..c579523 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,28 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        \"\"\"\n+        Normalize tzname for PostgreSQL AT TIME ZONE.\n+\n+        For fixed-offset timezones provided as a numeric delta (e.g. \"+10\",\n+        \"-05\", \"+10:30\"), PostgreSQL expects the opposite sign because IANA's\n+        Etc/GMT zones use reversed signs. Historically Django passed numeric\n+        offsets, so we invert only when tzname is a pure offset.\n+\n+        If tzname is a named time zone (e.g. \"Etc/GMT-10\", \"UTC\", \"Europe/Paris\"),\n+        leave it unchanged.\n+        \"\"\"\n+        if not tzname:\n+            return tzname\n+        # Only flip sign for pure offsets of the form ±HH[:MM] or ±HHMM\n+        sign = tzname[0]\n+        if sign in ('+', '-') and len(tzname) > 1:\n+            rest = tzname[1:]\n+            # Accept digits (e.g. \"0530\") or \"HH:MM\" formats (e.g. \"10:30\").\n+            if rest.isdigit() or (\n+                ':' in rest and all(part.isdigit() for part in rest.split(':', 1))\n+            ):\n+                return ('-' if sign == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..b0eee6a 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,12 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Reverse sign only for fixed-offset tz names like \"+HH[:MM]\" or \"-HH[:MM]\".\n+        # Do not modify named IANA zones (e.g., \"Etc/GMT-10\"), whose sign semantics differ.\n+        if tzname and tzname[0] == '+':\n+            return '-' + tzname[1:]\n+        elif tzname and tzname[0] == '-':\n+            return '+' + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
        "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..3c800d1 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,12 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only flip the sign for plain numeric offsets like \"+10\" or \"-03:30\".\n+        # Named time zones (e.g., \"Etc/GMT-10\") must be passed through unchanged.\n+        if tzname and tzname[0] in ('+', '-'):\n+            rest = tzname[1:]\n+            if rest and all(ch.isdigit() or ch == ':' for ch in rest):\n+                return ('-' if tzname[0] == '+' else '+') + rest\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/django/db/backends/postgresql/operations.py b/django/db/backends/postgresql/operations.py\nindex 12df5a3..aee62f4 100644\n--- a/django/db/backends/postgresql/operations.py\n+++ b/django/db/backends/postgresql/operations.py\n@@ -44,10 +44,10 @@ class DatabaseOperations(BaseDatabaseOperations):\n         return \"DATE_TRUNC('%s', %s)\" % (lookup_type, field_name)\n \n     def _prepare_tzname_delta(self, tzname):\n-        if '+' in tzname:\n-            return tzname.replace('+', '-')\n-        elif '-' in tzname:\n-            return tzname.replace('-', '+')\n+        # Only invert the leading sign for numeric UTC offsets (e.g., \"+10\", \"-05:30\").\n+        # Do not alter named time zones like \"Etc/GMT-10\" which include '+' or '-' in the name.\n+        if tzname and tzname[0] in '+-':\n+            return ('-' if tzname[0] == '+' else '+') + tzname[1:]\n         return tzname\n \n     def _convert_field_to_tz(self, field_name, tzname):\n",
  "7_resolved": false
}