{
  "instance_id": "SWE-Bench-Verified__python__maintenance__bugfix__ee10f0e4",
  "original_id": "django__django-13513",
  "1_model_selected_files": [
    "django/views/debug.py"
  ],
  "2_embedding_selected_files": [
    "django/views/debug.py",
    "django/views/csrf.py",
    "django/views/defaults.py",
    "django/views/__init__.py",
    "django/setup.py",
    "django/shortcuts.py",
    "django/views/i18n.py",
    "django/views/static.py",
    "django/__main__.py",
    "django/__init__.py"
  ],
  "3_final_combined_files": [
    "django/views/debug.py",
    "django/views/csrf.py",
    "django/views/defaults.py"
  ],
  "4_related_elements": {
    "django/views/debug.py": [
      "class: ExceptionCycleWarning\nfunction: technical_500_response\nfunction: ExceptionReporter.get_traceback_frames\nfunction: explicit_or_implicit_cause\nfunction: ExceptionReporter.get_traceback_data\nfunction: ExceptionReporter.get_traceback_html\nfunction: ExceptionReporter.get_traceback_text"
    ],
    "django/views/csrf.py": [
      ""
    ],
    "django/views/defaults.py": [
      ""
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "django/views/debug.py": [
          "\nfunction: ExceptionReporter.get_traceback_frames\nline: 398\nline: 399\nline: 400\nline: 401\nline: 402\nline: 403"
        ]
      },
      "patches": [
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..82f8366 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -397,9 +397,10 @@ class ExceptionReporter:\n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n             explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            if explicit is not None:\n+                return explicit\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n+            return None if suppress_context else getattr(exc_value, '__context__', None)\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +447,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (getattr(exc_value, '__cause__', None) is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..dc1c556 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,11 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: if __suppress_context__ is True, ignore __context__\n+            return (\n+                exc_value.__cause__ or\n+                (None if exc_value.__suppress_context__ else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +447,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (exc_value.__cause__ is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..1b2bbd1 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,8 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: if __suppress_context__ is True, ignore implicit context.\n+            return exc_value.__cause__ or (None if exc_value.__suppress_context__ else exc_value.__context__)\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +444,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': bool(getattr(exc_value, '__cause__', None)),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..f2a1389 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,14 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n+            # Respect PEP 415's __suppress_context__ to avoid showing implicit context\n+            # when an exception is raised with \"from None\".\n             explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n+            if explicit is not None:\n+                return explicit\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n             implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            return None if suppress_context else implicit\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +450,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..a4a6bff 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,12 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: if __suppress_context__ is True (raise ... from None),\n+            # do not show the implicit context.\n+            return (\n+                exc_value.__cause__ or\n+                (None if exc_value.__suppress_context__ else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +448,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (exc_value.__cause__ is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..4364042 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,11 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: ignore __context__ when __suppress_context__ is True.\n+            return (\n+                exc_value.__cause__ or\n+                (None if exc_value.__suppress_context__ else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +447,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (exc_value.__cause__ is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..9e48e48 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -446,7 +446,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..cda5834 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -446,7 +446,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': bool(getattr(exc_value, '__cause__', None)),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..a612dc3 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -397,7 +397,7 @@ class ExceptionReporter:\n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n             explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n             implicit = getattr(exc_value, '__context__', None)\n             return explicit or (None if suppress_context else implicit)\n \n@@ -446,7 +446,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (getattr(exc_value, '__cause__', None) is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..11a15fa 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,12 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n+            # Respect PEP 415: __suppress_context__ prevents displaying implicit context\n             explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            if explicit is not None:\n+                return explicit\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n+            return None if suppress_context else getattr(exc_value, '__context__', None)\n \n         # Get the exception and all its causes\n         exceptions = []\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "django/views/debug.py": [
          "\nfunction: ExceptionReporter.get_traceback_frames\nline: 398\nline: 399\nline: 400\nline: 401\nline: 402"
        ]
      },
      "patches": [
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..64d7838 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,14 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Prefer explicit cause set via \"raise ... from ...\".\n+            if exc_value.__cause__ is not None:\n+                return exc_value.__cause__\n+            # Respect suppression of context (PEP 415): \"raise ... from None\".\n+            if getattr(exc_value, '__suppress_context__', False):\n+                return None\n+            # Fall back to implicit context.\n+            return exc_value.__context__\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +450,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..97f432f 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,13 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect explicit causes and PEP 415's __suppress_context__ flag.\n+            # If there's an explicit cause, use it. Otherwise, suppress the\n+            # implicit context when __suppress_context__ is True.\n+            return (\n+                exc_value.__cause__ or\n+                (None if exc_value.__suppress_context__ else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +449,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': exc_value.__cause__ is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..9e48e48 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -446,7 +446,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..6b1b487 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,11 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: don't show implicit context when suppressed.\n+            explicit = exc_value.__cause__\n+            if explicit is not None:\n+                return explicit\n+            return None if exc_value.__suppress_context__ else exc_value.__context__\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +447,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (exc_value.__cause__ is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..b2d2235 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,10 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            return (\n+                exc_value.__cause__ or\n+                (None if getattr(exc_value, '__suppress_context__', False) else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +446,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (exc_value.__cause__ is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..eeb5ba9 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,12 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415 (__suppress_context__), so \"raise ... from None\"\n+            # does not include the suppressed context in the exception chain.\n+            return (\n+                exc_value.__cause__ or\n+                (None if exc_value.__suppress_context__ else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..8ddc060 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -397,7 +397,8 @@ class ExceptionReporter:\n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n             explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n+            # Respect PEP 415: if __suppress_context__ is True, ignore the implicit __context__.\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n             implicit = getattr(exc_value, '__context__', None)\n             return explicit or (None if suppress_context else implicit)\n \n@@ -446,7 +447,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': bool(getattr(exc_value, '__cause__', None)),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..bda9854 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,13 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n+            # Respect PEP 415: if \"from None\" was used, __suppress_context__ is True\n+            # and the implicit context must be ignored.\n             explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            if explicit is not None:\n+                return explicit\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n+            return None if suppress_context else getattr(exc_value, '__context__', None)\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +449,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..89f6c87 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -397,7 +397,7 @@ class ExceptionReporter:\n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n             explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n             implicit = getattr(exc_value, '__context__', None)\n             return explicit or (None if suppress_context else implicit)\n \n@@ -446,7 +446,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n"
      ]
    },
    {
      "sample_index": 2,
      "edit_locs": {
        "django/views/debug.py": [
          "\nfunction: ExceptionReporter.get_traceback_frames.explicit_or_implicit_cause\nline: 398\nline: 399\nline: 400\nline: 401\nline: 402\nline: 403"
        ]
      },
      "patches": [
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..75d767a 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,7 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            return exc_value.__cause__ or (None if exc_value.__suppress_context__ else exc_value.__context__)\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +443,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (exc_value.__cause__ is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..fb6ff0e 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -397,9 +397,10 @@ class ExceptionReporter:\n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n             explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            if explicit is not None:\n+                return explicit\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n+            return None if suppress_context else getattr(exc_value, '__context__', None)\n \n         # Get the exception and all its causes\n         exceptions = []\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..093a81b 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,12 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: if context is suppressed (raise ... from None),\n+            # don't show the implicit context; otherwise prefer explicit cause.\n+            return (\n+                exc_value.__cause__ or\n+                (None if exc_value.__suppress_context__ else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +448,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..95eb68a 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,13 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect Python's exception chaining semantics (PEP 415).\n+            cause = exc_value.__cause__\n+            if cause is not None:\n+                return cause\n+            if exc_value.__suppress_context__:\n+                return None\n+            return exc_value.__context__\n \n         # Get the exception and all its causes\n         exceptions = []\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..0e338b0 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,13 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: show __cause__ or, if not suppressed, __context__\n+            cause = getattr(exc_value, '__cause__', None)\n+            if cause is not None:\n+                return cause\n+            if getattr(exc_value, '__suppress_context__', False):\n+                return None\n+            return getattr(exc_value, '__context__', None)\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +449,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..8b65ca1 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,11 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: if exc.__suppress_context__ is True, ignore the implicit context.\n+            cause = exc_value.__cause__\n+            if cause is not None:\n+                return cause\n+            return None if exc_value.__suppress_context__ else exc_value.__context__\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +447,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..29b2c68 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,14 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Prefer explicit cause; otherwise use implicit cause unless\n+            # the context was suppressed (PEP 415).\n+            cause = getattr(exc_value, '__cause__', None)\n+            if cause is not None:\n+                return cause\n+            if getattr(exc_value, '__suppress_context__', False):\n+                return None\n+            return getattr(exc_value, '__context__', None)\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +450,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..0d6e5a8 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,13 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: use explicit cause if present; otherwise use context unless suppressed.\n+            cause = getattr(exc_value, '__cause__', None)\n+            if cause is not None:\n+                return cause\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n+            context = getattr(exc_value, '__context__', None)\n+            return None if suppress_context else context\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +449,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..03c7457 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,14 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: prefer explicit causes; suppress implicit context if requested.\n+            cause = getattr(exc_value, '__cause__', None)\n+            if cause is not None:\n+                return cause\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n+            if suppress_context:\n+                return None\n+            return getattr(exc_value, '__context__', None)\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +450,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n"
      ]
    },
    {
      "sample_index": 3,
      "edit_locs": {
        "django/views/debug.py": [
          "\nfunction: ExceptionReporter.get_traceback_frames\nline: 398\nline: 399\nline: 400\nline: 401\nline: 402"
        ]
      },
      "patches": [
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..053ced7 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,12 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: if the context is suppressed (raise ... from None),\n+            # don't follow the implicit context.\n+            return (\n+                exc_value.__cause__ or\n+                (None if getattr(exc_value, '__suppress_context__', False) else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +448,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': getattr(exc_value, '__cause__', None) is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..e7f8b31 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -397,7 +397,7 @@ class ExceptionReporter:\n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n             explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n             implicit = getattr(exc_value, '__context__', None)\n             return explicit or (None if suppress_context else implicit)\n \n@@ -446,7 +446,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': bool(getattr(exc_value, '__cause__', None)),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..25d720e 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,10 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            return (\n+                exc_value.__cause__ or\n+                (None if exc_value.__suppress_context__ else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..337c9ad 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,11 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: __suppress_context__ hides __context__ when True.\n+            return (\n+                exc_value.__cause__\n+                or (None if exc_value.__suppress_context__ else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +447,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (exc_value.__cause__ is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..d6b1467 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,10 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            return (\n+                exc_value.__cause__ or\n+                (None if getattr(exc_value, '__suppress_context__', False) else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..303fb6c 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,11 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            # Respect PEP 415: if __suppress_context__ is True, ignore __context__.\n+            cause = exc_value.__cause__\n+            if cause is not None:\n+                return cause\n+            return None if getattr(exc_value, '__suppress_context__', False) else exc_value.__context__\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +447,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (exc_value.__cause__ is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..bdd8208 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,10 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            explicit = exc_value.__cause__\n+            if explicit is not None:\n+                return explicit\n+            return None if exc_value.__suppress_context__ else exc_value.__context__\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +446,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (exc_value.__cause__ is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..46d8e19 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,10 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            return (\n+                exc_value.__cause__ or\n+                (None if exc_value.__suppress_context__ else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +446,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': exc_value.__cause__ is not None,\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
        "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..41ad376 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -396,10 +396,10 @@ class ExceptionReporter:\n \n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n-            explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            return (\n+                exc_value.__cause__ or\n+                (None if exc_value.__suppress_context__ else exc_value.__context__)\n+            )\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +446,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (exc_value.__cause__ is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/django/views/debug.py b/django/views/debug.py\nindex d064033..82f8366 100644\n--- a/django/views/debug.py\n+++ b/django/views/debug.py\n@@ -397,9 +397,10 @@ class ExceptionReporter:\n     def get_traceback_frames(self):\n         def explicit_or_implicit_cause(exc_value):\n             explicit = getattr(exc_value, '__cause__', None)\n-            suppress_context = getattr(exc_value, '__suppress_context__', None)\n-            implicit = getattr(exc_value, '__context__', None)\n-            return explicit or (None if suppress_context else implicit)\n+            if explicit is not None:\n+                return explicit\n+            suppress_context = getattr(exc_value, '__suppress_context__', False)\n+            return None if suppress_context else getattr(exc_value, '__context__', None)\n \n         # Get the exception and all its causes\n         exceptions = []\n@@ -446,7 +447,7 @@ class ExceptionReporter:\n                 post_context = []\n             frames.append({\n                 'exc_cause': explicit_or_implicit_cause(exc_value),\n-                'exc_cause_explicit': getattr(exc_value, '__cause__', True),\n+                'exc_cause_explicit': (getattr(exc_value, '__cause__', None) is not None),\n                 'tb': tb,\n                 'type': 'django' if module_name.startswith('django.') else 'user',\n                 'filename': filename,\n",
  "7_resolved": false
}