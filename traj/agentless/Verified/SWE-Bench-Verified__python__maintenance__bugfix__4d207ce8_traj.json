{
  "instance_id": "SWE-Bench-Verified__python__maintenance__bugfix__4d207ce8",
  "original_id": "django__django-13028",
  "1_model_selected_files": [
    "django/db/models/sql/query.py"
  ],
  "2_embedding_selected_files": [
    "django/db/models/query_utils.py",
    "django/db/models/__init__.py",
    "django/db/models/fields/related.py",
    "django/db/models/fields/related_descriptors.py",
    "django/db/backends/sqlite3/features.py",
    "django/db/backends/mysql/schema.py",
    "django/db/models/query.py",
    "django/db/backends/postgresql/features.py",
    "django/db/models/base.py",
    "django/db/migrations/questioner.py",
    "django/db/backends/oracle/features.py",
    "django/db/models/fields/__init__.py",
    "django/db/models/sql/__init__.py",
    "django/db/models/sql/query.py",
    "django/db/models/lookups.py",
    "django/db/backends/base/features.py",
    "django/db/backends/sqlite3/schema.py",
    "django/db/models/sql/subqueries.py",
    "django/db/backends/mysql/features.py",
    "django/db/models/options.py",
    "django/db/models/manager.py",
    "django/db/models/fields/related_lookups.py",
    "django/db/models/fields/reverse_related.py",
    "django/db/models/constraints.py",
    "django/db/backends/mysql/validation.py",
    "django/db/backends/sqlite3/__init__.py",
    "django/db/migrations/autodetector.py",
    "django/db/backends/sqlite3/base.py",
    "django/db/backends/oracle/schema.py",
    "django/db/models/fields/proxy.py",
    "django/db/backends/dummy/features.py",
    "django/db/backends/mysql/compiler.py",
    "django/db/backends/base/__init__.py",
    "django/db/backends/postgresql/__init__.py",
    "django/db/backends/base/schema.py",
    "django/db/backends/__init__.py",
    "django/db/models/functions/mixins.py",
    "django/db/models/sql/datastructures.py",
    "django/db/backends/oracle/validation.py",
    "django/db/models/sql/compiler.py",
    "django/db/backends/mysql/__init__.py",
    "django/db/models/fields/mixins.py",
    "django/db/models/fields/json.py",
    "django/db/backends/postgresql/operations.py",
    "django/db/backends/sqlite3/operations.py",
    "django/db/models/expressions.py",
    "django/db/migrations/exceptions.py",
    "django/db/models/enums.py",
    "django/db/backends/dummy/__init__.py",
    "django/db/migrations/operations/__init__.py",
    "django/db/backends/postgresql/base.py",
    "django/db/migrations/operations/fields.py",
    "django/db/backends/oracle/operations.py",
    "django/db/migrations/__init__.py",
    "django/db/models/deletion.py",
    "django/db/migrations/executor.py",
    "django/db/utils.py",
    "django/db/backends/oracle/introspection.py",
    "django/db/backends/mysql/base.py",
    "django/db/migrations/operations/models.py",
    "django/db/backends/oracle/__init__.py",
    "django/db/models/sql/where.py"
  ],
  "3_final_combined_files": [
    "django/db/models/sql/query.py",
    "django/db/models/query_utils.py",
    "django/db/models/__init__.py",
    "django/db/models/fields/related.py"
  ],
  "4_related_elements": {
    "django/db/models/sql/query.py": [
      "function: Query.check_filterable\nfunction: Query.build_filter\nfunction: Query._add_q\nfunction: Query.add_q\nfunction: Query.check_query_object_type\nfunction: Query.resolve_lookup_value"
    ],
    "django/db/models/query_utils.py": [
      ""
    ],
    "django/db/models/__init__.py": [
      ""
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "django/db/models/sql/query.py": [
          "\nfunction: Query.check_filterable\nline: 1127"
        ]
      },
      "patches": [
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..7db1c1f 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,15 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only enforce the \"filterable\" flag on Django expression objects to\n+        # avoid conflicts with arbitrary RHS values (e.g., model instances)\n+        # that happen to define a \"filterable\" attribute.\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..23c5027 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,11 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only respect the 'filterable' flag for expression objects. Avoid\n+        # treating arbitrary objects (e.g. model instances with a field named\n+        # \"filterable\") as unfilterable.\n+        from django.db.models.expressions import BaseExpression\n+        if isinstance(expression, BaseExpression) and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..744cde6 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,14 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only apply the \"filterable\" check to expression nodes, not arbitrary\n+        # Python objects which may coincidentally define a \"filterable\" attribute.\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..f00ef06 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,19 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n-        if hasattr(expression, 'get_source_expressions'):\n+        # Only check the \"filterable\" flag on actual query Expressions. Arbitrary\n+        # Python objects (e.g., model instances) may define a \"filterable\"\n+        # attribute unrelated to query expressions and must not be considered.\n+        try:\n+            from django.db.models.expressions import Expression\n+        except Exception:\n+            Expression = None\n+        if Expression is not None and isinstance(expression, Expression):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..2263266 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1123,15 +1123,22 @@ class Query(BaseExpression):\n                     self.check_query_object_type(v, opts, field)\n \n     def check_filterable(self, expression):\n-        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n-        if hasattr(expression, 'get_source_expressions'):\n-            for expr in expression.get_source_expressions():\n-                self.check_filterable(expr)\n+        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\n+\n+        Only Django expressions (objects participating in the expressions API)\n+        should be inspected for the `filterable` flag. Plain Python values or\n+        model instances may have a `filterable` attribute unrelated to query\n+        expressions and must not trigger this validation.\n+        \"\"\"\n+        if hasattr(expression, 'resolve_expression'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n+            if hasattr(expression, 'get_source_expressions'):\n+                for expr in expression.get_source_expressions():\n+                    self.check_filterable(expr)\n \n     def build_lookup(self, lookups, lhs, rhs):\n         \"\"\"\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..c8210b7 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,15 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only check 'filterable' for Django expressions. Avoid treating\n+        # arbitrary RHS values (e.g., model instances with a 'filterable' field)\n+        # as expressions.\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..13dc0a9 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,15 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only expressions participate in filterability checks. Avoid\n+        # attribute name collisions with plain Python objects (e.g. model\n+        # instances that may have a \"filterable\" field).\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..b4b8dc8 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,10 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only consider the 'filterable' flag on Django Expression objects to\n+        # avoid collisions with user-defined model fields named 'filterable'.\n+        from django.db.models.expressions import Expression\n+        if isinstance(expression, Expression) and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..d05d626 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,11 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only consider the 'filterable' attribute for expression-like objects\n+        # (i.e., Django ORM expressions), not arbitrary RHS values that may\n+        # coincidentally have a 'filterable' attribute (e.g., model fields).\n+        is_expression = hasattr(expression, 'resolve_expression') or hasattr(expression, 'get_source_expressions')\n+        if is_expression and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..735a145 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,14 +1124,19 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n-        if hasattr(expression, 'get_source_expressions'):\n-            for expr in expression.get_source_expressions():\n-                self.check_filterable(expr)\n+        # Only Django Expression objects may define a \"filterable\" contract.\n+        # Avoid collisions with user-defined attributes on arbitrary RHS values\n+        # such as model instances or plain Python values.\n+        from django.db.models.expressions import BaseExpression\n+        if isinstance(expression, BaseExpression):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n+            if hasattr(expression, 'get_source_expressions'):\n+                for expr in expression.get_source_expressions():\n+                    self.check_filterable(expr)\n \n     def build_lookup(self, lookups, lhs, rhs):\n         \"\"\"\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "django/db/models/sql/query.py": [
          "\nfunction: Query.check_filterable\nfunction: Query.build_filter"
        ]
      },
      "patches": [
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..848d417 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1123,8 +1123,13 @@ class Query(BaseExpression):\n                     self.check_query_object_type(v, opts, field)\n \n     def check_filterable(self, expression):\n-        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\n+        Only check Django ORM expressions, not plain values that may\n+        coincidentally have a `filterable` attribute (e.g., model instances\n+        with a BooleanField named 'filterable').\n+        \"\"\"\n+        is_expression = hasattr(expression, 'resolve_expression') or hasattr(expression, 'get_source_expressions')\n+        if is_expression and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..55052d8 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1123,15 +1123,24 @@ class Query(BaseExpression):\n                     self.check_query_object_type(v, opts, field)\n \n     def check_filterable(self, expression):\n-        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n+        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\n+\n+        Only Django Expression objects should be considered here. Plain\n+        Python values (e.g., model instances, primitives) must not be\n+        inspected for a 'filterable' attribute to avoid accidental clashes\n+        with user-defined model fields named 'filterable'.\n+        \"\"\"\n+        is_expression = hasattr(expression, 'resolve_expression') or hasattr(expression, 'get_source_expressions')\n+        if not is_expression:\n+            return\n         if not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n             )\n-        if hasattr(expression, 'get_source_expressions'):\n-            for expr in expression.get_source_expressions():\n-                self.check_filterable(expr)\n+        # Recursively check source expressions\n+        for expr in getattr(expression, 'get_source_expressions', lambda: [])():\n+            self.check_filterable(expr)\n \n     def build_lookup(self, lookups, lhs, rhs):\n         \"\"\"\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..8f604e7 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,11 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only enforce the 'filterable' flag for Django SQL Expression objects.\n+        # Avoid treating arbitrary Python objects (e.g., model instances that\n+        # happen to have a 'filterable' attribute) as non-filterable.\n+        is_expression = hasattr(expression, 'resolve_expression') or hasattr(expression, 'get_source_expressions')\n+        if is_expression and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..a01b031 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1123,8 +1123,19 @@ class Query(BaseExpression):\n                     self.check_query_object_type(v, opts, field)\n \n     def check_filterable(self, expression):\n-        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        \"\"\"\n+        Raise an error if a Django Expression cannot be used in a WHERE clause.\n+\n+        Avoid treating arbitrary Python objects that happen to define a\n+        'filterable' attribute (e.g., model instances with a BooleanField named\n+        'filterable') as expressions.\n+        \"\"\"\n+        # Only inspect Django Expression-like objects. Non-expression values\n+        # (e.g., plain Python values or model instances) should not be subject\n+        # to the 'filterable' check.\n+        if not hasattr(expression, 'resolve_expression'):\n+            return\n+        if getattr(expression, 'filterable', True) is False:\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..9152b48 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,11 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only consider the 'filterable' attribute for Django expression objects.\n+        # Avoid interpreting model instances or plain values that happen to have\n+        # a field or attribute named 'filterable'.\n+        is_expression = hasattr(expression, 'resolve_expression') or hasattr(expression, 'get_source_expressions')\n+        if is_expression and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..d824e4f 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,10 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only respect the 'filterable' flag defined on the expression class.\n+        # This avoids conflicts with user-defined instance attributes (e.g.,\n+        # model fields named 'filterable') that aren't part of the expression API.\n+        if not getattr(type(expression), 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..fbd180c 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,11 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only inspect the 'filterable' flag on Django expressions/lookup objects.\n+        # Avoid misinterpreting plain values (e.g., model instances with a\n+        # field named 'filterable') as non-filterable expressions.\n+        is_expression = hasattr(expression, 'get_source_expressions') or hasattr(expression, 'resolve_expression')\n+        if is_expression and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..a9d78f6 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,11 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only consider the 'filterable' flag defined on expression classes.\n+        # Avoid mistakenly treating arbitrary objects (e.g., model instances\n+        # with a field named 'filterable') as non-filterable.\n+        filterable_attr = getattr(type(expression), 'filterable', getattr(expression, 'filterable', True))\n+        if not filterable_attr:\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..69b3720 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,6 +1124,11 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n+        # Only consider \"filterable\" attribute on Django expression objects to\n+        # avoid collisions with user-defined attributes on arbitrary values\n+        # (e.g., model instances having a field named \"filterable\").\n+        if not (hasattr(expression, 'get_source_expressions') or hasattr(expression, 'resolve_expression')):\n+            return\n         if not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..b254c05 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,6 +1124,11 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n+        # Only enforce filterability for Django expression objects. Plain values\n+        # (e.g., model instances) may define a \"filterable\" attribute that is\n+        # unrelated to query construction and must be ignored.\n+        if not (hasattr(expression, 'resolve_expression') or hasattr(expression, 'get_source_expressions')):\n+            return\n         if not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n"
      ]
    },
    {
      "sample_index": 2,
      "edit_locs": {
        "django/db/models/sql/query.py": [
          "\nfunction: Query.check_filterable\nline: 1127\nline: 1133"
        ]
      },
      "patches": [
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..4c4c26b 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,15 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only consider the \"filterable\" flag for Django expression objects.\n+        # Avoid inspecting arbitrary Python/ORM objects which may have a\n+        # 'filterable' attribute unrelated to query expressions (e.g., model fields).\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..be450c2 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,11 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only Django expression nodes can define \"filterable\". Avoid treating\n+        # arbitrary RHS values (e.g., model instances with a field named\n+        # \"filterable\") as disallowed in the filter clause.\n+        from django.db.models.expressions import Expression\n+        if isinstance(expression, Expression) and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..8a0da23 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,14 +1124,18 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n-        if hasattr(expression, 'get_source_expressions'):\n-            for expr in expression.get_source_expressions():\n-                self.check_filterable(expr)\n+        # Only check Django expression nodes for the \"filterable\" flag.\n+        # User-defined objects (e.g., model instances) may have a field named\n+        # \"filterable\" which is unrelated and should not trigger this check.\n+        if hasattr(expression, 'resolve_expression'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n+            if hasattr(expression, 'get_source_expressions'):\n+                for expr in expression.get_source_expressions():\n+                    self.check_filterable(expr)\n \n     def build_lookup(self, lookups, lhs, rhs):\n         \"\"\"\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..d30f286 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,12 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..cafc4f4 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,11 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only check the \"filterable\" flag for ORM expression objects. Avoid\n+        # inspecting arbitrary Python values (e.g., model instances) that may\n+        # have a \"filterable\" attribute unrelated to the expression API.\n+        is_expression = hasattr(expression, 'resolve_expression') or hasattr(expression, 'get_source_expressions')\n+        if is_expression and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..0cf27b7 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,15 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only check \"filterable\" on Django expression objects. Model instances\n+        # or plain values may legitimately have an attribute named \"filterable\"\n+        # (e.g. a BooleanField) which should not affect query filtering.\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..b043e13 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,7 +1124,10 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only honor the 'filterable' flag for ORM expression objects to avoid\n+        # collisions with user-defined attributes (e.g., model fields) named\n+        # 'filterable' on plain values or instances.\n+        if hasattr(expression, 'get_source_expressions') and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..419eb3c 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,16 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only check filterability for expression-like objects. Plain values\n+        # or model instances may have a 'filterable' attribute unrelated to\n+        # Django's expression API (e.g., a model BooleanField named 'filterable'),\n+        # and should not trigger this check.\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..14ffd34 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,14 +1124,17 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n-        if hasattr(expression, 'get_source_expressions'):\n-            for expr in expression.get_source_expressions():\n-                self.check_filterable(expr)\n+        # Only check the special 'filterable' flag on Django expressions to avoid\n+        # collisions with user-defined attributes (e.g., model fields named 'filterable').\n+        if hasattr(expression, 'resolve_expression'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n+            if hasattr(expression, 'get_source_expressions'):\n+                for expr in expression.get_source_expressions():\n+                    self.check_filterable(expr)\n \n     def build_lookup(self, lookups, lhs, rhs):\n         \"\"\"\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..05d6985 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1123,15 +1123,22 @@ class Query(BaseExpression):\n                     self.check_query_object_type(v, opts, field)\n \n     def check_filterable(self, expression):\n-        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n-        if hasattr(expression, 'get_source_expressions'):\n-            for expr in expression.get_source_expressions():\n-                self.check_filterable(expr)\n+        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\n+\n+        Only Django Expression instances should be subject to the `filterable`\n+        check to avoid clashes with user-defined attributes on plain Python\n+        objects (e.g., model instances with a `filterable` field).\n+        \"\"\"\n+        # Only perform filterable checks on Django expressions.\n+        if hasattr(expression, 'resolve_expression'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n+            if hasattr(expression, 'get_source_expressions'):\n+                for expr in expression.get_source_expressions():\n+                    self.check_filterable(expr)\n \n     def build_lookup(self, lookups, lhs, rhs):\n         \"\"\"\n"
      ]
    },
    {
      "sample_index": 3,
      "edit_locs": {
        "django/db/models/sql/query.py": [
          "\nfunction: Query.check_filterable\nline: 1127\nline: 1268\nline: 1269\nline: 1270"
        ]
      },
      "patches": [
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..62f0933 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,17 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n-        if hasattr(expression, 'get_source_expressions'):\n+        # Only Django expression objects should be considered for \"filterable\".\n+        # This avoids collisions with user-defined attributes named \"filterable\"\n+        # on arbitrary objects (e.g., model instances with a BooleanField named\n+        # 'filterable').\n+        from django.db.models.expressions import BaseExpression\n+        if isinstance(expression, BaseExpression):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..67d9a1b 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,15 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n+        # Only consider Django query expressions for filterability to avoid\n+        # collisions with user model attributes named \"filterable\".\n+        from django.db.models.expressions import Expression\n+        if isinstance(expression, Expression) and not getattr(expression, 'filterable', True):\n             raise NotSupportedError(\n                 expression.__class__.__name__ + ' is disallowed in the filter '\n                 'clause.'\n             )\n-        if hasattr(expression, 'get_source_expressions'):\n+        if isinstance(expression, Expression) and hasattr(expression, 'get_source_expressions'):\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..61a43ab 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,15 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only consider 'filterable' for Django SQL expressions. Plain Python\n+        # values (e.g., model instances) may have a 'filterable' attribute and\n+        # should not be treated as SQL expressions.\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..6e65c67 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,16 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only enforce the 'filterable' flag on SQL expression objects. Avoid\n+        # interpreting arbitrary Python objects (e.g., model instances with a\n+        # BooleanField named 'filterable') as non-filterable expressions.\n         if hasattr(expression, 'get_source_expressions'):\n+            # Expressions can declare themselves as non-filterable.\n+            if getattr(expression, 'filterable', True) is False:\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..2d6bcd5 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1123,15 +1123,22 @@ class Query(BaseExpression):\n                     self.check_query_object_type(v, opts, field)\n \n     def check_filterable(self, expression):\n-        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n-        if hasattr(expression, 'get_source_expressions'):\n-            for expr in expression.get_source_expressions():\n-                self.check_filterable(expr)\n+        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\n+\n+        Only expression objects participate in this check. Plain values, model\n+        instances, etc., should not be inspected for a 'filterable' attribute\n+        to avoid collisions with user-defined model fields named 'filterable'.\n+        \"\"\"\n+        from django.db.models.expressions import Expression\n+        if isinstance(expression, Expression):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n+            if hasattr(expression, 'get_source_expressions'):\n+                for expr in expression.get_source_expressions():\n+                    self.check_filterable(expr)\n \n     def build_lookup(self, lookups, lhs, rhs):\n         \"\"\"\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..9b9b673 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,13 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only check the filterable flag for Django expression objects.\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..ce90ee4 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,13 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only evaluate 'filterable' on SQL expressions; ignore plain Python values.\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..11b42d3 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,14 +1124,19 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n-        if hasattr(expression, 'get_source_expressions'):\n-            for expr in expression.get_source_expressions():\n-                self.check_filterable(expr)\n+        # Only expressions (objects participating in expression resolution)\n+        # should be checked for the \"filterable\" attribute. Plain Python\n+        # values (e.g., model instances that happen to have a 'filterable'\n+        # field) must not trigger this check.\n+        if hasattr(expression, 'resolve_expression'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n+            if hasattr(expression, 'get_source_expressions'):\n+                for expr in expression.get_source_expressions():\n+                    self.check_filterable(expr)\n \n     def build_lookup(self, lookups, lhs, rhs):\n         \"\"\"\n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..f3d7cbb 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,15 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only consider 'filterable' for Django expressions to avoid conflicts\n+        # with user-defined attributes on non-expression objects (e.g., model\n+        # instances that have a field named 'filterable').\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
        "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..7e937bd 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1123,13 +1123,20 @@ class Query(BaseExpression):\n                     self.check_query_object_type(v, opts, field)\n \n     def check_filterable(self, expression):\n-        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        \"\"\"Raise an error if expression cannot be used in a WHERE clause.\n+\n+        Only check the 'filterable' flag for actual query Expressions. Avoid\n+        inspecting plain Python values or model instances that may define a\n+        'filterable' attribute unrelated to expression filtering.\n+        \"\"\"\n+        # Only expressions (objects participating in the query AST) should be\n+        # validated for filterability. Skip non-expression values.\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/django/db/models/sql/query.py b/django/db/models/sql/query.py\nindex a6a3e97..7db1c1f 100644\n--- a/django/db/models/sql/query.py\n+++ b/django/db/models/sql/query.py\n@@ -1124,12 +1124,15 @@ class Query(BaseExpression):\n \n     def check_filterable(self, expression):\n         \"\"\"Raise an error if expression cannot be used in a WHERE clause.\"\"\"\n-        if not getattr(expression, 'filterable', True):\n-            raise NotSupportedError(\n-                expression.__class__.__name__ + ' is disallowed in the filter '\n-                'clause.'\n-            )\n+        # Only enforce the \"filterable\" flag on Django expression objects to\n+        # avoid conflicts with arbitrary RHS values (e.g., model instances)\n+        # that happen to define a \"filterable\" attribute.\n         if hasattr(expression, 'get_source_expressions'):\n+            if not getattr(expression, 'filterable', True):\n+                raise NotSupportedError(\n+                    expression.__class__.__name__ + ' is disallowed in the filter '\n+                    'clause.'\n+                )\n             for expr in expression.get_source_expressions():\n                 self.check_filterable(expr)\n \n",
  "7_resolved": true
}