{
  "instance_id": "SWE-Bench-Verified__python__maintenance__bugfix__8d1c297a",
  "original_id": "sympy__sympy-13647",
  "1_model_selected_files": [
    "sympy/matrices/matrices.py",
    "sympy/matrices/common.py",
    "sympy/matrices/dense.py",
    "sympy/matrices/densetools.py",
    "sympy/matrices/immutable.py"
  ],
  "2_embedding_selected_files": [
    "sympy/matrices/common.py",
    "sympy/matrices/sparse.py",
    "sympy/matrices/dense.py",
    "sympy/matrices/benchmarks/bench_matrix.py",
    "sympy/matrices/matrices.py",
    "sympy/matrices/expressions/matmul.py",
    "sympy/matrices/immutable.py",
    "sympy/matrices/__init__.py",
    "sympy/matrices/expressions/blockmatrix.py",
    "sympy/matrices/benchmarks/__init__.py",
    "sympy/matrices/expressions/matexpr.py",
    "sympy/matrices/normalforms.py",
    "sympy/matrices/densetools.py",
    "sympy/matrices/expressions/diagonal.py",
    "sympy/matrices/densesolve.py",
    "sympy/matrices/expressions/slice.py",
    "sympy/matrices/densearith.py",
    "sympy/matrices/expressions/funcmatrix.py",
    "sympy/matrices/expressions/trace.py",
    "sympy/matrices/expressions/transpose.py",
    "sympy/matrices/expressions/__init__.py",
    "sympy/matrices/expressions/determinant.py",
    "sympy/matrices/expressions/matpow.py",
    "sympy/matrices/expressions/matadd.py",
    "sympy/matrices/expressions/inverse.py",
    "sympy/matrices/expressions/factorizations.py",
    "sympy/matrices/expressions/hadamard.py",
    "sympy/matrices/expressions/dotproduct.py",
    "sympy/this.py",
    "sympy/__init__.py",
    "sympy/galgebra.py",
    "sympy/matrices/sparsetools.py",
    "sympy/release.py",
    "sympy/matrices/expressions/adjoint.py",
    "sympy/setup.py",
    "sympy/matrices/expressions/fourier.py",
    "sympy/abc.py",
    "sympy/isympy.py",
    "sympy/conftest.py",
    "sympy/setupegg.py",
    ".ci/parse_durations_log.py"
  ],
  "3_final_combined_files": [
    "sympy/matrices/common.py",
    "sympy/matrices/dense.py",
    "sympy/matrices/matrices.py",
    "sympy/matrices/sparse.py"
  ],
  "4_related_elements": {
    "sympy/matrices/common.py": [
      "function: MatrixShaping._eval_col_insert\nfunction: MatrixShaping.col_insert\nfunction: MatrixShaping._eval_col_join\nfunction: MatrixShaping.col_join\nfunction: MatrixShaping.hstack\nfunction: MatrixShaping._eval_extract\nfunction: _matrixify\nfunction: a2idx\nfunction: classof"
    ],
    "sympy/matrices/dense.py": [
      "function: DenseMatrix._eval_extract\nfunction: DenseMatrix.__getitem__\nfunction: DenseMatrix.__setitem__\nfunction: MutableDenseMatrix.copyin_matrix\nfunction: MutableDenseMatrix.copyin_list\nfunction: MutableDenseMatrix.col_del\nfunction: MutableDenseMatrix.row_del"
    ],
    "sympy/matrices/matrices.py": [
      "function: MatrixBase.key2ij\nfunction: MatrixBase.key2bounds\nfunction: classof\nfunction: a2idx"
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "sympy/matrices/common.py": [
          "\nfunction: MatrixShaping._eval_col_insert\nline: 89"
        ]
      },
      "patches": [
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..50ad66a 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -79,14 +79,12 @@ class MatrixShaping(MatrixRequired):\n         return self._new(self.rows, self.cols - 1, entry)\n \n     def _eval_col_insert(self, pos, other):\n-        cols = self.cols\n-\n         def entry(i, j):\n             if j < pos:\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..62a9b9e 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,9 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns to the right of the insertion point, shift by the\n+            # number of inserted columns only.\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5a1f0ea 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,8 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns to the right of the inserted block, shift by the number of inserted columns\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..67bdd23 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,8 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns to the right of the insertion, shift by the width of the inserted block\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..a38347a 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -84,9 +84,10 @@ class MatrixShaping(MatrixRequired):\n         def entry(i, j):\n             if j < pos:\n                 return self[i, j]\n-            elif pos <= j < pos + other.cols:\n+            elif j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # Columns to the right of the inserted block are shifted by other.cols\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..8d189d2 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,8 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns to the right of the insertion, shift by the width of `other`\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..d4e676d 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -79,17 +79,15 @@ class MatrixShaping(MatrixRequired):\n         return self._new(self.rows, self.cols - 1, entry)\n \n     def _eval_col_insert(self, pos, other):\n-        cols = self.cols\n \n         def entry(i, j):\n             if j < pos:\n                 return self[i, j]\n-            elif pos <= j < pos + other.cols:\n+            elif j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n-        return self._new(self.rows, self.cols + other.cols,\n-                         lambda i, j: entry(i, j))\n+        return self._new(self.rows, self.cols + other.cols, entry)\n \n     def _eval_col_join(self, other):\n         rows = self.rows\n",
        ""
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "sympy/matrices/common.py": [
          "\nfunction: MatrixShaping._eval_col_insert\nline: 89"
        ]
      },
      "patches": [
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..25871fb 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,9 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns to the right of the insertion point,\n+            # shift by the number of inserted columns only.\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..1f5c805 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,8 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns to the right of the inserted block, shift by other.cols only\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..f125ada 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -79,17 +79,14 @@ class MatrixShaping(MatrixRequired):\n         return self._new(self.rows, self.cols - 1, entry)\n \n     def _eval_col_insert(self, pos, other):\n-        cols = self.cols\n-\n         def entry(i, j):\n             if j < pos:\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n-        return self._new(self.rows, self.cols + other.cols,\n-                         lambda i, j: entry(i, j))\n+        return self._new(self.rows, self.cols + other.cols, entry)\n \n     def _eval_col_join(self, other):\n         rows = self.rows\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..23e3614 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -79,17 +79,15 @@ class MatrixShaping(MatrixRequired):\n         return self._new(self.rows, self.cols - 1, entry)\n \n     def _eval_col_insert(self, pos, other):\n-        cols = self.cols\n-\n         def entry(i, j):\n             if j < pos:\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns after the insertion point, shift by the number of inserted columns\n+            return self[i, j - other.cols]\n \n-        return self._new(self.rows, self.cols + other.cols,\n-                         lambda i, j: entry(i, j))\n+        return self._new(self.rows, self.cols + other.cols, entry)\n \n     def _eval_col_join(self, other):\n         rows = self.rows\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n"
      ]
    },
    {
      "sample_index": 2,
      "edit_locs": {
        "sympy/matrices/common.py": [
          "\nfunction: MatrixShaping._eval_col_insert\nline: 89"
        ]
      },
      "patches": [
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..db4b56c 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,9 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns to the right of the inserted block, shift only by the\n+            # number of inserted columns.\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..579c7b7 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,8 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns after the inserted block, shift by other.cols only\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..672c2b6 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,9 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns to the right of the insertion point, shift back by\n+            # the number of inserted columns to map to the original matrix.\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..579c7b7 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,8 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns after the inserted block, shift by other.cols only\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n"
      ]
    },
    {
      "sample_index": 3,
      "edit_locs": {
        "sympy/matrices/common.py": [
          "\nfunction: MatrixShaping._eval_col_insert\nline: 89"
        ]
      },
      "patches": [
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..fcdb8a5 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,8 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns to the right of the insertion, shift by the number of inserted columns\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..008ef59 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,8 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns after the inserted block, shift by the number of inserted columns\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5885db1 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -79,14 +79,13 @@ class MatrixShaping(MatrixRequired):\n         return self._new(self.rows, self.cols - 1, entry)\n \n     def _eval_col_insert(self, pos, other):\n-        cols = self.cols\n \n         def entry(i, j):\n             if j < pos:\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..f125ada 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -79,17 +79,14 @@ class MatrixShaping(MatrixRequired):\n         return self._new(self.rows, self.cols - 1, entry)\n \n     def _eval_col_insert(self, pos, other):\n-        cols = self.cols\n-\n         def entry(i, j):\n             if j < pos:\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n-        return self._new(self.rows, self.cols + other.cols,\n-                         lambda i, j: entry(i, j))\n+        return self._new(self.rows, self.cols + other.cols, entry)\n \n     def _eval_col_join(self, other):\n         rows = self.rows\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..90de0b6 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -79,17 +79,15 @@ class MatrixShaping(MatrixRequired):\n         return self._new(self.rows, self.cols - 1, entry)\n \n     def _eval_col_insert(self, pos, other):\n-        cols = self.cols\n-\n         def entry(i, j):\n             if j < pos:\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            # For columns to the right of the inserted block, shift by other.cols\n+            return self[i, j - other.cols]\n \n-        return self._new(self.rows, self.cols + other.cols,\n-                         lambda i, j: entry(i, j))\n+        return self._new(self.rows, self.cols + other.cols, entry)\n \n     def _eval_col_join(self, other):\n         rows = self.rows\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
        "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/sympy/matrices/common.py b/sympy/matrices/common.py\nindex fb4452b..5bfb0dd 100644\n--- a/sympy/matrices/common.py\n+++ b/sympy/matrices/common.py\n@@ -86,7 +86,7 @@ class MatrixShaping(MatrixRequired):\n                 return self[i, j]\n             elif pos <= j < pos + other.cols:\n                 return other[i, j - pos]\n-            return self[i, j - pos - other.cols]\n+            return self[i, j - other.cols]\n \n         return self._new(self.rows, self.cols + other.cols,\n                          lambda i, j: entry(i, j))\n",
  "7_resolved": true
}