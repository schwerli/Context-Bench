{
  "instance_id": "SWE-Bench-Verified__python__maintenance__bugfix__34e61891",
  "original_id": "matplotlib__matplotlib-20826",
  "1_model_selected_files": [
    "lib/matplotlib/axes/_base.py",
    "lib/matplotlib/axis.py",
    "lib/matplotlib/axes/_subplots.py",
    "lib/matplotlib/figure.py",
    "lib/matplotlib/pyplot.py"
  ],
  "2_embedding_selected_files": [
    "lib/matplotlib/pyplot.py",
    "lib/matplotlib/axes/_base.py",
    "lib/matplotlib/axis.py",
    "lib/matplotlib/ticker.py",
    "lib/matplotlib/figure.py",
    "lib/matplotlib/rcsetup.py",
    "lib/matplotlib/axes/_subplots.py",
    "lib/matplotlib/axes/_axes.py",
    "lib/matplotlib/axes/__init__.py",
    "lib/matplotlib/patches.py",
    "lib/matplotlib/colorbar.py",
    "lib/matplotlib/backend_bases.py",
    "lib/matplotlib/_constrained_layout.py",
    "lib/matplotlib/_layoutgrid.py",
    "lib/matplotlib/collections.py",
    "lib/matplotlib/axes/_secondary_axes.py",
    "lib/matplotlib/pylab.py",
    "lib/matplotlib/backend_tools.py",
    "lib/matplotlib/_pylab_helpers.py",
    "lib/matplotlib/artist.py",
    "lib/matplotlib/_cm_listed.py",
    "lib/matplotlib/widgets.py",
    "lib/matplotlib/contour.py",
    "lib/matplotlib/_cm.py",
    "lib/matplotlib/dates.py",
    "lib/matplotlib/patheffects.py",
    "lib/matplotlib/markers.py",
    "lib/matplotlib/__init__.py"
  ],
  "3_final_combined_files": [
    "lib/matplotlib/axes/_base.py",
    "lib/matplotlib/axis.py",
    "lib/matplotlib/axes/_subplots.py",
    "lib/matplotlib/pyplot.py"
  ],
  "4_related_elements": {
    "lib/matplotlib/axes/_base.py": [
      "function: _AxesBase.clear\nfunction: _AxesBase.cla\nfunction: _AxesBase.sharex\nfunction: _AxesBase.sharey\nfunction: _AxesBase.get_shared_x_axes\nfunction: _AxesBase.get_shared_y_axes\nvariable: _AxesBase._shared_axes\nvariable: _AxesBase._twinned_axes"
    ],
    "lib/matplotlib/axis.py": [
      "class: Axis\nfunction: Axis.clear\nfunction: Axis.reset_ticks\nfunction: Axis.set_tick_params\nfunction: Axis._reset_major_tick_kw\nfunction: Axis._reset_minor_tick_kw\nfunction: Axis._update_ticks\nclass: XAxis\nfunction: XAxis.set_ticks_position\nfunction: XAxis.tick_top\nfunction: XAxis.tick_bottom\nclass: YAxis\nfunction: YAxis.set_ticks_position\nfunction: YAxis.tick_right\nfunction: YAxis.tick_left\nclass: Tick"
    ],
    "lib/matplotlib/axes/_subplots.py": [
      "class: SubplotBase\nfunction: SubplotBase.label_outer\nfunction: SubplotBase._label_outer_xaxis\nfunction: SubplotBase._label_outer_yaxis"
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "lib/matplotlib/axes/_base.py": [
          "\nfunction: _AxesBase.cla\nline: 1303\nline: 1304\nline: 1305\nline: 1306\nline: 1307\nline: 1308\nline: 1309\nline: 1310"
        ],
        "lib/matplotlib/axis.py": [
          "\nfunction: Axis._reset_major_tick_kw\nfunction: Axis._reset_minor_tick_kw"
        ]
      },
      "patches": [
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..184b073 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,12 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # Preserve current tick parameters to maintain shared-axis label/tick visibility.\n+        _x_major = dict(getattr(self.xaxis, \"_major_tick_kw\", {}))\n+        _x_minor = dict(getattr(self.xaxis, \"_minor_tick_kw\", {}))\n+        _y_major = dict(getattr(self.yaxis, \"_major_tick_kw\", {}))\n+        _y_minor = dict(getattr(self.yaxis, \"_minor_tick_kw\", {}))\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1302,6 +1308,23 @@ class _AxesBase(martist.Artist):\n \n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n+\n+        # Restore tick parameters saved before clearing to respect shared-axis\n+        # hidden tick labels and tick positions (e.g., no top/right ticks).\n+        try:\n+            if _x_major:\n+                self.xaxis.set_tick_params(which='major', **_x_major)\n+            if _x_minor:\n+                self.xaxis.set_tick_params(which='minor', **_x_minor)\n+            if _y_major:\n+                self.yaxis.set_tick_params(which='major', **_y_major)\n+            if _y_minor:\n+                self.yaxis.set_tick_params(which='minor', **_y_minor)\n+        except Exception:\n+            # Be defensive: if any axis is missing or doesn't support a key,\n+            # ignore and continue.\n+            pass\n+\n         if self._sharex is not None:\n             self.xaxis.set_visible(xaxis_visible)\n             self.patch.set_visible(patch_visible)\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..99a922c 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,14 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # Stash tick parameter state so we can restore it after clearing.\n+        # This preserves shared-axis hiding of inner tick labels and any\n+        # user-specified tick visibility settings.\n+        x_major_tick_kw = dict(self.xaxis._major_tick_kw)\n+        x_minor_tick_kw = dict(self.xaxis._minor_tick_kw)\n+        y_major_tick_kw = dict(self.yaxis._major_tick_kw)\n+        y_minor_tick_kw = dict(self.yaxis._minor_tick_kw)\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1309,6 +1317,32 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Apply rcParams-based default tick visibility (e.g., disable top/right ticks)\n+        # axis.clear() resets tick on/off state; honor rcParams after clearing.\n+        self.xaxis.set_tick_params(\n+            which='both',\n+            top=mpl.rcParams['xtick.top'],\n+            bottom=mpl.rcParams['xtick.bottom'],\n+            labeltop=mpl.rcParams['xtick.labeltop'],\n+            labelbottom=mpl.rcParams['xtick.labelbottom'])\n+        self.yaxis.set_tick_params(\n+            which='both',\n+            left=mpl.rcParams['ytick.left'],\n+            right=mpl.rcParams['ytick.right'],\n+            labelleft=mpl.rcParams['ytick.labelleft'],\n+            labelright=mpl.rcParams['ytick.labelright'])\n+\n+        # Restore any axis-specific tick parameter settings that existed before clear(),\n+        # e.g., those applied by shared axes to hide inner tick labels.\n+        if x_major_tick_kw:\n+            self.xaxis.set_tick_params(which='major', **x_major_tick_kw)\n+        if x_minor_tick_kw:\n+            self.xaxis.set_tick_params(which='minor', **x_minor_tick_kw)\n+        if y_major_tick_kw:\n+            self.yaxis.set_tick_params(which='major', **y_major_tick_kw)\n+        if y_minor_tick_kw:\n+            self.yaxis.set_tick_params(which='minor', **y_minor_tick_kw)\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..c40e4e1 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1302,12 +1302,39 @@ class _AxesBase(martist.Artist):\n \n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n+\n+        # Restore axis/patch visibility from saved state.\n         if self._sharex is not None:\n             self.xaxis.set_visible(xaxis_visible)\n-            self.patch.set_visible(patch_visible)\n         if self._sharey is not None:\n             self.yaxis.set_visible(yaxis_visible)\n-            self.patch.set_visible(patch_visible)\n+        self.patch.set_visible(patch_visible)\n+\n+        # Ensure tick side visibility respects rcParams after clearing.\n+        # Axis.clear resets tick placement to both sides; explicitly\n+        # restore according to rcParams.\n+        self.tick_params(\n+            axis='x',\n+            top=mpl.rcParams['xtick.top'],\n+            bottom=mpl.rcParams['xtick.bottom'],\n+            labeltop=mpl.rcParams['xtick.labeltop'],\n+            labelbottom=mpl.rcParams['xtick.labelbottom']\n+        )\n+        self.tick_params(\n+            axis='y',\n+            right=mpl.rcParams['ytick.right'],\n+            left=mpl.rcParams['ytick.left'],\n+            labelright=mpl.rcParams['ytick.labelright'],\n+            labelleft=mpl.rcParams['ytick.labelleft']\n+        )\n+\n+        # For shared axes, re-apply outer label hiding to match expectations.\n+        if self._sharex is not None or self._sharey is not None:\n+            try:\n+                self.label_outer()\n+            except Exception:\n+                # If label_outer is unavailable, silently ignore.\n+                pass\n \n         self.stale = True\n \n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..c287295 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1191,6 +1191,9 @@ class _AxesBase(martist.Artist):\n \n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n+        # Preserve tick positions to avoid enabling top/right ticks on clear.\n+        x_ticks_pos = self.xaxis.get_ticks_position()\n+        y_ticks_pos = self.yaxis.get_ticks_position()\n \n         self.xaxis.clear()\n         self.yaxis.clear()\n@@ -1219,9 +1222,10 @@ class _AxesBase(martist.Artist):\n                 pass\n \n         # update the minor locator for x and y axis based on rcParams\n-        if mpl.rcParams['xtick.minor.visible']:\n+        # For shared axes, keep the locator/formatter identical to the shared axis.\n+        if self._sharex is None and mpl.rcParams['xtick.minor.visible']:\n             self.xaxis.set_minor_locator(mticker.AutoMinorLocator())\n-        if mpl.rcParams['ytick.minor.visible']:\n+        if self._sharey is None and mpl.rcParams['ytick.minor.visible']:\n             self.yaxis.set_minor_locator(mticker.AutoMinorLocator())\n \n         if self._sharex is None:\n@@ -1300,14 +1304,22 @@ class _AxesBase(martist.Artist):\n         self.xaxis.set_clip_path(self.patch)\n         self.yaxis.set_clip_path(self.patch)\n \n+        # Restore previous tick positions (e.g., top/right tick visibility).\n+        try:\n+            self.xaxis.set_ticks_position(x_ticks_pos)\n+        except Exception:\n+            pass\n+        try:\n+            self.yaxis.set_ticks_position(y_ticks_pos)\n+        except Exception:\n+            pass\n+\n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n-        if self._sharex is not None:\n-            self.xaxis.set_visible(xaxis_visible)\n-            self.patch.set_visible(patch_visible)\n-        if self._sharey is not None:\n-            self.yaxis.set_visible(yaxis_visible)\n-            self.patch.set_visible(patch_visible)\n+        # Restore patch visibility after clearing.\n+        self.patch.set_visible(patch_visible)\n+        # Do not force axis visibility for shared axes here; the shared-axis\n+        # machinery will manage tick/label visibility on draw.\n \n         self.stale = True\n \n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..8e595ab 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1224,6 +1224,13 @@ class _AxesBase(martist.Artist):\n         if mpl.rcParams['ytick.minor.visible']:\n             self.yaxis.set_minor_locator(mticker.AutoMinorLocator())\n \n+        # Ensure tick side visibility honors rcParams defaults. Clearing the\n+        # axes can re-enable ticks on all sides; reset according to rcParams.\n+        self.tick_params(top=mpl.rcParams.get('xtick.top', False),\n+                         bottom=mpl.rcParams.get('xtick.bottom', True),\n+                         left=mpl.rcParams.get('ytick.left', True),\n+                         right=mpl.rcParams.get('ytick.right', False))\n+\n         if self._sharex is None:\n             self._autoscaleXon = True\n         if self._sharey is None:\n@@ -1302,12 +1309,23 @@ class _AxesBase(martist.Artist):\n \n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n-        if self._sharex is not None:\n+\n+        # Restore patch visibility regardless of sharing.\n+        self.patch.set_visible(patch_visible)\n+\n+        # Restore axis visibility for non-shared axes only. For shared axes,\n+        # defer to the shared-axes machinery to keep interior tick labels hidden.\n+        if self._sharex is None:\n             self.xaxis.set_visible(xaxis_visible)\n-            self.patch.set_visible(patch_visible)\n-        if self._sharey is not None:\n+        if self._sharey is None:\n             self.yaxis.set_visible(yaxis_visible)\n-            self.patch.set_visible(patch_visible)\n+\n+        # If axes are shared, apply outer-label hiding so interior axes stay hidden.\n+        if self._sharex is not None or self._sharey is not None:\n+            try:\n+                self.label_outer()\n+            except Exception:\n+                pass\n \n         self.stale = True\n \n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..8fd1ec4 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,13 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # Preserve tick parameter state to restore after clearing. This includes\n+        # which sides/labels are active, so shared-axis labels remain hidden.\n+        _xmaj_tick_kw = getattr(self.xaxis, '_major_tick_kw', {}).copy()\n+        _xmin_tick_kw = getattr(self.xaxis, '_minor_tick_kw', {}).copy()\n+        _ymaj_tick_kw = getattr(self.yaxis, '_major_tick_kw', {}).copy()\n+        _ymin_tick_kw = getattr(self.yaxis, '_minor_tick_kw', {}).copy()\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1219,9 +1226,10 @@ class _AxesBase(martist.Artist):\n                 pass\n \n         # update the minor locator for x and y axis based on rcParams\n-        if mpl.rcParams['xtick.minor.visible']:\n+        # Do not override minor locator on shared axes; rely on the shared axis.\n+        if mpl.rcParams['xtick.minor.visible'] and self._sharex is None:\n             self.xaxis.set_minor_locator(mticker.AutoMinorLocator())\n-        if mpl.rcParams['ytick.minor.visible']:\n+        if mpl.rcParams['ytick.minor.visible'] and self._sharey is None:\n             self.yaxis.set_minor_locator(mticker.AutoMinorLocator())\n \n         if self._sharex is None:\n@@ -1309,6 +1317,18 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Restore tick parameter state saved before clearing to avoid\n+        # un-hiding tick labels or changing tick sides on shared axes.\n+        # These dictionaries are used when new ticks are created.\n+        if _xmaj_tick_kw:\n+            self.xaxis._major_tick_kw.update(_xmaj_tick_kw)\n+        if _xmin_tick_kw:\n+            self.xaxis._minor_tick_kw.update(_xmin_tick_kw)\n+        if _ymaj_tick_kw:\n+            self.yaxis._major_tick_kw.update(_ymaj_tick_kw)\n+        if _ymin_tick_kw:\n+            self.yaxis._minor_tick_kw.update(_ymin_tick_kw)\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..d5299bf 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,31 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # Save current tick and ticklabel visibility to restore after clearing.\n+        # This preserves shared-axis hidden labels and default top/right tick state.\n+        try:\n+            xmaj = self.xaxis.get_major_ticks()\n+            x_labelbottom = any(tick.label1.get_visible() for tick in xmaj)\n+            x_labeltop = any(tick.label2.get_visible() for tick in xmaj)\n+            x_tick_bottom = any(tick.tick1line.get_visible() for tick in xmaj)\n+            x_tick_top = any(tick.tick2line.get_visible() for tick in xmaj)\n+        except Exception:\n+            x_labelbottom = mpl.rcParams['xtick.labelbottom']\n+            x_labeltop = mpl.rcParams['xtick.labeltop']\n+            x_tick_bottom = mpl.rcParams['xtick.bottom']\n+            x_tick_top = mpl.rcParams['xtick.top']\n+        try:\n+            ymaj = self.yaxis.get_major_ticks()\n+            y_labelleft = any(tick.label1.get_visible() for tick in ymaj)\n+            y_labelright = any(tick.label2.get_visible() for tick in ymaj)\n+            y_tick_left = any(tick.tick1line.get_visible() for tick in ymaj)\n+            y_tick_right = any(tick.tick2line.get_visible() for tick in ymaj)\n+        except Exception:\n+            y_labelleft = mpl.rcParams['ytick.labelleft']\n+            y_labelright = mpl.rcParams['ytick.labelright']\n+            y_tick_left = mpl.rcParams['ytick.left']\n+            y_tick_right = mpl.rcParams['ytick.right']\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1309,6 +1334,13 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Restore tick and ticklabel visibility saved before clearing.\n+        # This keeps shared-axis label suppression and top/right tick defaults.\n+        self.tick_params(axis='x', bottom=x_tick_bottom, top=x_tick_top,\n+                         labelbottom=x_labelbottom, labeltop=x_labeltop)\n+        self.tick_params(axis='y', left=y_tick_left, right=y_tick_right,\n+                         labelleft=y_labelleft, labelright=y_labelright)\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..628bda6 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,30 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # Stash current tick/label side visibility to preserve across clear.\n+        try:\n+            _x_first_tick = self.xaxis.get_major_ticks()[0]\n+            _x_tick1On = _x_first_tick.tick1On\n+            _x_tick2On = _x_first_tick.tick2On\n+            _x_label1On = _x_first_tick.label1On\n+            _x_label2On = _x_first_tick.label2On\n+        except IndexError:\n+            _x_tick1On = mpl.rcParams['xtick.bottom']\n+            _x_tick2On = mpl.rcParams['xtick.top']\n+            _x_label1On = mpl.rcParams['xtick.labelbottom']\n+            _x_label2On = mpl.rcParams['xtick.labeltop']\n+        try:\n+            _y_first_tick = self.yaxis.get_major_ticks()[0]\n+            _y_tick1On = _y_first_tick.tick1On\n+            _y_tick2On = _y_first_tick.tick2On\n+            _y_label1On = _y_first_tick.label1On\n+            _y_label2On = _y_first_tick.label2On\n+        except IndexError:\n+            _y_tick1On = mpl.rcParams['ytick.left']\n+            _y_tick2On = mpl.rcParams['ytick.right']\n+            _y_label1On = mpl.rcParams['ytick.labelleft']\n+            _y_label2On = mpl.rcParams['ytick.labelright']\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1309,6 +1333,24 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Restore previously stashed tick/label side visibility to avoid\n+        # unintentionally enabling top/right ticks or unhiding shared-axis\n+        # tick labels after clear().\n+        try:\n+            self.xaxis.set_tick_params(\n+                which='both',\n+                bottom=_x_tick1On, top=_x_tick2On,\n+                labelbottom=_x_label1On, labeltop=_x_label2On)\n+        except Exception:\n+            pass\n+        try:\n+            self.yaxis.set_tick_params(\n+                which='both',\n+                left=_y_tick1On, right=_y_tick2On,\n+                labelleft=_y_label1On, labelright=_y_label2On)\n+        except Exception:\n+            pass\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..0e66bb7 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,30 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # Save current tick/label visibility to restore after clear.\n+        # This is important for shared axes, where non-leading axes\n+        # typically have some tick labels hidden.\n+        try:\n+            _xticks = self.xaxis.get_major_ticks()\n+            x_tick_params = {\n+                'top': any(t.tick2line.get_visible() for t in _xticks),\n+                'bottom': any(t.tick1line.get_visible() for t in _xticks),\n+                'labeltop': any(t.label2.get_visible() for t in _xticks),\n+                'labelbottom': any(t.label1.get_visible() for t in _xticks),\n+            }\n+        except Exception:\n+            x_tick_params = None\n+        try:\n+            _yticks = self.yaxis.get_major_ticks()\n+            y_tick_params = {\n+                'left': any(t.tick1line.get_visible() for t in _yticks),\n+                'right': any(t.tick2line.get_visible() for t in _yticks),\n+                'labelleft': any(t.label1.get_visible() for t in _yticks),\n+                'labelright': any(t.label2.get_visible() for t in _yticks),\n+            }\n+        except Exception:\n+            y_tick_params = None\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1300,6 +1324,25 @@ class _AxesBase(martist.Artist):\n         self.xaxis.set_clip_path(self.patch)\n         self.yaxis.set_clip_path(self.patch)\n \n+        # Restore previous tick/label visibility (important for shared axes).\n+        # If we could not capture previous settings, fall back to rcParams.\n+        if x_tick_params is None:\n+            x_tick_params = {\n+                'top': mpl.rcParams['xtick.top'],\n+                'bottom': mpl.rcParams['xtick.bottom'],\n+                'labeltop': mpl.rcParams['xtick.labeltop'],\n+                'labelbottom': mpl.rcParams['xtick.labelbottom'],\n+            }\n+        if y_tick_params is None:\n+            y_tick_params = {\n+                'left': mpl.rcParams['ytick.left'],\n+                'right': mpl.rcParams['ytick.right'],\n+                'labelleft': mpl.rcParams['ytick.labelleft'],\n+                'labelright': mpl.rcParams['ytick.labelright'],\n+            }\n+        self.tick_params(axis='x', which='both', **x_tick_params)\n+        self.tick_params(axis='y', which='both', **y_tick_params)\n+\n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n         if self._sharex is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..88cabdb 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1302,6 +1302,24 @@ class _AxesBase(martist.Artist):\n \n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n+\n+        # Reset tick placement and label visibility to rcParams defaults.\n+        # This avoids enabling top/right ticks by default after a clear().\n+        self.tick_params(\n+            axis='x', which='both',\n+            bottom=mpl.rcParams['xtick.bottom'],\n+            top=mpl.rcParams['xtick.top'],\n+            labelbottom=mpl.rcParams['xtick.labelbottom'],\n+            labeltop=mpl.rcParams['xtick.labeltop']\n+        )\n+        self.tick_params(\n+            axis='y', which='both',\n+            left=mpl.rcParams['ytick.left'],\n+            right=mpl.rcParams['ytick.right'],\n+            labelleft=mpl.rcParams['ytick.labelleft'],\n+            labelright=mpl.rcParams['ytick.labelright']\n+        )\n+\n         if self._sharex is not None:\n             self.xaxis.set_visible(xaxis_visible)\n             self.patch.set_visible(patch_visible)\n@@ -1309,6 +1327,13 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # For shared axes, re-hide inner tick labels consistent with subplot layout.\n+        if self._sharex is not None or self._sharey is not None:\n+            try:\n+                self.label_outer()\n+            except Exception:\n+                pass\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "lib/matplotlib/axes/_base.py": [
          "\nfunction: _AxesBase.cla"
        ],
        "lib/matplotlib/axis.py": [
          "\nfunction: Axis._reset_major_tick_kw\nfunction: Axis._reset_minor_tick_kw"
        ]
      },
      "patches": [
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..f23ffc1 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1300,8 +1300,23 @@ class _AxesBase(martist.Artist):\n         self.xaxis.set_clip_path(self.patch)\n         self.yaxis.set_clip_path(self.patch)\n \n-        self._shared_axes[\"x\"].clean()\n-        self._shared_axes[\"y\"].clean()\n+        # Ensure tick placement and label visibility match rcParams defaults\n+        # (e.g., disable top and right ticks by default).\n+        self.tick_params(\n+            axis='x', which='both',\n+            top=mpl.rcParams['xtick.top'],\n+            bottom=mpl.rcParams['xtick.bottom'],\n+            labeltop=mpl.rcParams['xtick.labeltop'],\n+            labelbottom=mpl.rcParams['xtick.labelbottom']\n+        )\n+        self.tick_params(\n+            axis='y', which='both',\n+            left=mpl.rcParams['ytick.left'],\n+            right=mpl.rcParams['ytick.right'],\n+            labelleft=mpl.rcParams['ytick.labelleft'],\n+            labelright=mpl.rcParams['ytick.labelright']\n+        )\n+\n         if self._sharex is not None:\n             self.xaxis.set_visible(xaxis_visible)\n             self.patch.set_visible(patch_visible)\n@@ -1309,6 +1324,11 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # After restoring visibility, clean up shared axes to hide\n+        # redundant tick labels on non-primary shared axes.\n+        self._shared_axes[\"x\"].clean()\n+        self._shared_axes[\"y\"].clean()\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..76778b5 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,13 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # Preserve tick parameter state (e.g., which sides/labels are on)\n+        # so that shared-axis hiding and custom tick settings survive clear().\n+        _xmaj = getattr(self.xaxis, \"_major_tick_kw\", {}).copy()\n+        _xmin = getattr(self.xaxis, \"_minor_tick_kw\", {}).copy()\n+        _ymaj = getattr(self.yaxis, \"_major_tick_kw\", {}).copy()\n+        _ymin = getattr(self.yaxis, \"_minor_tick_kw\", {}).copy()\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1224,6 +1231,18 @@ class _AxesBase(martist.Artist):\n         if mpl.rcParams['ytick.minor.visible']:\n             self.yaxis.set_minor_locator(mticker.AutoMinorLocator())\n \n+        # Restore previously saved tick parameter state to avoid turning\n+        # back on ticks/labels that were intentionally hidden (e.g., due to\n+        # shared axes).\n+        if _xmaj:\n+            self.xaxis._major_tick_kw.update(_xmaj)\n+        if _xmin:\n+            self.xaxis._minor_tick_kw.update(_xmin)\n+        if _ymaj:\n+            self.yaxis._major_tick_kw.update(_ymaj)\n+        if _ymin:\n+            self.yaxis._minor_tick_kw.update(_ymin)\n+\n         if self._sharex is None:\n             self._autoscaleXon = True\n         if self._sharey is None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..81b8c24 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1295,7 +1295,11 @@ class _AxesBase(martist.Artist):\n         self.patch.set_linewidth(0)\n         self.patch.set_transform(self.transAxes)\n \n-        self.set_axis_on()\n+        # Do not call set_axis_on() here; it resets tick positions (e.g., enabling\n+        # top/right ticks) and can un-hide tick labels on shared axes.\n+        # Axis visibility is restored explicitly below to respect rcParams and\n+        # shared-axis settings.\n+        # self.set_axis_on()\n \n         self.xaxis.set_clip_path(self.patch)\n         self.yaxis.set_clip_path(self.patch)\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..11a1c0a 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1309,6 +1309,33 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Reset tick positions and label visibilities to respect rcParams.\n+        # Axis.clear() resets tick parameters; re-apply rcParams defaults.\n+        try:\n+            self.xaxis.set_tick_params(\n+                top=mpl.rcParams['xtick.top'],\n+                bottom=mpl.rcParams['xtick.bottom'],\n+                labeltop=mpl.rcParams['xtick.labeltop'],\n+                labelbottom=mpl.rcParams['xtick.labelbottom']\n+            )\n+            self.yaxis.set_tick_params(\n+                left=mpl.rcParams['ytick.left'],\n+                right=mpl.rcParams['ytick.right'],\n+                labelleft=mpl.rcParams['ytick.labelleft'],\n+                labelright=mpl.rcParams['ytick.labelright']\n+            )\n+        except Exception:\n+            # Be tolerant of unusual projections that may not support tick_params.\n+            pass\n+\n+        # For shared axes, re-hide inner tick labels (e.g., only show on the\n+        # bottom and left-most axes) to maintain expected shared-axis behavior.\n+        if self._sharex is not None or self._sharey is not None:\n+            try:\n+                self.label_outer()\n+            except Exception:\n+                pass\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..d922357 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1309,6 +1309,10 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Ensure inner tick labels are hidden again for shared axes after clearing.\n+        if self._sharex is not None or self._sharey is not None:\n+            self.label_outer()\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\ndiff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..d7b66ec 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -778,12 +778,31 @@ class Axis(martist.Artist):\n         self._major_tick_kw['gridOn'] = (\n                 mpl.rcParams['axes.grid'] and\n                 mpl.rcParams['axes.grid.which'] in ('both', 'major'))\n+        # Respect rcParams for tick and label visibility on each side.\n+        if self.axis_name == 'x':\n+            self._major_tick_kw['tick1On'] = mpl.rcParams['xtick.bottom']\n+            self._major_tick_kw['tick2On'] = mpl.rcParams['xtick.top']\n+            self._major_tick_kw['label1On'] = mpl.rcParams['xtick.labelbottom']\n+            self._major_tick_kw['label2On'] = mpl.rcParams['xtick.labeltop']\n+        else:\n+            # y-axis\n+            self._major_tick_kw['tick1On'] = mpl.rcParams['ytick.left']\n+            self._major_tick_kw['tick2On'] = mpl.rcParams['ytick.right']\n+            self._major_tick_kw['label1On'] = mpl.rcParams['ytick.labelleft']\n+            self._major_tick_kw['label2On'] = mpl.rcParams['ytick.labelright']\n \n     def _reset_minor_tick_kw(self):\n         self._minor_tick_kw.clear()\n         self._minor_tick_kw['gridOn'] = (\n                 mpl.rcParams['axes.grid'] and\n                 mpl.rcParams['axes.grid.which'] in ('both', 'minor'))\n+        # Respect rcParams for which sides minor ticks should appear on.\n+        if self.axis_name == 'x':\n+            self._minor_tick_kw['tick1On'] = mpl.rcParams['xtick.bottom']\n+            self._minor_tick_kw['tick2On'] = mpl.rcParams['xtick.top']\n+        else:\n+            self._minor_tick_kw['tick1On'] = mpl.rcParams['ytick.left']\n+            self._minor_tick_kw['tick2On'] = mpl.rcParams['ytick.right']\n \n     def clear(self):\n         \"\"\"\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..c76e819 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,21 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # Stash current tick parameter settings so that label/tick visibility\n+        # and side settings (e.g., top/right ticks) can be restored after clear.\n+        # This is particularly important for shared axes which hide tick labels\n+        # on non-primary axes.\n+        try:\n+            _x_major_tick_kw = dict(self.xaxis._major_tick_kw)\n+            _x_minor_tick_kw = dict(self.xaxis._minor_tick_kw)\n+            _y_major_tick_kw = dict(self.yaxis._major_tick_kw)\n+            _y_minor_tick_kw = dict(self.yaxis._minor_tick_kw)\n+        except Exception:\n+            _x_major_tick_kw = {}\n+            _x_minor_tick_kw = {}\n+            _y_major_tick_kw = {}\n+            _y_minor_tick_kw = {}\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1309,6 +1324,21 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Restore previously saved tick parameter settings to avoid re-enabling\n+        # tick labels and ticks that were hidden (e.g., by shared axes).\n+        if _x_major_tick_kw:\n+            self.xaxis._major_tick_kw.clear()\n+            self.xaxis._major_tick_kw.update(_x_major_tick_kw)\n+        if _x_minor_tick_kw:\n+            self.xaxis._minor_tick_kw.clear()\n+            self.xaxis._minor_tick_kw.update(_x_minor_tick_kw)\n+        if _y_major_tick_kw:\n+            self.yaxis._major_tick_kw.clear()\n+            self.yaxis._major_tick_kw.update(_y_major_tick_kw)\n+        if _y_minor_tick_kw:\n+            self.yaxis._minor_tick_kw.clear()\n+            self.yaxis._minor_tick_kw.update(_y_minor_tick_kw)\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..6012b98 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,33 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # Save current per-side tick mark and tick-label visibility before clearing,\n+        # so shared-axis label suppression and user settings survive a clear.\n+        def _axis_tick_state(axis, is_x):\n+            ticks = axis.get_major_ticks()\n+            if ticks:\n+                # tick1 is bottom/left; tick2 is top/right\n+                bottom_left_on = any(t.tick1On for t in ticks)\n+                top_right_on = any(t.tick2On for t in ticks)\n+                label_bottom_left_on = any(t.label1.get_visible() for t in ticks)\n+                label_top_right_on = any(t.label2.get_visible() for t in ticks)\n+                return (bottom_left_on, top_right_on,\n+                        label_bottom_left_on, label_top_right_on)\n+            else:\n+                if is_x:\n+                    return (mpl.rcParams['xtick.bottom'],\n+                            mpl.rcParams['xtick.top'],\n+                            mpl.rcParams['xtick.labelbottom'],\n+                            mpl.rcParams['xtick.labeltop'])\n+                else:\n+                    return (mpl.rcParams['ytick.left'],\n+                            mpl.rcParams['ytick.right'],\n+                            mpl.rcParams['ytick.labelleft'],\n+                            mpl.rcParams['ytick.labelright'])\n+\n+        x_bottom, x_top, x_labelbottom, x_labeltop = _axis_tick_state(self.xaxis, True)\n+        y_left, y_right, y_labelleft, y_labelright = _axis_tick_state(self.yaxis, False)\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1302,6 +1329,13 @@ class _AxesBase(martist.Artist):\n \n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n+\n+        # Restore per-side tick and tick-label visibility that may be set by sharing or user code.\n+        self.tick_params(axis='x', bottom=x_bottom, top=x_top,\n+                         labelbottom=x_labelbottom, labeltop=x_labeltop)\n+        self.tick_params(axis='y', left=y_left, right=y_right,\n+                         labelleft=y_labelleft, labelright=y_labelright)\n+\n         if self._sharex is not None:\n             self.xaxis.set_visible(xaxis_visible)\n             self.patch.set_visible(patch_visible)\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..0d15cad 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1191,6 +1191,11 @@ class _AxesBase(martist.Artist):\n \n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n+        # stash current tick parameter state (e.g., which sides/labels are on)\n+        x_major_tick_kw = dict(self.xaxis._major_tick_kw)\n+        x_minor_tick_kw = dict(self.xaxis._minor_tick_kw)\n+        y_major_tick_kw = dict(self.yaxis._major_tick_kw)\n+        y_minor_tick_kw = dict(self.yaxis._minor_tick_kw)\n \n         self.xaxis.clear()\n         self.yaxis.clear()\n@@ -1224,6 +1229,13 @@ class _AxesBase(martist.Artist):\n         if mpl.rcParams['ytick.minor.visible']:\n             self.yaxis.set_minor_locator(mticker.AutoMinorLocator())\n \n+        # Restore the tick parameter state saved before clear.\n+        # This preserves user/sharex/sharey-controlled label visibility and tick sides.\n+        self.xaxis._major_tick_kw.update(x_major_tick_kw)\n+        self.xaxis._minor_tick_kw.update(x_minor_tick_kw)\n+        self.yaxis._major_tick_kw.update(y_major_tick_kw)\n+        self.yaxis._minor_tick_kw.update(y_minor_tick_kw)\n+\n         if self._sharex is None:\n             self._autoscaleXon = True\n         if self._sharey is None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..83295fe 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1218,10 +1218,12 @@ class _AxesBase(martist.Artist):\n             except TypeError:\n                 pass\n \n-        # update the minor locator for x and y axis based on rcParams\n-        if mpl.rcParams['xtick.minor.visible']:\n+        # update the minor locator for x and y axis based on rcParams.\n+        # If the axis is shared, inherit the minor locator from the shared axis\n+        # instead of overriding it based on rcParams.\n+        if self._sharex is None and mpl.rcParams['xtick.minor.visible']:\n             self.xaxis.set_minor_locator(mticker.AutoMinorLocator())\n-        if mpl.rcParams['ytick.minor.visible']:\n+        if self._sharey is None and mpl.rcParams['ytick.minor.visible']:\n             self.yaxis.set_minor_locator(mticker.AutoMinorLocator())\n \n         if self._sharex is None:\n@@ -1300,6 +1302,7 @@ class _AxesBase(martist.Artist):\n         self.xaxis.set_clip_path(self.patch)\n         self.yaxis.set_clip_path(self.patch)\n \n+        # Clean up shared axes groups to set appropriate tick/label visibility.\n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n         if self._sharex is not None:\n@@ -1309,6 +1312,13 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Ensure shared-axis tick/label visibility is consistent after any\n+        # visibility changes above.\n+        if self._sharex is not None:\n+            self._shared_axes[\"x\"].clean()\n+        if self._sharey is not None:\n+            self._shared_axes[\"y\"].clean()\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..da03465 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1195,6 +1195,23 @@ class _AxesBase(martist.Artist):\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n+        # Restore tick side and label visibility from rcParams so that clearing\n+        # does not inadvertently enable top/right ticks or labels.\n+        try:\n+            self.tick_params(axis='x', which='both',\n+                             top=mpl.rcParams['xtick.top'],\n+                             bottom=mpl.rcParams['xtick.bottom'],\n+                             labeltop=mpl.rcParams['xtick.labeltop'],\n+                             labelbottom=mpl.rcParams['xtick.labelbottom'])\n+            self.tick_params(axis='y', which='both',\n+                             left=mpl.rcParams['ytick.left'],\n+                             right=mpl.rcParams['ytick.right'],\n+                             labelleft=mpl.rcParams['ytick.labelleft'],\n+                             labelright=mpl.rcParams['ytick.labelright'])\n+        except Exception:\n+            # Be robust during initialization/cleanup stages.\n+            pass\n+\n         for name, spine in self.spines.items():\n             spine.clear()\n \n@@ -1302,6 +1319,14 @@ class _AxesBase(martist.Artist):\n \n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n+\n+        # For shared axes, re-hide the interior tick labels after clearing.\n+        if self._sharex is not None or self._sharey is not None:\n+            try:\n+                self.label_outer()\n+            except Exception:\n+                pass\n+\n         if self._sharex is not None:\n             self.xaxis.set_visible(xaxis_visible)\n             self.patch.set_visible(patch_visible)\n"
      ]
    },
    {
      "sample_index": 2,
      "edit_locs": {
        "lib/matplotlib/axes/_base.py": [
          "\nfunction: _AxesBase.cla"
        ],
        "lib/matplotlib/axis.py": [
          "\nfunction: Axis.clear"
        ]
      },
      "patches": [
        "diff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..5ef7283 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -785,6 +785,20 @@ class Axis(martist.Artist):\n                 mpl.rcParams['axes.grid'] and\n                 mpl.rcParams['axes.grid.which'] in ('both', 'minor'))\n \n+        # Set default minor tick visibility based on axis orientation.\n+        axis_name = getattr(self, \"axis_name\", None)\n+        if axis_name == 'x':\n+            self._minor_tick_kw['tick1On'] = mpl.rcParams['xtick.bottom']\n+            self._minor_tick_kw['tick2On'] = mpl.rcParams['xtick.top']\n+            # Minor tick labels are typically not shown by default.\n+            self._minor_tick_kw['label1On'] = False\n+            self._minor_tick_kw['label2On'] = False\n+        elif axis_name == 'y':\n+            self._minor_tick_kw['tick1On'] = mpl.rcParams['ytick.left']\n+            self._minor_tick_kw['tick2On'] = mpl.rcParams['ytick.right']\n+            self._minor_tick_kw['label1On'] = False\n+            self._minor_tick_kw['label2On'] = False\n+\n     def clear(self):\n         \"\"\"\n         Clear the axis.\n@@ -806,8 +820,24 @@ class Axis(martist.Artist):\n         # Clear the callback registry for this axis, or it may \"leak\"\n         self.callbacks = cbook.CallbackRegistry()\n \n+        # Preserve current tick/label visibility defaults so that shared axes\n+        # and custom tick visibility survive a clear().\n+        prev_major_vis = {k: self._major_tick_kw.get(k)\n+                          for k in ('tick1On', 'tick2On', 'label1On', 'label2On')}\n+        prev_minor_vis = {k: self._minor_tick_kw.get(k)\n+                          for k in ('tick1On', 'tick2On', 'label1On', 'label2On')}\n+\n         self._reset_major_tick_kw()\n         self._reset_minor_tick_kw()\n+\n+        # Restore preserved visibility settings if previously set.\n+        for k, v in prev_major_vis.items():\n+            if v is not None:\n+                self._major_tick_kw[k] = v\n+        for k, v in prev_minor_vis.items():\n+            if v is not None:\n+                self._minor_tick_kw[k] = v\n+\n         self.reset_ticks()\n \n         self.converter = None\n",
        "diff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..567a126 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -806,8 +806,15 @@ class Axis(martist.Artist):\n         # Clear the callback registry for this axis, or it may \"leak\"\n         self.callbacks = cbook.CallbackRegistry()\n \n-        self._reset_major_tick_kw()\n-        self._reset_minor_tick_kw()\n+        # Preserve existing tick parameter settings (such as which sides and labels\n+        # are visible) to avoid changing tick visibility when clearing the axis.\n+        # Only update the gridOn flag based on rcParams.\n+        self._major_tick_kw['gridOn'] = (\n+                mpl.rcParams['axes.grid'] and\n+                mpl.rcParams['axes.grid.which'] in ('both', 'major'))\n+        self._minor_tick_kw['gridOn'] = (\n+                mpl.rcParams['axes.grid'] and\n+                mpl.rcParams['axes.grid.which'] in ('both', 'minor'))\n         self.reset_ticks()\n \n         self.converter = None\n",
        "diff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..45a3786 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -806,8 +806,11 @@ class Axis(martist.Artist):\n         # Clear the callback registry for this axis, or it may \"leak\"\n         self.callbacks = cbook.CallbackRegistry()\n \n-        self._reset_major_tick_kw()\n-        self._reset_minor_tick_kw()\n+        # Preserve existing tick parameter settings (e.g., visibility of\n+        # tick marks and labels) to avoid altering shared-axis state or\n+        # user customizations. Resetting tick kwargs here caused extra\n+        # ticks and labels to appear after Axes.clear(), particularly with\n+        # shared axes. We only reinitialize the Tick lists.\n         self.reset_ticks()\n \n         self.converter = None\n",
        "diff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..ed83821 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -785,6 +785,16 @@ class Axis(martist.Artist):\n                 mpl.rcParams['axes.grid'] and\n                 mpl.rcParams['axes.grid.which'] in ('both', 'minor'))\n \n+        # Configure default minor tick visibility based on axis orientation and rcParams.\n+        # Minor tick labels are generally not shown, so we only set tick visibility.\n+        axis_name = getattr(self, 'axis_name', None)\n+        if axis_name == 'x':\n+            self._minor_tick_kw['tick1On'] = mpl.rcParams.get('xtick.bottom', True)\n+            self._minor_tick_kw['tick2On'] = mpl.rcParams.get('xtick.top', False)\n+        else:\n+            self._minor_tick_kw['tick1On'] = mpl.rcParams.get('ytick.left', True)\n+            self._minor_tick_kw['tick2On'] = mpl.rcParams.get('ytick.right', False)\n+\n     def clear(self):\n         \"\"\"\n         Clear the axis.\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..110401f 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1300,6 +1300,24 @@ class _AxesBase(martist.Artist):\n         self.xaxis.set_clip_path(self.patch)\n         self.yaxis.set_clip_path(self.patch)\n \n+        # Reset tick positions/labels visibility according to rcParams so that\n+        # clearing an Axes does not inadvertently enable top/right ticks or\n+        # unhide shared-axis tick labels.\n+        self.tick_params(\n+            axis='x',\n+            top=mpl.rcParams['xtick.top'],\n+            bottom=mpl.rcParams['xtick.bottom'],\n+            labeltop=mpl.rcParams['xtick.labeltop'],\n+            labelbottom=mpl.rcParams['xtick.labelbottom'],\n+        )\n+        self.tick_params(\n+            axis='y',\n+            left=mpl.rcParams['ytick.left'],\n+            right=mpl.rcParams['ytick.right'],\n+            labelleft=mpl.rcParams['ytick.labelleft'],\n+            labelright=mpl.rcParams['ytick.labelright'],\n+        )\n+\n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n         if self._sharex is not None:\n",
        "diff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..dbbd68d 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -806,8 +806,20 @@ class Axis(martist.Artist):\n         # Clear the callback registry for this axis, or it may \"leak\"\n         self.callbacks = cbook.CallbackRegistry()\n \n+        # Preserve current visibility-related tick parameters so that clearing\n+        # does not un-hide shared-axis tick labels or enable secondary ticks.\n+        old_major = self._major_tick_kw.copy()\n+        old_minor = self._minor_tick_kw.copy()\n+\n         self._reset_major_tick_kw()\n         self._reset_minor_tick_kw()\n+\n+        for key in ('tick1On', 'tick2On', 'label1On', 'label2On'):\n+            if key in old_major:\n+                self._major_tick_kw[key] = old_major[key]\n+            if key in old_minor:\n+                self._minor_tick_kw[key] = old_minor[key]\n+\n         self.reset_ticks()\n \n         self.converter = None\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..c7ce47d 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,12 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # stash current tick parameter state to restore after clearing\n+        x_major_tick_kw = getattr(self.xaxis, \"_major_tick_kw\", {}).copy()\n+        y_major_tick_kw = getattr(self.yaxis, \"_major_tick_kw\", {}).copy()\n+        x_minor_tick_kw = getattr(self.xaxis, \"_minor_tick_kw\", {}).copy()\n+        y_minor_tick_kw = getattr(self.yaxis, \"_minor_tick_kw\", {}).copy()\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1309,6 +1315,21 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Restore tick parameter state (positions and label visibility), which may\n+        # include settings from shared axes or rcParams (e.g., top/right ticks off).\n+        try:\n+            if x_major_tick_kw:\n+                self.xaxis.set_tick_params(**x_major_tick_kw)\n+            if x_minor_tick_kw:\n+                self.xaxis.set_tick_params(which='minor', **x_minor_tick_kw)\n+            if y_major_tick_kw:\n+                self.yaxis.set_tick_params(**y_major_tick_kw)\n+            if y_minor_tick_kw:\n+                self.yaxis.set_tick_params(which='minor', **y_minor_tick_kw)\n+        except Exception:\n+            # Be robust to potential future changes in tick parameter keys.\n+            pass\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..8c3f574 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1300,8 +1300,6 @@ class _AxesBase(martist.Artist):\n         self.xaxis.set_clip_path(self.patch)\n         self.yaxis.set_clip_path(self.patch)\n \n-        self._shared_axes[\"x\"].clean()\n-        self._shared_axes[\"y\"].clean()\n         if self._sharex is not None:\n             self.xaxis.set_visible(xaxis_visible)\n             self.patch.set_visible(patch_visible)\n@@ -1309,6 +1307,11 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Clean shared axes groups after restoring axis visibility so that any\n+        # label hiding due to shared axes is correctly reapplied.\n+        self._shared_axes[\"x\"].clean()\n+        self._shared_axes[\"y\"].clean()\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\ndiff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..9a70b30 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -784,6 +784,13 @@ class Axis(martist.Artist):\n         self._minor_tick_kw['gridOn'] = (\n                 mpl.rcParams['axes.grid'] and\n                 mpl.rcParams['axes.grid.which'] in ('both', 'minor'))\n+        # Respect rcParams for which sides minor ticks appear on.\n+        if getattr(self, 'axis_name', None) == 'x':\n+            self._minor_tick_kw['top'] = mpl.rcParams.get('xtick.top', False)\n+            self._minor_tick_kw['bottom'] = mpl.rcParams.get('xtick.bottom', True)\n+        else:\n+            self._minor_tick_kw['left'] = mpl.rcParams.get('ytick.left', True)\n+            self._minor_tick_kw['right'] = mpl.rcParams.get('ytick.right', False)\n \n     def clear(self):\n         \"\"\"\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..c899a93 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1297,16 +1297,48 @@ class _AxesBase(martist.Artist):\n \n         self.set_axis_on()\n \n+        # Respect rcParams for which sides have ticks and tick labels to avoid\n+        # unintentionally enabling top/right ticks on clear.\n+        xtop = mpl.rcParams['xtick.top']\n+        xbottom = mpl.rcParams['xtick.bottom']\n+        if xtop and xbottom:\n+            self.xaxis.set_ticks_position('both')\n+        elif xtop:\n+            self.xaxis.set_ticks_position('top')\n+        elif xbottom:\n+            self.xaxis.set_ticks_position('bottom')\n+        else:\n+            self.xaxis.set_ticks_position('none')\n+\n+        yleft = mpl.rcParams['ytick.left']\n+        yright = mpl.rcParams['ytick.right']\n+        if yleft and yright:\n+            self.yaxis.set_ticks_position('both')\n+        elif yleft:\n+            self.yaxis.set_ticks_position('left')\n+        elif yright:\n+            self.yaxis.set_ticks_position('right')\n+        else:\n+            self.yaxis.set_ticks_position('none')\n+\n+        # Apply rcParams for tick label visibility as well.\n+        self.tick_params(axis='x', which='both',\n+                         labeltop=mpl.rcParams['xtick.labeltop'],\n+                         labelbottom=mpl.rcParams['xtick.labelbottom'])\n+        self.tick_params(axis='y', which='both',\n+                         labelleft=mpl.rcParams['ytick.labelleft'],\n+                         labelright=mpl.rcParams['ytick.labelright'])\n+\n         self.xaxis.set_clip_path(self.patch)\n         self.yaxis.set_clip_path(self.patch)\n \n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n         if self._sharex is not None:\n-            self.xaxis.set_visible(xaxis_visible)\n+            # Do not override visibility determined by shared-axes machinery.\n             self.patch.set_visible(patch_visible)\n         if self._sharey is not None:\n-            self.yaxis.set_visible(yaxis_visible)\n+            # Do not override visibility determined by shared-axes machinery.\n             self.patch.set_visible(patch_visible)\n \n         self.stale = True\n",
        "diff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..6b10927 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -799,6 +799,12 @@ class Axis(martist.Artist):\n         - registered callbacks\n         \"\"\"\n \n+        # Preserve current tick parameter settings (e.g., side/label visibility)\n+        # so that clearing the axis does not inadvertently change tick placement\n+        # or shared-axis visibility behavior.\n+        old_major_tick_kw = dict(getattr(self, \"_major_tick_kw\", {}))\n+        old_minor_tick_kw = dict(getattr(self, \"_minor_tick_kw\", {}))\n+\n         self.label.set_text('')  # self.set_label_text would change isDefault_\n \n         self._set_scale('linear')\n@@ -810,6 +816,41 @@ class Axis(martist.Artist):\n         self._reset_minor_tick_kw()\n         self.reset_ticks()\n \n+        # Restore previous tick-parameter settings if available; otherwise,\n+        # re-apply rcParams defaults for tick visibility.\n+        if old_major_tick_kw:\n+            self.set_tick_params(which='major', **old_major_tick_kw)\n+        else:\n+            if getattr(self, 'axis_name', None) == 'x':\n+                self.set_tick_params(\n+                    which='major',\n+                    top=mpl.rcParams['xtick.top'],\n+                    bottom=mpl.rcParams['xtick.bottom'],\n+                    labeltop=mpl.rcParams['xtick.labeltop'],\n+                    labelbottom=mpl.rcParams['xtick.labelbottom'],\n+                    direction=mpl.rcParams['xtick.direction'])\n+            else:\n+                self.set_tick_params(\n+                    which='major',\n+                    left=mpl.rcParams['ytick.left'],\n+                    right=mpl.rcParams['ytick.right'],\n+                    labelleft=mpl.rcParams['ytick.labelleft'],\n+                    labelright=mpl.rcParams['ytick.labelright'],\n+                    direction=mpl.rcParams['ytick.direction'])\n+        if old_minor_tick_kw:\n+            self.set_tick_params(which='minor', **old_minor_tick_kw)\n+        else:\n+            if getattr(self, 'axis_name', None) == 'x':\n+                self.set_tick_params(\n+                    which='minor',\n+                    top=mpl.rcParams['xtick.top'],\n+                    bottom=mpl.rcParams['xtick.bottom'])\n+            else:\n+                self.set_tick_params(\n+                    which='minor',\n+                    left=mpl.rcParams['ytick.left'],\n+                    right=mpl.rcParams['ytick.right'])\n+\n         self.converter = None\n         self.units = None\n         self.set_units(None)\n"
      ]
    },
    {
      "sample_index": 3,
      "edit_locs": {
        "lib/matplotlib/axes/_base.py": [
          "\nfunction: _AxesBase.cla"
        ],
        "lib/matplotlib/axis.py": [
          "\nfunction: Axis._reset_major_tick_kw\nfunction: Axis._reset_minor_tick_kw"
        ]
      },
      "patches": [
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..535ffa7 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1309,6 +1309,28 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Reset tick parameters from rcParams to avoid enabling top/right ticks\n+        # unintentionally after a clear, and to restore label visibilities.\n+        self.tick_params(\n+            axis='x',\n+            bottom=mpl.rcParams['xtick.bottom'],\n+            top=mpl.rcParams['xtick.top'],\n+            labelbottom=mpl.rcParams['xtick.labelbottom'],\n+            labeltop=mpl.rcParams['xtick.labeltop'],\n+        )\n+        self.tick_params(\n+            axis='y',\n+            left=mpl.rcParams['ytick.left'],\n+            right=mpl.rcParams['ytick.right'],\n+            labelleft=mpl.rcParams['ytick.labelleft'],\n+            labelright=mpl.rcParams['ytick.labelright'],\n+        )\n+\n+        # If axes are shared, re-hide inner tick labels to match the behavior\n+        # at creation time of shared axes.\n+        if self._sharex is not None or self._sharey is not None:\n+            self.label_outer()\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..64498d9 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1302,13 +1302,27 @@ class _AxesBase(martist.Artist):\n \n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n+        # If axes are shared, do not force them visible again; this can\n+        # un-hide tick labels that shared axes logic just hid. Only restore\n+        # an explicitly hidden axis.\n         if self._sharex is not None:\n-            self.xaxis.set_visible(xaxis_visible)\n+            if not xaxis_visible:\n+                self.xaxis.set_visible(False)\n             self.patch.set_visible(patch_visible)\n         if self._sharey is not None:\n-            self.yaxis.set_visible(yaxis_visible)\n+            if not yaxis_visible:\n+                self.yaxis.set_visible(False)\n             self.patch.set_visible(patch_visible)\n \n+        # Respect rcParams for which sides have ticks visible after clearing.\n+        # Axis.clear resets ticks; reapply side visibility from rcParams.\n+        self.tick_params(axis='x',\n+                         top=mpl.rcParams.get('xtick.top', False),\n+                         bottom=mpl.rcParams.get('xtick.bottom', True))\n+        self.tick_params(axis='y',\n+                         left=mpl.rcParams.get('ytick.left', True),\n+                         right=mpl.rcParams.get('ytick.right', False))\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..0e433bc 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1191,6 +1191,12 @@ class _AxesBase(martist.Artist):\n \n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n+        # Preserve tick parameter state (e.g., which sides and labels are on/off)\n+        # so that shared-axis and user-configured tick visibility survives clear().\n+        _saved_xmaj_kw = getattr(self.xaxis, \"_major_tick_kw\", {}).copy()\n+        _saved_xmin_kw = getattr(self.xaxis, \"_minor_tick_kw\", {}).copy()\n+        _saved_ymaj_kw = getattr(self.yaxis, \"_major_tick_kw\", {}).copy()\n+        _saved_ymin_kw = getattr(self.yaxis, \"_minor_tick_kw\", {}).copy()\n \n         self.xaxis.clear()\n         self.yaxis.clear()\n@@ -1309,6 +1315,18 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Restore preserved tick-parameter state (tick/label on/off, etc.).\n+        # This ensures shared-axis hidden tick labels and non-default tick sides\n+        # remain consistent after clearing.\n+        if '_saved_xmaj_kw' in locals():\n+            self.xaxis._major_tick_kw.update(_saved_xmaj_kw)\n+        if '_saved_xmin_kw' in locals():\n+            self.xaxis._minor_tick_kw.update(_saved_xmin_kw)\n+        if '_saved_ymaj_kw' in locals():\n+            self.yaxis._major_tick_kw.update(_saved_ymaj_kw)\n+        if '_saved_ymin_kw' in locals():\n+            self.yaxis._minor_tick_kw.update(_saved_ymin_kw)\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..6990813 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1191,6 +1191,12 @@ class _AxesBase(martist.Artist):\n \n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n+        # Preserve tick parameter state to maintain tick/label visibility,\n+        # particularly for shared axes where some labels are hidden.\n+        _x_major_kw = dict(self.xaxis._major_tick_kw)\n+        _x_minor_kw = dict(self.xaxis._minor_tick_kw)\n+        _y_major_kw = dict(self.yaxis._major_tick_kw)\n+        _y_minor_kw = dict(self.yaxis._minor_tick_kw)\n \n         self.xaxis.clear()\n         self.yaxis.clear()\n@@ -1309,6 +1315,18 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Restore previously saved tick parameters so that tick/label visibility\n+        # (e.g., hidden shared-axis labels and disabled top/right ticks) remain\n+        # consistent across clear().\n+        if _x_major_kw:\n+            self.xaxis.set_tick_params(which='major', **_x_major_kw)\n+        if _x_minor_kw:\n+            self.xaxis.set_tick_params(which='minor', **_x_minor_kw)\n+        if _y_major_kw:\n+            self.yaxis.set_tick_params(which='major', **_y_major_kw)\n+        if _y_minor_kw:\n+            self.yaxis.set_tick_params(which='minor', **_y_minor_kw)\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..6d67145 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1302,12 +1302,43 @@ class _AxesBase(martist.Artist):\n \n         self._shared_axes[\"x\"].clean()\n         self._shared_axes[\"y\"].clean()\n-        if self._sharex is not None:\n-            self.xaxis.set_visible(xaxis_visible)\n-            self.patch.set_visible(patch_visible)\n-        if self._sharey is not None:\n-            self.yaxis.set_visible(yaxis_visible)\n-            self.patch.set_visible(patch_visible)\n+        # Do not forcibly restore axis visibility for shared axes here.\n+        # SharedAxes.clean() is responsible for setting which axes show\n+        # tick labels. Resetting visibility un-hides tick labels on\n+        # non-bottom/left shared axes.\n+        # Only restore the patch visibility.\n+        self.patch.set_visible(patch_visible)\n+\n+        # Respect rcParams for tick mark positions (top/bottom, left/right).\n+        # Axis.clear() resets ticks; explicitly set positions to rcParams\n+        # defaults to avoid enabling top/right ticks unexpectedly.\n+        # Do not modify label visibility here to preserve shared-axes hiding.\n+        try:\n+            xtop = mpl.rcParams['xtick.top']\n+            xbot = mpl.rcParams['xtick.bottom']\n+            if xtop and xbot:\n+                self.xaxis.set_ticks_position('both')\n+            elif xtop and not xbot:\n+                self.xaxis.set_ticks_position('top')\n+            elif not xtop and xbot:\n+                self.xaxis.set_ticks_position('bottom')\n+            else:\n+                self.xaxis.set_ticks_position('none')\n+        except Exception:\n+            pass\n+        try:\n+            yleft = mpl.rcParams['ytick.left']\n+            yright = mpl.rcParams['ytick.right']\n+            if yleft and yright:\n+                self.yaxis.set_ticks_position('both')\n+            elif yleft and not yright:\n+                self.yaxis.set_ticks_position('left')\n+            elif not yleft and yright:\n+                self.yaxis.set_ticks_position('right')\n+            else:\n+                self.yaxis.set_ticks_position('none')\n+        except Exception:\n+            pass\n \n         self.stale = True\n \n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..d1fc12b 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1191,6 +1191,11 @@ class _AxesBase(martist.Artist):\n \n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n+        # Stash current tick parameter state (e.g., side and label visibility)\n+        _prev_major_x = getattr(self.xaxis, \"_major_tick_kw\", {}).copy()\n+        _prev_minor_x = getattr(self.xaxis, \"_minor_tick_kw\", {}).copy()\n+        _prev_major_y = getattr(self.yaxis, \"_major_tick_kw\", {}).copy()\n+        _prev_minor_y = getattr(self.yaxis, \"_minor_tick_kw\", {}).copy()\n \n         self.xaxis.clear()\n         self.yaxis.clear()\n@@ -1218,6 +1223,17 @@ class _AxesBase(martist.Artist):\n             except TypeError:\n                 pass\n \n+        # Restore pre-clear tick parameter settings to preserve shared-axis\n+        # label visibility and tick side settings.\n+        if _prev_major_x:\n+            self.xaxis.set_tick_params(which='major', **_prev_major_x)\n+        if _prev_minor_x:\n+            self.xaxis.set_tick_params(which='minor', **_prev_minor_x)\n+        if _prev_major_y:\n+            self.yaxis.set_tick_params(which='major', **_prev_major_y)\n+        if _prev_minor_y:\n+            self.yaxis.set_tick_params(which='minor', **_prev_minor_y)\n+\n         # update the minor locator for x and y axis based on rcParams\n         if mpl.rcParams['xtick.minor.visible']:\n             self.xaxis.set_minor_locator(mticker.AutoMinorLocator())\n",
        "diff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..38850ec 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -778,12 +778,35 @@ class Axis(martist.Artist):\n         self._major_tick_kw['gridOn'] = (\n                 mpl.rcParams['axes.grid'] and\n                 mpl.rcParams['axes.grid.which'] in ('both', 'major'))\n+        # Apply default tick and label visibility from rcParams\n+        # tick1On/label1On correspond to bottom (x) or left (y)\n+        # tick2On/label2On correspond to top (x) or right (y)\n+        if getattr(self, 'axis_name', None) == 'x':\n+            self._major_tick_kw['tick1On'] = mpl.rcParams['xtick.bottom']\n+            self._major_tick_kw['tick2On'] = mpl.rcParams['xtick.top']\n+            self._major_tick_kw['label1On'] = mpl.rcParams['xtick.labelbottom']\n+            self._major_tick_kw['label2On'] = mpl.rcParams['xtick.labeltop']\n+        else:\n+            # Treat non-'x' axes as 'y'\n+            self._major_tick_kw['tick1On'] = mpl.rcParams['ytick.left']\n+            self._major_tick_kw['tick2On'] = mpl.rcParams['ytick.right']\n+            self._major_tick_kw['label1On'] = mpl.rcParams['ytick.labelleft']\n+            self._major_tick_kw['label2On'] = mpl.rcParams['ytick.labelright']\n \n     def _reset_minor_tick_kw(self):\n         self._minor_tick_kw.clear()\n         self._minor_tick_kw['gridOn'] = (\n                 mpl.rcParams['axes.grid'] and\n                 mpl.rcParams['axes.grid.which'] in ('both', 'minor'))\n+        # Apply default minor tick visibility to match major tick sides.\n+        # Minor label visibility is typically controlled separately and\n+        # not enabled by default, so we only set tick sides here.\n+        if getattr(self, 'axis_name', None) == 'x':\n+            self._minor_tick_kw['tick1On'] = mpl.rcParams.get('xtick.bottom', True)\n+            self._minor_tick_kw['tick2On'] = mpl.rcParams.get('xtick.top', False)\n+        else:\n+            self._minor_tick_kw['tick1On'] = mpl.rcParams.get('ytick.left', True)\n+            self._minor_tick_kw['tick2On'] = mpl.rcParams.get('ytick.right', False)\n \n     def clear(self):\n         \"\"\"\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 07605b5..4b32bee 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1192,6 +1192,20 @@ class _AxesBase(martist.Artist):\n         xaxis_visible = self.xaxis.get_visible()\n         yaxis_visible = self.yaxis.get_visible()\n \n+        # Record existing tick/label on/off state so we can restore after clearing.\n+        x_tick_state = {\n+            'bottom': self.xaxis._major_tick_kw.get('tick1On', None),\n+            'top': self.xaxis._major_tick_kw.get('tick2On', None),\n+            'labelbottom': self.xaxis._major_tick_kw.get('label1On', None),\n+            'labeltop': self.xaxis._major_tick_kw.get('label2On', None),\n+        }\n+        y_tick_state = {\n+            'left': self.yaxis._major_tick_kw.get('tick1On', None),\n+            'right': self.yaxis._major_tick_kw.get('tick2On', None),\n+            'labelleft': self.yaxis._major_tick_kw.get('label1On', None),\n+            'labelright': self.yaxis._major_tick_kw.get('label2On', None),\n+        }\n+\n         self.xaxis.clear()\n         self.yaxis.clear()\n \n@@ -1309,6 +1323,38 @@ class _AxesBase(martist.Artist):\n             self.yaxis.set_visible(yaxis_visible)\n             self.patch.set_visible(patch_visible)\n \n+        # Restore tick mark and tick label visibility based on previous state,\n+        # falling back to rcParams if previous state was unavailable.\n+        bx = x_tick_state.get('bottom')\n+        tx = x_tick_state.get('top')\n+        lbx = x_tick_state.get('labelbottom')\n+        ltx = x_tick_state.get('labeltop')\n+        if bx is None:\n+            bx = mpl.rcParams['xtick.bottom']\n+        if tx is None:\n+            tx = mpl.rcParams['xtick.top']\n+        if lbx is None:\n+            lbx = mpl.rcParams['xtick.labelbottom']\n+        if ltx is None:\n+            ltx = mpl.rcParams['xtick.labeltop']\n+        self.xaxis.set_tick_params(which='both', bottom=bx, top=tx,\n+                                   labelbottom=lbx, labeltop=ltx)\n+\n+        ly = y_tick_state.get('left')\n+        ry = y_tick_state.get('right')\n+        lvy = y_tick_state.get('labelleft')\n+        rvy = y_tick_state.get('labelright')\n+        if ly is None:\n+            ly = mpl.rcParams['ytick.left']\n+        if ry is None:\n+            ry = mpl.rcParams['ytick.right']\n+        if lvy is None:\n+            lvy = mpl.rcParams['ytick.labelleft']\n+        if rvy is None:\n+            rvy = mpl.rcParams['ytick.labelright']\n+        self.yaxis.set_tick_params(which='both', left=ly, right=ry,\n+                                   labelleft=lvy, labelright=rvy)\n+\n         self.stale = True\n \n     class ArtistList(MutableSequence):\n",
        "diff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..72c3eea 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -774,16 +774,72 @@ class Axis(martist.Artist):\n                 *self.get_major_ticks(), *self.get_minor_ticks()]\n \n     def _reset_major_tick_kw(self):\n+        # Preserve existing tick/label visibility (important for shared axes),\n+        # and reset other defaults based on rcParams.\n+        prev = dict(self._major_tick_kw)\n         self._major_tick_kw.clear()\n         self._major_tick_kw['gridOn'] = (\n-                mpl.rcParams['axes.grid'] and\n-                mpl.rcParams['axes.grid.which'] in ('both', 'major'))\n+            mpl.rcParams['axes.grid'] and\n+            mpl.rcParams['axes.grid.which'] in ('both', 'major'))\n+\n+        # Determine axis orientation to pick correct rcParams.\n+        axis_name = getattr(self, 'axis_name', None)\n+        # Fallback if not set; Axis subclasses normally set this.\n+        if axis_name not in ('x', 'y'):\n+            axis_name = 'x'\n+\n+        # Default visibility from rcParams.\n+        if axis_name == 'x':\n+            defaults = {\n+                'tick1On': mpl.rcParams.get('xtick.bottom', True),\n+                'tick2On': mpl.rcParams.get('xtick.top', False),\n+                'label1On': mpl.rcParams.get('xtick.labelbottom', True),\n+                'label2On': mpl.rcParams.get('xtick.labeltop', False),\n+            }\n+        else:  # 'y'\n+            defaults = {\n+                'tick1On': mpl.rcParams.get('ytick.left', True),\n+                'tick2On': mpl.rcParams.get('ytick.right', False),\n+                'label1On': mpl.rcParams.get('ytick.labelleft', True),\n+                'label2On': mpl.rcParams.get('ytick.labelright', False),\n+            }\n+\n+        # Prefer previously configured values (e.g., from sharing) over defaults.\n+        for key, val in defaults.items():\n+            self._major_tick_kw[key] = prev.get(key, val)\n \n     def _reset_minor_tick_kw(self):\n+        # Preserve existing tick/label visibility (important for shared axes),\n+        # and reset other defaults based on rcParams.\n+        prev = dict(self._minor_tick_kw)\n         self._minor_tick_kw.clear()\n         self._minor_tick_kw['gridOn'] = (\n-                mpl.rcParams['axes.grid'] and\n-                mpl.rcParams['axes.grid.which'] in ('both', 'minor'))\n+            mpl.rcParams['axes.grid'] and\n+            mpl.rcParams['axes.grid.which'] in ('both', 'minor'))\n+\n+        axis_name = getattr(self, 'axis_name', None)\n+        if axis_name not in ('x', 'y'):\n+            axis_name = 'x'\n+\n+        # Minor ticks typically mirror the side visibility of major ticks,\n+        # but minor tick labels are off by default.\n+        if axis_name == 'x':\n+            defaults = {\n+                'tick1On': mpl.rcParams.get('xtick.bottom', True),\n+                'tick2On': mpl.rcParams.get('xtick.top', False),\n+                'label1On': False,\n+                'label2On': False,\n+            }\n+        else:  # 'y'\n+            defaults = {\n+                'tick1On': mpl.rcParams.get('ytick.left', True),\n+                'tick2On': mpl.rcParams.get('ytick.right', False),\n+                'label1On': False,\n+                'label2On': False,\n+            }\n+\n+        for key, val in defaults.items():\n+            self._minor_tick_kw[key] = prev.get(key, val)\n \n     def clear(self):\n         \"\"\"\n",
        "diff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..c6e40b4 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -778,12 +778,43 @@ class Axis(martist.Artist):\n         self._major_tick_kw['gridOn'] = (\n                 mpl.rcParams['axes.grid'] and\n                 mpl.rcParams['axes.grid.which'] in ('both', 'major'))\n+        # Ensure tick side visibility defaults are restored from rcParams.\n+        # This prevents unintended activation of top/right ticks after clear().\n+        try:\n+            from .axis import XAxis, YAxis  # Local import to avoid circular ref at import time\n+        except Exception:\n+            XAxis = YAxis = None\n+        if XAxis is not None and isinstance(self, XAxis):\n+            self._major_tick_kw['top'] = mpl.rcParams['xtick.top']\n+            self._major_tick_kw['bottom'] = mpl.rcParams['xtick.bottom']\n+            self._major_tick_kw['labeltop'] = mpl.rcParams.get('xtick.labeltop', False)\n+            self._major_tick_kw['labelbottom'] = mpl.rcParams.get('xtick.labelbottom', True)\n+        elif YAxis is not None and isinstance(self, YAxis):\n+            self._major_tick_kw['left'] = mpl.rcParams['ytick.left']\n+            self._major_tick_kw['right'] = mpl.rcParams['ytick.right']\n+            self._major_tick_kw['labelleft'] = mpl.rcParams.get('ytick.labelleft', True)\n+            self._major_tick_kw['labelright'] = mpl.rcParams.get('ytick.labelright', False)\n \n     def _reset_minor_tick_kw(self):\n         self._minor_tick_kw.clear()\n         self._minor_tick_kw['gridOn'] = (\n                 mpl.rcParams['axes.grid'] and\n                 mpl.rcParams['axes.grid.which'] in ('both', 'minor'))\n+        # Minor ticks share the same side visibility defaults as major ticks.\n+        try:\n+            from .axis import XAxis, YAxis\n+        except Exception:\n+            XAxis = YAxis = None\n+        if XAxis is not None and isinstance(self, XAxis):\n+            self._minor_tick_kw['top'] = mpl.rcParams['xtick.top']\n+            self._minor_tick_kw['bottom'] = mpl.rcParams['xtick.bottom']\n+            self._minor_tick_kw['labeltop'] = mpl.rcParams.get('xtick.labeltop', False)\n+            self._minor_tick_kw['labelbottom'] = mpl.rcParams.get('xtick.labelbottom', True)\n+        elif YAxis is not None and isinstance(self, YAxis):\n+            self._minor_tick_kw['left'] = mpl.rcParams['ytick.left']\n+            self._minor_tick_kw['right'] = mpl.rcParams['ytick.right']\n+            self._minor_tick_kw['labelleft'] = mpl.rcParams.get('ytick.labelleft', True)\n+            self._minor_tick_kw['labelright'] = mpl.rcParams.get('ytick.labelright', False)\n \n     def clear(self):\n         \"\"\"\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/lib/matplotlib/axis.py b/lib/matplotlib/axis.py\nindex 93c576e..5ef7283 100644\n--- a/lib/matplotlib/axis.py\n+++ b/lib/matplotlib/axis.py\n@@ -785,6 +785,20 @@ class Axis(martist.Artist):\n                 mpl.rcParams['axes.grid'] and\n                 mpl.rcParams['axes.grid.which'] in ('both', 'minor'))\n \n+        # Set default minor tick visibility based on axis orientation.\n+        axis_name = getattr(self, \"axis_name\", None)\n+        if axis_name == 'x':\n+            self._minor_tick_kw['tick1On'] = mpl.rcParams['xtick.bottom']\n+            self._minor_tick_kw['tick2On'] = mpl.rcParams['xtick.top']\n+            # Minor tick labels are typically not shown by default.\n+            self._minor_tick_kw['label1On'] = False\n+            self._minor_tick_kw['label2On'] = False\n+        elif axis_name == 'y':\n+            self._minor_tick_kw['tick1On'] = mpl.rcParams['ytick.left']\n+            self._minor_tick_kw['tick2On'] = mpl.rcParams['ytick.right']\n+            self._minor_tick_kw['label1On'] = False\n+            self._minor_tick_kw['label2On'] = False\n+\n     def clear(self):\n         \"\"\"\n         Clear the axis.\n@@ -806,8 +820,24 @@ class Axis(martist.Artist):\n         # Clear the callback registry for this axis, or it may \"leak\"\n         self.callbacks = cbook.CallbackRegistry()\n \n+        # Preserve current tick/label visibility defaults so that shared axes\n+        # and custom tick visibility survive a clear().\n+        prev_major_vis = {k: self._major_tick_kw.get(k)\n+                          for k in ('tick1On', 'tick2On', 'label1On', 'label2On')}\n+        prev_minor_vis = {k: self._minor_tick_kw.get(k)\n+                          for k in ('tick1On', 'tick2On', 'label1On', 'label2On')}\n+\n         self._reset_major_tick_kw()\n         self._reset_minor_tick_kw()\n+\n+        # Restore preserved visibility settings if previously set.\n+        for k, v in prev_major_vis.items():\n+            if v is not None:\n+                self._major_tick_kw[k] = v\n+        for k, v in prev_minor_vis.items():\n+            if v is not None:\n+                self._minor_tick_kw[k] = v\n+\n         self.reset_ticks()\n \n         self.converter = None\n",
  "7_resolved": true
}