{
  "instance_id": "SWE-Bench-Verified__python__maintenance__bugfix__227490c2",
  "original_id": "django__django-14311",
  "1_model_selected_files": [
    "django/utils/autoreload.py",
    "django/utils/module_loading.py",
    "django/__main__.py"
  ],
  "2_embedding_selected_files": [
    "django/utils/autoreload.py",
    "django/core/management/commands/runserver.py",
    "django/template/autoreload.py",
    "django/utils/module_loading.py",
    "django/contrib/staticfiles/management/commands/runserver.py",
    "django/core/management/__init__.py",
    "django/__main__.py",
    "django/core/servers/__init__.py",
    "django/utils/translation/reloader.py",
    "django/template/loaders/__init__.py",
    "django/core/checks/urls.py",
    "django/utils/deprecation.py",
    "django/utils/deconstruct.py",
    "django/core/servers/basehttp.py",
    "django/setup.py",
    "django/utils/__init__.py",
    "django/core/handlers/__init__.py",
    "django/core/checks/security/csrf.py",
    "django/core/management/commands/loaddata.py",
    "django/core/management/utils.py",
    "django/core/checks/compatibility/__init__.py",
    "django/core/management/commands/migrate.py",
    "django/core/checks/async_checks.py",
    "django/core/checks/templates.py",
    "django/core/__init__.py",
    "django/core/management/base.py",
    "django/core/checks/compatibility/django_4_0.py",
    "django/contrib/__init__.py",
    "django/utils/asyncio.py",
    "django/core/management/commands/check.py",
    "django/core/management/commands/shell.py",
    "django/utils/decorators.py",
    "django/core/serializers/xml_serializer.py",
    "django/core/checks/__init__.py",
    "django/template/loaders/locmem.py",
    "django/core/serializers/__init__.py",
    "django/core/management/commands/dbshell.py",
    "django/core/serializers/base.py",
    "django/__init__.py",
    "django/core/management/commands/squashmigrations.py",
    "django/contrib/staticfiles/utils.py",
    "django/core/management/commands/makemigrations.py",
    "django/core/management/commands/diffsettings.py",
    "django/utils/datetime_safe.py",
    "django/core/management/commands/makemessages.py",
    "django/template/loaders/app_directories.py",
    "django/core/management/commands/__init__.py",
    "django/core/checks/model_checks.py",
    "django/contrib/staticfiles/handlers.py",
    "django/core/serializers/python.py",
    "django/core/cache/backends/__init__.py",
    "django/core/checks/security/__init__.py",
    "django/contrib/staticfiles/management/commands/__init__.py",
    "django/contrib/staticfiles/__init__.py",
    "django/core/management/commands/inspectdb.py",
    "django/core/cache/backends/memcached.py",
    "django/contrib/staticfiles/finders.py",
    "django/core/management/commands/sqlmigrate.py",
    "django/core/checks/security/sessions.py",
    "django/core/mail/backends/__init__.py",
    "django/template/backends/django.py",
    "django/core/serializers/pyyaml.py",
    "django/core/checks/caches.py",
    "django/template/loaders/filesystem.py",
    "django/template/backends/__init__.py",
    "django/utils/inspect.py",
    "django/template/loaders/cached.py",
    "django/utils/html.py",
    "django/core/exceptions.py",
    "django/core/checks/security/base.py",
    "django/core/checks/database.py",
    "django/contrib/staticfiles/management/__init__.py",
    "django/core/handlers/base.py",
    "django/shortcuts.py",
    "django/template/__init__.py",
    "django/core/management/commands/flush.py",
    "django/utils/_os.py",
    "django/core/cache/backends/locmem.py",
    "django/contrib/staticfiles/checks.py",
    "django/core/cache/backends/db.py",
    "django/core/handlers/asgi.py",
    "django/core/wsgi.py",
    "django/core/management/commands/startapp.py",
    "django/core/files/utils.py",
    "django/core/handlers/exception.py",
    "django/core/files/locks.py",
    "django/utils/translation/__init__.py"
  ],
  "3_final_combined_files": [
    "django/utils/autoreload.py",
    "django/utils/module_loading.py",
    "django/__main__.py",
    "django/core/management/commands/runserver.py",
    "django/template/autoreload.py"
  ],
  "4_related_elements": {
    "django/utils/autoreload.py": [
      "function: get_child_arguments\nfunction: restart_with_reloader\nfunction: run_with_reloader\nfunction: is_django_module"
    ],
    "django/utils/module_loading.py": [
      ""
    ],
    "django/__main__.py": [
      ""
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "django/utils/autoreload.py": [
          "\nfunction: get_child_arguments\nline: 226\nline: 227"
        ]
      },
      "patches": [
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..ff4d66a 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,11 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None and getattr(spec, 'name', None):\n+        # Preserve the full dotted module path passed to `-m` (e.g. \"foo.bar.baz\"),\n+        # instead of truncating to the parent package.\n+        args += ['-m', spec.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..ddafb1e 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,9 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        # If started with `python -m`, re-execute the same module, not its parent.\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..a15c56a 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,9 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None and getattr(spec, 'name', None):\n+        args += ['-m', spec.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..3590508 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,11 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None and getattr(spec, 'name', None):\n+        # Preserve the original dotted module name passed to -m (works for both\n+        # packages and modules).\n+        args += ['-m', spec.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..2b43997 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,9 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        # Re-execute with the original module entry point used by -m.\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..99880e2 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,8 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..99880e2 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,8 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..3f92040 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,11 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        # Preserve the originally invoked module name when using `-m`.\n+        # For packages executed via `-m`, this will be '<package>.__main__',\n+        # and for modules it will be the full dotted path (e.g. 'foo.bar.baz').\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..618774e 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,10 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None and getattr(spec, 'name', None):\n+        # Preserve the fully qualified module name passed to -m.\n+        args += ['-m', spec.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..20a1661 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,10 +223,19 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n-        args += sys.argv[1:]\n-    elif not py_script.exists():\n+    if getattr(__main__, '__spec__', None) is not None:\n+        spec = __main__.__spec__\n+        module = getattr(spec, 'name', None)\n+        if module:\n+            # Preserve the full module path when started with \"python -m\".\n+            # If a package's __main__ is executed (e.g., \"django.__main__\"),\n+            # strip the trailing \".__main__\" to keep the original package name.\n+            if module.endswith('.__main__'):\n+                module = module[:-len('.__main__')]\n+            args += ['-m', module]\n+            args += sys.argv[1:]\n+            return args\n+    if not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n         # It may exist with a .exe extension or have a -script.py suffix.\n         exe_entrypoint = py_script.with_suffix('.exe')\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "django/utils/autoreload.py": [
          "\nfunction: get_child_arguments\nline: 226\nline: 227"
        ]
      },
      "patches": [
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..c9aae32 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,13 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        mod_name = __main__.__spec__.name\n+        # If run as \"python -m package\", spec.name is \"package.__main__\".\n+        # Restart with the package name to mirror the original invocation.\n+        if mod_name.endswith('.__main__'):\n+            mod_name = mod_name[: -len('.__main__')]\n+        args += ['-m', mod_name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..0543fa2 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,9 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        # Preserve the exact module path used with -m (e.g., package.module or package.module.submodule)\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..43e49da 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,10 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        # If launched with \"python -m <module>\", re-execute the same module (which may be a\n+        # dotted module path), rather than its parent package.\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..88ec777 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,12 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None and (spec.name or spec.parent):\n+        target = spec.name or spec.parent\n+        if target.endswith('.__main__'):\n+            target = spec.parent\n+        args += ['-m', target]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..7b1f2fe 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,10 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.name:\n+        # Re-execute using the original module path passed to -m, which may be a\n+        # package (__main__.py) or a module (e.g. foo.bar.baz).\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..639984f 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,13 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        module_name = __main__.__spec__.name\n+        # If -m was used with a package, __spec__.name may be 'pkg.__main__'.\n+        # In that case, use the parent package name for reloading.\n+        if module_name.endswith('.__main__'):\n+            module_name = __main__.__spec__.parent or module_name.rsplit('.__main__', 1)[0]\n+        args += ['-m', module_name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..8804a8c 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,8 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..8804a8c 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,8 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..91a8157 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,10 +223,19 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n-        args += sys.argv[1:]\n-    elif not py_script.exists():\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None:\n+        # Determine the module name used with the -m flag.\n+        # If a package was executed (i.e., __main__ inside a package),\n+        # spec.name may be \"<pkg>.__main__\", so use the parent package name.\n+        module_name = spec.parent if spec.name == f'{spec.parent}.__main__' else spec.name\n+        if module_name:\n+            args += ['-m', module_name]\n+            args += sys.argv[1:]\n+        else:\n+            # If we cannot determine module name, fall back to script execution.\n+            spec = None\n+    if spec is None and not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n         # It may exist with a .exe extension or have a -script.py suffix.\n         exe_entrypoint = py_script.with_suffix('.exe')\n@@ -238,7 +247,7 @@ def get_child_arguments():\n             # Should be executed as usual.\n             return [*args, script_entrypoint, *sys.argv[1:]]\n         raise RuntimeError('Script %s does not exist.' % py_script)\n-    else:\n+    elif spec is None:\n         args += sys.argv\n     return args\n \n"
      ]
    },
    {
      "sample_index": 2,
      "edit_locs": {
        "django/utils/autoreload.py": [
          "\nfunction: get_child_arguments\nline: 226\nline: 227\nline: 228"
        ]
      },
      "patches": [
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..869c050 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,10 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        # When started with \"python -m\", preserve the full dotted module path,\n+        # not just the parent package.\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..99880e2 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,8 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..99880e2 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,8 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..0d8648b 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,9 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        # Use the full module name when reloading with \"python -m\".\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..729ce91 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,9 +223,25 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n-        args += sys.argv[1:]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None:\n+        # Determine the correct module target for -m re-execution.\n+        # If a package was executed (i.e., spec.name ends with \".__main__\"),\n+        # use the parent package name. Otherwise, use the full module name.\n+        module = None\n+        spec_name = getattr(spec, 'name', None)\n+        if spec_name:\n+            if spec_name.endswith('.__main__') and getattr(spec, 'parent', None):\n+                module = spec.parent\n+            else:\n+                module = spec_name\n+        elif getattr(spec, 'parent', None):\n+            module = spec.parent\n+        if module:\n+            args += ['-m', module]\n+            args += sys.argv[1:]\n+        else:\n+            args += sys.argv\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n         # It may exist with a .exe extension or have a -script.py suffix.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..ca6a789 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,10 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None and (spec.name or spec.parent):\n+        module_name = spec.parent if (spec.name and spec.name.endswith('.__main__')) else (spec.name or spec.parent)\n+        args += ['-m', module_name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..49902b5 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,11 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        # When invoked with \"python -m\", re-execute with the original module name.\n+        # Use __spec__.name so both packages and dotted modules (e.g., foo.bar.baz)\n+        # are handled correctly.\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..3c6248f 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,10 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        # If launched with \"python -m\", re-execute using the exact module name\n+        # to support both packages and modules (e.g., foo.bar and foo.bar.baz).\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..55bb062 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,9 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    # Use the full module name to preserve dotted module paths, e.g., \"foo.bar.baz\".\n+    if getattr(__main__, '__spec__', None) is not None and getattr(__main__.__spec__, 'name', None):\n+        args += ['-m', __main__.__spec__.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..9090e07 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,14 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        spec = __main__.__spec__\n+        module_name = getattr(spec, 'name', None)\n+        # If started as \"python -m <package>\", __main__ may be \"<package>.__main__\".\n+        # Use the package name in that case. Otherwise, use the full module name.\n+        if module_name and module_name.endswith('.__main__') and spec.parent:\n+            module_name = spec.parent\n+        args += ['-m', module_name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n"
      ]
    },
    {
      "sample_index": 3,
      "edit_locs": {
        "django/utils/autoreload.py": [
          "\nfunction: get_child_arguments\nline: 226\nline: 227\nline: 228"
        ]
      },
      "patches": [
        "",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..a15c56a 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,9 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None and getattr(spec, 'name', None):\n+        args += ['-m', spec.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..9c19a58 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,10 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec and getattr(spec, 'name', None):\n+        # Preserve the original `-m` invocation with the full module name.\n+        args += ['-m', spec.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..d08eb9c 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -222,9 +222,11 @@ def get_child_arguments():\n     args = [sys.executable] + ['-W%s' % o for o in sys.warnoptions]\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n+    # Use the spec name so that dotted module names are preserved.\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None and getattr(spec, 'name', None):\n+        args += ['-m', spec.name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..7767d53 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,12 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None and (spec.parent or spec.name):\n+        # When executed with \"python -m\", __spec__.name is the full module path.\n+        # For packages, __spec__.name ends with \".__main__\", so use the parent.\n+        module = spec.parent if spec.name and spec.name.endswith('.__main__') else spec.name\n+        args += ['-m', module]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..43d6aea 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,9 +223,18 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n-        args += sys.argv[1:]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        spec = __main__.__spec__\n+        # If started with \"python -m\", re-execute with the same module.\n+        # For packages, __main__ is executed and spec.name ends with \".__main__\".\n+        # In that case, use the parent package; otherwise use the full module name.\n+        module = spec.parent if getattr(spec, 'name', None) and spec.name.endswith('.__main__') else getattr(spec, 'name', None)\n+        if module:\n+            args += ['-m', module]\n+            args += sys.argv[1:]\n+        else:\n+            # Fallback to default behavior.\n+            args += sys.argv\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n         # It may exist with a .exe extension or have a -script.py suffix.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..90bf7cb 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,16 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None:\n+        # If started with `-m`, spec.name is either \"<pkg>.__main__\" for packages\n+        # or the fully qualified module name for modules. Use the parent only for\n+        # package execution, otherwise use the full module name.\n+        if spec.name and spec.name.endswith('.__main__'):\n+            module = spec.parent or spec.name\n+        else:\n+            module = spec.name\n+        args += ['-m', module]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..484b9d5 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,13 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    # When started with -m, recreate the same invocation.\n+    # For packages executed with -m, spec.name ends with '.__main__' and we must\n+    # pass the parent package. For modules, pass the full dotted name.\n+    if spec is not None and getattr(spec, 'name', None):\n+        module = spec.parent if spec.name.endswith('.__main__') else spec.name\n+        args += ['-m', module]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..6fb4060 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,9 +223,20 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n-        args += sys.argv[1:]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        spec = __main__.__spec__\n+        module_name = getattr(spec, 'name', None)\n+        # If run as \"python -m package\", spec.name may be \"package.__main__\".\n+        # In that case, use the parent package name. Otherwise, use the full\n+        # module name (e.g. \"package.module\").\n+        if module_name:\n+            if module_name.endswith('.__main__'):\n+                module_name = spec.parent or module_name[: -len('.__main__')]\n+            args += ['-m', module_name]\n+            args += sys.argv[1:]\n+        elif spec.parent:\n+            args += ['-m', spec.parent]\n+            args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n         # It may exist with a .exe extension or have a -script.py suffix.\n",
        "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..fccedfd 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,14 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    spec = getattr(__main__, '__spec__', None)\n+    if spec is not None:\n+        # Use the original module target for `-m`. If a package was executed\n+        # (spec.name ends with \".__main__\"), prefer its parent package name.\n+        module = spec.name\n+        if module.endswith('.__main__') and spec.parent:\n+            module = spec.parent\n+        args += ['-m', module]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/django/utils/autoreload.py b/django/utils/autoreload.py\nindex ac16894..c9aae32 100644\n--- a/django/utils/autoreload.py\n+++ b/django/utils/autoreload.py\n@@ -223,8 +223,13 @@ def get_child_arguments():\n     # __spec__ is set when the server was started with the `-m` option,\n     # see https://docs.python.org/3/reference/import.html#main-spec\n     # __spec__ may not exist, e.g. when running in a Conda env.\n-    if getattr(__main__, '__spec__', None) is not None and __main__.__spec__.parent:\n-        args += ['-m', __main__.__spec__.parent]\n+    if getattr(__main__, '__spec__', None) is not None:\n+        mod_name = __main__.__spec__.name\n+        # If run as \"python -m package\", spec.name is \"package.__main__\".\n+        # Restart with the package name to mirror the original invocation.\n+        if mod_name.endswith('.__main__'):\n+            mod_name = mod_name[: -len('.__main__')]\n+        args += ['-m', mod_name]\n         args += sys.argv[1:]\n     elif not py_script.exists():\n         # sys.argv[0] may not exist for several reasons on Windows.\n",
  "7_resolved": true
}