{
  "instance_id": "SWE-Bench-Verified__python__maintenance__bugfix__1409977d",
  "original_id": "pylint-dev__pylint-4604",
  "1_model_selected_files": [
    "pylint/checkers/imports.py",
    "pylint/checkers/utils.py",
    "pylint/extensions/redefined_variable_type.py",
    "pylint/extensions/typing.py",
    "pylint/checkers/variables.py"
  ],
  "2_embedding_selected_files": [
    "pylint/checkers/base.py",
    "pylint/checkers/imports.py",
    "pylint/checkers/stdlib.py",
    "pylint/checkers/variables.py",
    "pylint/checkers/python3.py",
    "pylint/checkers/utils.py",
    "pylint/constants.py",
    "pylint/checkers/design_analysis.py",
    "pylint/checkers/typecheck.py",
    "pylint/checkers/classes.py",
    "pylint/checkers/exceptions.py",
    "pylint/checkers/newstyle.py",
    "pylint/checkers/misc.py",
    "pylint/__main__.py",
    "pylint/pyreverse/inspector.py",
    "pylint/utils/__init__.py",
    "pylint/checkers/async.py",
    "pylint/__init__.py",
    "pylint/pyreverse/utils.py",
    "pylint/checkers/spelling.py",
    "pylint/checkers/deprecated.py",
    "pylint/checkers/strings.py",
    "pylint/utils/file_state.py",
    "pylint/pyreverse/__init__.py",
    "pylint/epylint.py",
    "pylint/utils/pragma_parser.py",
    "pylint/checkers/format.py",
    "pylint/__pkginfo__.py",
    "pylint/exceptions.py",
    "pylint/checkers/mapreduce_checker.py",
    "pylint/checkers/logging.py"
  ],
  "3_final_combined_files": [
    "pylint/checkers/imports.py",
    "pylint/checkers/utils.py",
    "pylint/extensions/redefined_variable_type.py",
    "pylint/checkers/base.py",
    "pylint/checkers/stdlib.py"
  ],
  "4_related_elements": {
    "pylint/checkers/imports.py": [
      "variable: MSGS\nclass: ImportsChecker"
    ],
    "pylint/checkers/utils.py": [
      "function: is_node_in_type_annotation_context\nfunction: is_attribute_typed_annotation\nfunction: is_assign_name_annotated_with"
    ],
    "pylint/extensions/redefined_variable_type.py": [
      ""
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "pylint/checkers/utils.py": [
          "\nfunction: is_node_in_type_annotation_context"
        ]
      },
      "patches": [
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..175e5a0 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or a type comment on an assignment/other supported node.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,11 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            # Support for PEP 484/526 type comments parsed by astroid.\n+            # astroid attaches the parsed annotation tree to 'type_annotation'\n+            # (or, in some versions, 'type_comment') on nodes such as Assign.\n+            or getattr(parent_node, \"type_annotation\", None) == current_node\n+            or getattr(parent_node, \"type_comment\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..25fff6c 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1318,8 +1318,8 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n     \"\"\"Check if node is in type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    Check for 'AnnAssign', 'Assign' with type comments, function 'Arguments',\n+    or part of function return type annotation.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1327,6 +1327,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n         if (\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..060561f 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1318,8 +1318,8 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n     \"\"\"Check if node is in type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    Check for 'AnnAssign', assignment type comments ('Assign' with type_annotation),\n+    function 'Arguments', or part of function return type annotation.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1327,6 +1327,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n         if (\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..fe4bbb0 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or a variable assignment's type comment (PEP 484).\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1327,6 +1328,11 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n         if (\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and (\n+                getattr(parent_node, \"type_annotation\", None) == current_node\n+                or getattr(parent_node, \"type_comment\", None) == current_node\n+            )\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..e67a0c0 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or in a type comment (e.g., Assign with a type_comment).\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1327,6 +1328,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n         if (\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..2c48899 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or type comments on assignments.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..69e24ed 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or an Assign node with a type comment.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..97be3a9 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1316,10 +1316,11 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n \n \n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n-    \"\"\"Check if node is in type annotation context.\n+    \"\"\"Check if node is in a type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or assignment type comments (PEP 484).\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,11 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and (\n+                getattr(parent_node, \"type_annotation\", None) == current_node\n+                or getattr(parent_node, \"type_comment\", None) == current_node\n+            )\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..e3ae8db 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1316,10 +1316,11 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n \n \n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n-    \"\"\"Check if node is in type annotation context.\n+    \"\"\"Check if node is in a type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of a function return type annotation,\n+    or assignments with a PEP 484 type comment.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,11 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and (\n+                getattr(parent_node, \"type_annotation\", None) is not None\n+                or getattr(parent_node, \"type_comment\", None) is not None\n+            )\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..09a77c5 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1316,17 +1316,22 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n \n \n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n-    \"\"\"Check if node is in type annotation context.\n+    \"\"\"Check if node is in a type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    This includes:\n+    - Variable annotations (AnnAssign)\n+    - Function argument annotations (Arguments)\n+    - Function return type annotations (FunctionDef.returns)\n+    - Type comments (PEP 484) parsed by astroid on Assign/For/With nodes\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n     while True:\n         if (\n+            # Variable annotations (PEP 526)\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            # Function arguments annotations\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n@@ -1336,8 +1341,16 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n                 parent_node.varargannotation,\n                 parent_node.kwargannotation,\n             )\n+            # Function return type annotation\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            # Type comments (PEP 484) on Assign/For/With\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n+            or isinstance(parent_node, astroid.For)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n+            or isinstance(parent_node, astroid.With)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "pylint/checkers/utils.py": [
          "\nfunction: is_node_in_type_annotation_context"
        ]
      },
      "patches": [
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..899a717 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1316,10 +1316,13 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n \n \n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n-    \"\"\"Check if node is in type annotation context.\n+    \"\"\"Check if node is in a type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    This includes:\n+    - Variable annotations (AnnAssign)\n+    - Function argument annotations (Arguments)\n+    - Function return type annotations (FunctionDef.returns)\n+    - Type comments parsed by astroid (type_comment / type_annotation on nodes)\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1341,11 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            # Handle type comments and parsed type annotations attached to nodes\n+            or hasattr(parent_node, \"type_annotation\")\n+            and parent_node.type_annotation == current_node\n+            or hasattr(parent_node, \"type_comment\")\n+            and parent_node.type_comment == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..dcb8ac5 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or an assignment type comment (PEP 484).\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..c178a5a 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1318,26 +1318,42 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n     \"\"\"Check if node is in type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    Check for 'AnnAssign', variable 'Assign' with a type comment,\n+    function 'Arguments', or part of function return type annotation or type comment.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n     while True:\n         if (\n-            isinstance(parent_node, astroid.AnnAssign)\n-            and parent_node.annotation == current_node\n-            or isinstance(parent_node, astroid.Arguments)\n-            and current_node\n-            in (\n-                *parent_node.annotations,\n-                *parent_node.posonlyargs_annotations,\n-                *parent_node.kwonlyargs_annotations,\n-                parent_node.varargannotation,\n-                parent_node.kwargannotation,\n+            (\n+                isinstance(parent_node, astroid.AnnAssign)\n+                and parent_node.annotation == current_node\n+            )\n+            or (\n+                isinstance(parent_node, astroid.Assign)\n+                and (\n+                    getattr(parent_node, \"type_annotation\", None) == current_node\n+                    or getattr(parent_node, \"type_comment\", None) == current_node\n+                )\n+            )\n+            or (\n+                isinstance(parent_node, astroid.Arguments)\n+                and current_node\n+                in (\n+                    *parent_node.annotations,\n+                    *parent_node.posonlyargs_annotations,\n+                    *parent_node.kwonlyargs_annotations,\n+                    parent_node.varargannotation,\n+                    parent_node.kwargannotation,\n+                )\n+            )\n+            or (\n+                isinstance(parent_node, astroid.FunctionDef)\n+                and (\n+                    parent_node.returns == current_node\n+                    or getattr(parent_node, \"type_comment\", None) == current_node\n+                )\n             )\n-            or isinstance(parent_node, astroid.FunctionDef)\n-            and parent_node.returns == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..762b9f6 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or type comments (PEP 484) attached to assignments.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..d60b0c6 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or assignment type comments (PEP 484).\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..646a887 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,25 +1319,47 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    function return type annotation, or type comments (PEP 484).\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n     while True:\n         if (\n-            isinstance(parent_node, astroid.AnnAssign)\n-            and parent_node.annotation == current_node\n-            or isinstance(parent_node, astroid.Arguments)\n-            and current_node\n-            in (\n-                *parent_node.annotations,\n-                *parent_node.posonlyargs_annotations,\n-                *parent_node.kwonlyargs_annotations,\n-                parent_node.varargannotation,\n-                parent_node.kwargannotation,\n+            (\n+                isinstance(parent_node, astroid.AnnAssign)\n+                and parent_node.annotation == current_node\n+            )\n+            or (\n+                isinstance(parent_node, astroid.Arguments)\n+                and current_node\n+                in (\n+                    *parent_node.annotations,\n+                    *parent_node.posonlyargs_annotations,\n+                    *parent_node.kwonlyargs_annotations,\n+                    parent_node.varargannotation,\n+                    parent_node.kwargannotation,\n+                )\n+            )\n+            or (\n+                isinstance(parent_node, astroid.FunctionDef)\n+                and parent_node.returns == current_node\n+            )\n+            # Handle type comments (PEP 484) on assignments, e.g.:\n+            # X = ...  # type: abc.ABC\n+            # Astroid parses the type comment into an annotation tree\n+            # available as Assign.type_annotation. When walking up from a\n+            # name used in the type comment, the root of that tree will be\n+            # the current node, and its parent will be the Assign node.\n+            or (\n+                isinstance(parent_node, astroid.Assign)\n+                and getattr(parent_node, \"type_annotation\", None) == current_node\n+            )\n+            # Handle function return type comments, e.g.:\n+            # def f():  # type: (...) -> abc.ABC\n+            or (\n+                isinstance(parent_node, astroid.FunctionDef)\n+                and getattr(parent_node, \"type_comment_returns\", None) == current_node\n             )\n-            or isinstance(parent_node, astroid.FunctionDef)\n-            and parent_node.returns == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..e1c5557 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1318,26 +1318,36 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n     \"\"\"Check if node is in type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    Check for 'AnnAssign', 'Assign' with a type comment, function 'Arguments',\n+    or part of function return type annotation.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n     while True:\n         if (\n-            isinstance(parent_node, astroid.AnnAssign)\n-            and parent_node.annotation == current_node\n-            or isinstance(parent_node, astroid.Arguments)\n-            and current_node\n-            in (\n-                *parent_node.annotations,\n-                *parent_node.posonlyargs_annotations,\n-                *parent_node.kwonlyargs_annotations,\n-                parent_node.varargannotation,\n-                parent_node.kwargannotation,\n+            (\n+                isinstance(parent_node, astroid.AnnAssign)\n+                and parent_node.annotation == current_node\n+            )\n+            or (\n+                isinstance(parent_node, astroid.Assign)\n+                and getattr(parent_node, \"type_annotation\", None) == current_node\n+            )\n+            or (\n+                isinstance(parent_node, astroid.Arguments)\n+                and current_node\n+                in (\n+                    *parent_node.annotations,\n+                    *parent_node.posonlyargs_annotations,\n+                    *parent_node.kwonlyargs_annotations,\n+                    parent_node.varargannotation,\n+                    parent_node.kwargannotation,\n+                )\n+            )\n+            or (\n+                isinstance(parent_node, astroid.FunctionDef)\n+                and parent_node.returns == current_node\n             )\n-            or isinstance(parent_node, astroid.FunctionDef)\n-            and parent_node.returns == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..54a4d4d 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1318,8 +1318,11 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n     \"\"\"Check if node is in type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    Includes:\n+    - PEP 526 annotations (AnnAssign)\n+    - Function argument annotations (Arguments)\n+    - Function return annotations (FunctionDef.returns)\n+    - Variable type comments on Assign nodes (Assign.type_annotation)\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1341,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..41b1dd0 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,14 +1319,18 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    function return type annotation, or PEP 484 type comments\n+    (stored in 'type_annotation' on astroid nodes).\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n-    while True:\n+    # Walk up the tree until we reach the module (or no parent).\n+    while parent_node:\n         if (\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            or hasattr(parent_node, \"type_annotation\")\n+            and getattr(parent_node, \"type_annotation\") == current_node\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n@@ -1341,8 +1345,7 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n-        if isinstance(parent_node, astroid.Module):\n-            return False\n+    return False\n \n \n def is_subclass_of(child: astroid.ClassDef, parent: astroid.ClassDef) -> bool:\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..8eec6d2 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,7 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    function return type annotation, or a type comment (PEP 484) on an assignment.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1338,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n"
      ]
    },
    {
      "sample_index": 2,
      "edit_locs": {
        "pylint/checkers/utils.py": [
          "\nfunction: is_node_in_type_annotation_context"
        ]
      },
      "patches": [
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..894de3a 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1318,15 +1318,20 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n     \"\"\"Check if node is in type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    Check for 'AnnAssign', type comments on 'Assign',\n+    function 'Arguments' annotations,\n+    or part of function return type annotation.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n-    while True:\n+    while parent_node is not None:\n+        if isinstance(parent_node, astroid.Module):\n+            return False\n         if (\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n@@ -1341,8 +1346,7 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n-        if isinstance(parent_node, astroid.Module):\n-            return False\n+    return False\n \n \n def is_subclass_of(child: astroid.ClassDef, parent: astroid.ClassDef) -> bool:\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..60fb1f2 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1318,8 +1318,8 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n     \"\"\"Check if node is in type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    Check for 'AnnAssign', 'Assign' type comments, function 'Arguments',\n+    or part of function return type annotation.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1327,6 +1327,12 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n         if (\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and current_node\n+            in (\n+                getattr(parent_node, \"type_annotation\", None),\n+                getattr(parent_node, \"type_comment\", None),\n+            )\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..0b49790 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or an 'Assign' with a type comment.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,11 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and (\n+                getattr(parent_node, \"type_annotation\", None) == current_node\n+                or getattr(parent_node, \"type_comment\", None) == current_node\n+            )\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..d8b6eba 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1316,10 +1316,13 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n \n \n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n-    \"\"\"Check if node is in type annotation context.\n+    \"\"\"Check if node is in a type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    This includes:\n+    - AnnAssign annotations (x: T = ...)\n+    - Function argument annotations\n+    - Function return type annotations\n+    - Type comments on assignments (x = ...  # type: T)\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1341,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..470e021 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1315,11 +1315,25 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n     )\n \n \n+def _is_descendant_of(\n+    node: astroid.node_classes.NodeNG, ancestor: astroid.node_classes.NodeNG\n+) -> bool:\n+    \"\"\"Return True if 'node' is within the subtree rooted at 'ancestor'.\"\"\"\n+    if ancestor is None:\n+        return False\n+    current = node\n+    while current is not None and not isinstance(current, astroid.Module):\n+        if current is ancestor:\n+            return True\n+        current = current.parent\n+    return False\n+\n+\n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation, or PEP 484 type comments on assignments.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1352,10 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and hasattr(parent_node, \"type_annotation\")\n+            and parent_node.type_annotation is not None\n+            and _is_descendant_of(current_node, parent_node.type_annotation)\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..3d8021f 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,30 +1319,58 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    function return type annotation, or PEP 484 type comments.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n-    while True:\n+    while parent_node is not None:\n         if (\n-            isinstance(parent_node, astroid.AnnAssign)\n-            and parent_node.annotation == current_node\n-            or isinstance(parent_node, astroid.Arguments)\n-            and current_node\n-            in (\n-                *parent_node.annotations,\n-                *parent_node.posonlyargs_annotations,\n-                *parent_node.kwonlyargs_annotations,\n-                parent_node.varargannotation,\n-                parent_node.kwargannotation,\n+            (\n+                isinstance(parent_node, astroid.AnnAssign)\n+                and parent_node.annotation == current_node\n+            )\n+            or (\n+                isinstance(parent_node, astroid.Arguments)\n+                and current_node\n+                in (\n+                    *parent_node.annotations,\n+                    *parent_node.posonlyargs_annotations,\n+                    *parent_node.kwonlyargs_annotations,\n+                    parent_node.varargannotation,\n+                    parent_node.kwargannotation,\n+                )\n+            )\n+            or (\n+                isinstance(parent_node, astroid.FunctionDef)\n+                and parent_node.returns == current_node\n+            )\n+            # Support type comments/annotations on assignments and function defs\n+            or (\n+                hasattr(parent_node, \"type_annotation\")\n+                and getattr(parent_node, \"type_annotation\") is not None\n+                and (\n+                    current_node == getattr(parent_node, \"type_annotation\")\n+                    or (\n+                        isinstance(getattr(parent_node, \"type_annotation\"), (list, tuple))\n+                        and current_node in getattr(parent_node, \"type_annotation\")\n+                    )\n+                )\n+            )\n+            or (\n+                hasattr(parent_node, \"type_comment\")\n+                and getattr(parent_node, \"type_comment\") is not None\n+                and (\n+                    current_node == getattr(parent_node, \"type_comment\")\n+                    or (\n+                        isinstance(getattr(parent_node, \"type_comment\"), (list, tuple))\n+                        and current_node in getattr(parent_node, \"type_comment\")\n+                    )\n+                )\n             )\n-            or isinstance(parent_node, astroid.FunctionDef)\n-            and parent_node.returns == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n-        if isinstance(parent_node, astroid.Module):\n-            return False\n+    return False\n \n \n def is_subclass_of(child: astroid.ClassDef, parent: astroid.ClassDef) -> bool:\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..c8f4c4e 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or type comments (e.g. Assign.type_annotation).\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,7 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..e59996c 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,25 +1319,36 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation, or legacy PEP 484 type comments\n+    (e.g. '# type: ...') on assignments.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n     while True:\n         if (\n-            isinstance(parent_node, astroid.AnnAssign)\n-            and parent_node.annotation == current_node\n-            or isinstance(parent_node, astroid.Arguments)\n-            and current_node\n-            in (\n-                *parent_node.annotations,\n-                *parent_node.posonlyargs_annotations,\n-                *parent_node.kwonlyargs_annotations,\n-                parent_node.varargannotation,\n-                parent_node.kwargannotation,\n+            (\n+                isinstance(parent_node, astroid.AnnAssign)\n+                and parent_node.annotation == current_node\n+            )\n+            or (\n+                isinstance(parent_node, astroid.Arguments)\n+                and current_node\n+                in (\n+                    *parent_node.annotations,\n+                    *parent_node.posonlyargs_annotations,\n+                    *parent_node.kwonlyargs_annotations,\n+                    parent_node.varargannotation,\n+                    parent_node.kwargannotation,\n+                )\n+            )\n+            or (\n+                isinstance(parent_node, astroid.FunctionDef)\n+                and parent_node.returns == current_node\n+            )\n+            or (\n+                isinstance(parent_node, astroid.Assign)\n+                and getattr(parent_node, \"type_comment\", None) is not None\n             )\n-            or isinstance(parent_node, astroid.FunctionDef)\n-            and parent_node.returns == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        ""
      ]
    },
    {
      "sample_index": 3,
      "edit_locs": {
        "pylint/checkers/utils.py": [
          "\nfunction: is_node_in_type_annotation_context"
        ]
      },
      "patches": [
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..581acdd 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or type comments parsed as type annotations (e.g., '# type: ...').\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or hasattr(parent_node, \"type_annotation\")\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..b519511 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1318,8 +1318,8 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n     \"\"\"Check if node is in type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    Check for 'AnnAssign', 'Assign' with a type comment,\n+    function 'Arguments', or part of a function return type annotation.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1327,6 +1327,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n         if (\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..47a7f96 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,7 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation, or a PEP 484 type comment.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1338,11 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, (astroid.Assign, astroid.For, astroid.With))\n+            and (\n+                getattr(parent_node, \"type_annotation\", None) == current_node\n+                or getattr(parent_node, \"type_comment\", None) == current_node\n+            )\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..c2dfa02 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or a type comment (e.g. '# type: ...') parsed by astroid.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,13 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and (\n+                getattr(parent_node, \"type_annotation\", None) == current_node\n+                or getattr(parent_node, \"type_comment\", None) == current_node\n+            )\n+            or hasattr(parent_node, \"type_comment\")\n+            and getattr(parent_node, \"type_comment\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..378cf3c 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or type comments (e.g. on simple assignments).\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..fcdd155 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or in an assignment/function type comment.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1327,6 +1328,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n         if (\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n@@ -1335,9 +1338,13 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n                 *parent_node.kwonlyargs_annotations,\n                 parent_node.varargannotation,\n                 parent_node.kwargannotation,\n+                *getattr(parent_node, \"type_comment_args\", []),\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n-            and parent_node.returns == current_node\n+            and (\n+                parent_node.returns == current_node\n+                or getattr(parent_node, \"type_comment_returns\", None) == current_node\n+            )\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..4942332 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or assignment/type comments used as annotations.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1340,6 +1341,22 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             and parent_node.returns == current_node\n         ):\n             return True\n+\n+        # Support for type comments on assignments (e.g. \"x = ...  # type: abc.ABC\")\n+        # astroid attaches parsed type comment annotations to Assign nodes as \"type_annotation\".\n+        if isinstance(parent_node, astroid.Assign):\n+            type_ann = getattr(parent_node, \"type_annotation\", None)\n+            if type_ann is not None:\n+                if type_ann == current_node:\n+                    return True\n+                # If the parsed type annotation is a container, check membership.\n+                try:\n+                    if current_node in type_ann:\n+                        return True\n+                except TypeError:\n+                    # Not a container; ignore.\n+                    pass\n+\n         current_node, parent_node = parent_node, parent_node.parent\n         if isinstance(parent_node, astroid.Module):\n             return False\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..98a8e58 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1318,8 +1318,8 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n     \"\"\"Check if node is in type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    Check for 'AnnAssign', 'Assign' with type comments/annotations,\n+    function 'Arguments', or part of function return type annotation.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1327,6 +1327,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n         if (\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            or isinstance(parent_node, astroid.Assign)\n+            and getattr(parent_node, \"type_annotation\", None) == current_node\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..f615421 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1316,33 +1316,49 @@ def is_class_subscriptable_pep585_with_postponed_evaluation_enabled(\n \n \n def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> bool:\n-    \"\"\"Check if node is in type annotation context.\n+    \"\"\"Check if node is in a type annotation context.\n \n-    Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    This includes:\n+    - Variable annotations (AnnAssign)\n+    - Function parameter annotations (Arguments)\n+    - Function return annotations (FunctionDef.returns)\n+    - Type comments on assignments and functions (PEP 484)\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n-    current_node, parent_node = node, node.parent\n-    while True:\n+    current_node = node\n+    parent_node = getattr(node, \"parent\", None)\n+    while parent_node is not None:\n         if (\n-            isinstance(parent_node, astroid.AnnAssign)\n-            and parent_node.annotation == current_node\n-            or isinstance(parent_node, astroid.Arguments)\n-            and current_node\n-            in (\n-                *parent_node.annotations,\n-                *parent_node.posonlyargs_annotations,\n-                *parent_node.kwonlyargs_annotations,\n-                parent_node.varargannotation,\n-                parent_node.kwargannotation,\n+            (isinstance(parent_node, astroid.AnnAssign) and parent_node.annotation == current_node)\n+            or (\n+                isinstance(parent_node, astroid.Arguments)\n+                and current_node\n+                in (\n+                    *getattr(parent_node, \"annotations\", []),\n+                    *getattr(parent_node, \"posonlyargs_annotations\", []),\n+                    *getattr(parent_node, \"kwonlyargs_annotations\", []),\n+                    getattr(parent_node, \"varargannotation\", None),\n+                    getattr(parent_node, \"kwargannotation\", None),\n+                    *getattr(parent_node, \"type_comments\", []),\n+                )\n+            )\n+            or (\n+                isinstance(parent_node, astroid.Assign)\n+                and current_node == getattr(parent_node, \"type_annotation\", None)\n+            )\n+            or (\n+                isinstance(parent_node, astroid.FunctionDef)\n+                and (\n+                    parent_node.returns == current_node\n+                    or current_node == getattr(parent_node, \"type_comment\", None)\n+                )\n             )\n-            or isinstance(parent_node, astroid.FunctionDef)\n-            and parent_node.returns == current_node\n         ):\n             return True\n-        current_node, parent_node = parent_node, parent_node.parent\n+        current_node, parent_node = parent_node, getattr(parent_node, \"parent\", None)\n         if isinstance(parent_node, astroid.Module):\n             return False\n+    return False\n \n \n def is_subclass_of(child: astroid.ClassDef, parent: astroid.ClassDef) -> bool:\n",
        "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..2fa8137 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,30 +1319,38 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation, or type comments (PEP 484).\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n     while True:\n+        # Stop if we reached the module or there is no parent\n+        if parent_node is None or isinstance(parent_node, astroid.Module):\n+            return False\n+\n         if (\n+            # Inline annotations on assignments\n             isinstance(parent_node, astroid.AnnAssign)\n             and parent_node.annotation == current_node\n+            # Function parameter annotations\n             or isinstance(parent_node, astroid.Arguments)\n             and current_node\n             in (\n                 *parent_node.annotations,\n-                *parent_node.posonlyargs_annotations,\n-                *parent_node.kwonlyargs_annotations,\n+                *getattr(parent_node, \"posonlyargs_annotations\", ()),\n+                *getattr(parent_node, \"kwonlyargs_annotations\", ()),\n                 parent_node.varargannotation,\n                 parent_node.kwargannotation,\n             )\n+            # Function return annotation\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            # Type comments (PEP 484) parsed by astroid\n+            or getattr(parent_node, \"type_annotation\", None) == current_node\n         ):\n             return True\n+\n         current_node, parent_node = parent_node, parent_node.parent\n-        if isinstance(parent_node, astroid.Module):\n-            return False\n \n \n def is_subclass_of(child: astroid.ClassDef, parent: astroid.ClassDef) -> bool:\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/pylint/checkers/utils.py b/pylint/checkers/utils.py\nindex ea94ca1..175e5a0 100644\n--- a/pylint/checkers/utils.py\n+++ b/pylint/checkers/utils.py\n@@ -1319,7 +1319,8 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n     \"\"\"Check if node is in type annotation context.\n \n     Check for 'AnnAssign', function 'Arguments',\n-    or part of function return type anntation.\n+    part of function return type annotation,\n+    or a type comment on an assignment/other supported node.\n     \"\"\"\n     # pylint: disable=too-many-boolean-expressions\n     current_node, parent_node = node, node.parent\n@@ -1338,6 +1339,11 @@ def is_node_in_type_annotation_context(node: astroid.node_classes.NodeNG) -> boo\n             )\n             or isinstance(parent_node, astroid.FunctionDef)\n             and parent_node.returns == current_node\n+            # Support for PEP 484/526 type comments parsed by astroid.\n+            # astroid attaches the parsed annotation tree to 'type_annotation'\n+            # (or, in some versions, 'type_comment') on nodes such as Assign.\n+            or getattr(parent_node, \"type_annotation\", None) == current_node\n+            or getattr(parent_node, \"type_comment\", None) == current_node\n         ):\n             return True\n         current_node, parent_node = parent_node, parent_node.parent\n",
  "7_resolved": false
}