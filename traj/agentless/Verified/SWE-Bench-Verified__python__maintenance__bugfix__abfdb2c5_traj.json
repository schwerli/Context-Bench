{
  "instance_id": "SWE-Bench-Verified__python__maintenance__bugfix__abfdb2c5",
  "original_id": "django__django-13195",
  "1_model_selected_files": [
    "django/http/response.py",
    "django/contrib/sessions/middleware.py",
    "django/middleware/csrf.py",
    "django/contrib/messages/storage/cookie.py"
  ],
  "2_embedding_selected_files": [
    "django/http/cookie.py",
    "django/http/__init__.py",
    "django/http/response.py",
    "django/http/request.py",
    "django/setup.py",
    "django/shortcuts.py",
    "django/http/multipartparser.py",
    "django/__init__.py",
    "django/__main__.py"
  ],
  "3_final_combined_files": [
    "django/http/response.py",
    "django/contrib/sessions/middleware.py",
    "django/middleware/csrf.py",
    "django/http/cookie.py",
    "django/http/__init__.py"
  ],
  "4_related_elements": {
    "django/http/response.py": [
      "function: HttpResponseBase.delete_cookie\nfunction: HttpResponseBase.set_cookie\nfunction: HttpResponseBase.set_signed_cookie"
    ],
    "django/contrib/sessions/middleware.py": [
      "function: SessionMiddleware.process_response"
    ],
    "django/middleware/csrf.py": [
      "class: CsrfViewMiddleware"
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "django/http/response.py": [
          "\nfunction: HttpResponseBase.delete_cookie"
        ],
        "django/contrib/sessions/middleware.py": [
          "\nfunction: SessionMiddleware.process_response\nline: 41\nline: 42\nline: 43\nline: 44\nline: 45"
        ]
      },
      "patches": [
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..c59f822 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,20 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly,\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..4bf3cfb 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,18 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None, secure=None, httponly=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        use_secure = secure if secure is not None else key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=use_secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..c59f822 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,20 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly,\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..b7654be 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        # When deleting, preserve attributes like SameSite and HttpOnly when provided.\n+        effective_secure = key.startswith(('__Secure-', '__Host-')) if secure is None else secure\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=effective_secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..d46db70 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        final_secure = (secure is True) or key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=final_secure or None,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly or None,\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..0172fc6 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..0172fc6 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..154a825 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,21 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        computed_secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = computed_secure\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly,\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..b408d48 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        # Additionally, SameSite='None' requires the 'Secure' attribute.\n+        computed_secure = bool(secure) or key.startswith(('__Secure-', '__Host-')) or (samesite == 'None')\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=computed_secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..f249c9b 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,23 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=False, httponly=False, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if not secure and key.startswith(('__Secure-', '__Host-')):\n+            secure = True\n+        # Browsers require the \"Secure\" flag when SameSite=None is used.\n+        if samesite and str(samesite).lower() == 'none' and not secure:\n+            secure = True\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly or None,\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "django/http/response.py": [
          "\nfunction: HttpResponseBase.delete_cookie\nline: 213\nline: 214\nline: 215\nline: 216\nline: 217\nline: 218\nline: 219\nline: 220"
        ],
        "django/contrib/sessions/middleware.py": [
          "\nfunction: SessionMiddleware.process_response\nline: 41\nline: 42\nline: 43\nline: 44\nline: 45"
        ]
      },
      "patches": [
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..95ad30c 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,7 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +76,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..e3dd31c 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,21 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n         secure = key.startswith(('__Secure-', '__Host-'))\n+        # If SameSite=None is used, the cookie must be Secure for modern browsers.\n+        if samesite == 'None':\n+            secure = True\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..f78042b 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,15 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None, secure=None, httponly=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n             key, max_age=0, path=path, domain=domain, secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly, samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..e4cfc37 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None, secure=None, httponly=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..136c460 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,23 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n+        # If SameSite=None is specified, the cookie must be Secure to be honored\n+        # by modern browsers. Ensure Secure is set in that case.\n+        if samesite is not None and str(samesite).lower() == 'none':\n+            secure = True\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..c6c9d79 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, *, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..f81d647 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,18 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        effective_secure = (secure or False) or key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=effective_secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..e92b81f 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,15 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, *, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n             key, max_age=0, path=path, domain=domain, secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly, samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..e4cfc37 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None, secure=None, httponly=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..c5bfcc2 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=False, httponly=False, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        # Allow callers to override secure/httponly/samesite to match the original cookie.\n+        secure = secure or key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly or None,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..9eaf343 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,21 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        delete_secure = bool(secure) or key.startswith(('__Secure-', '__Host-'))\n+        # Set-Cookie with SameSite=None must also specify Secure.\n+        if samesite and str(samesite).lower() == 'none':\n+            delete_secure = True\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=delete_secure or None,\n+            httponly=httponly or None,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n"
      ]
    },
    {
      "sample_index": 2,
      "edit_locs": {
        "django/http/response.py": [
          "\nfunction: HttpResponseBase.delete_cookie"
        ],
        "django/contrib/sessions/middleware.py": [
          "\nfunction: SessionMiddleware.process_response\nline: 41\nline: 42\nline: 43\nline: 44\nline: 45"
        ]
      },
      "patches": [
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..787e91c 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,17 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n+        # Ensure compatibility: browsers require \"Secure\" when SameSite=None.\n+        if samesite and str(samesite).lower() == 'none' and not secure:\n+            secure = True\n         self.set_cookie(\n             key, max_age=0, path=path, domain=domain, secure=secure,\n+            httponly=httponly, samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..64ed5fd 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,20 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None, secure=None, httponly=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly,\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..0172fc6 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..8dc549b 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None, secure=None, httponly=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n+        # Browsers require the \"Secure\" flag when SameSite=None is used.\n+        if samesite is not None and str(samesite).lower() == 'none' and not secure:\n+            secure = True\n         self.set_cookie(\n             key, max_age=0, path=path, domain=domain, secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly,\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..8de7c85 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,21 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        # If 'secure' is not explicitly provided, default to enabling it for\n+        # these special prefixes.\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..353e32f 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,22 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None, secure=None, httponly=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n+        # Browsers require Secure when SameSite=None is used.\n+        if samesite and str(samesite).lower() == 'none':\n+            secure = True\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..15dd880 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,21 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        # Additionally, cookies with SameSite=None must be marked Secure or some\n+        # browsers will ignore the Set-Cookie header.\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-')) or samesite == 'None'\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..e095c31 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,18 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None, secure=False, httponly=False):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        effective_secure = secure or key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=effective_secure,\n+            httponly=httponly or None,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..0690740 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,20 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        # If 'secure' isn't explicitly provided, infer it from the cookie name.\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..52ed218 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,20 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        # Additionally, cookies with SameSite='None' must also be marked secure.\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-')) or (samesite == 'None')\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly if httponly is not None else None,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n"
      ]
    },
    {
      "sample_index": 3,
      "edit_locs": {
        "django/http/response.py": [
          "\nfunction: HttpResponseBase.delete_cookie\nline: 213\nline: 216\nline: 217\nline: 218\nline: 219\nline: 220"
        ],
        "django/contrib/sessions/middleware.py": [
          "\nfunction: SessionMiddleware.process_response\nline: 41\nline: 42\nline: 43\nline: 44\nline: 45"
        ]
      },
      "patches": [
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..897de9f 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,22 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        # Preserve SameSite/HttpOnly/Secure if provided and ensure Secure when SameSite=None.\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n+        if samesite == 'None':\n+            secure = True\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..c59f822 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,20 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly,\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..304b46f 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,20 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if not secure and key.startswith(('__Secure-', '__Host-')):\n+            secure = True\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly,\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..cc10aca 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,18 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=False, httponly=False, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        secure = secure or key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly or None,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..41bee89 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..ccf59eb 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,21 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None, secure=None, httponly=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        calc_secure = key.startswith(('__Secure-', '__Host-'))\n+        # If samesite is explicitly 'None', modern browsers require the secure flag.\n+        if secure is None:\n+            secure = calc_secure or (samesite is not None and str(samesite).lower() == 'none')\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..493aade 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,24 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        # Ensure the Secure flag is present for such cookies to allow deletion.\n+        if key.startswith(('__Secure-', '__Host-')):\n+            secure_flag = True\n+        else:\n+            # Preserve omission of the Secure attribute unless explicitly requested.\n+            secure_flag = bool(secure)\n+\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure_flag,\n+            httponly=bool(httponly) if httponly is not None else False,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..f19af52 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,20 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None, secure=None, httponly=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        # Additionally, cookies using SameSite=None must be marked Secure.\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-')) or (samesite == 'None')\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..3d1ed5a 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,18 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        secure_flag = (secure is True) or key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure_flag,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..37a10e6 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,18 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        secure_flag = bool(secure) or key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure_flag,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n",
        "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..99eef6e 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,12 +210,18 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        secure_flag = (secure is True) or key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure_flag if secure is not False else False,\n+            httponly=httponly,\n+            samesite=samesite,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n         )\n \n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/django/contrib/sessions/middleware.py b/django/contrib/sessions/middleware.py\nindex 61700c6..d788d52 100644\n--- a/django/contrib/sessions/middleware.py\n+++ b/django/contrib/sessions/middleware.py\n@@ -42,6 +42,9 @@ class SessionMiddleware(MiddlewareMixin):\n                 settings.SESSION_COOKIE_NAME,\n                 path=settings.SESSION_COOKIE_PATH,\n                 domain=settings.SESSION_COOKIE_DOMAIN,\n+                secure=settings.SESSION_COOKIE_SECURE or None,\n+                httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n             patch_vary_headers(response, ('Cookie',))\n         else:\n@@ -75,4 +78,4 @@ class SessionMiddleware(MiddlewareMixin):\n                         httponly=settings.SESSION_COOKIE_HTTPONLY or None,\n                         samesite=settings.SESSION_COOKIE_SAMESITE,\n                     )\n-        return response\n+        return response\ndiff --git a/django/http/response.py b/django/http/response.py\nindex 244654c..c59f822 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,20 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n+    def delete_cookie(self, key, path='/', domain=None, secure=None, httponly=None, samesite=None):\n         # Most browsers ignore the Set-Cookie header if the cookie name starts\n         # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n-        secure = key.startswith(('__Secure-', '__Host-'))\n+        if secure is None:\n+            secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n-            key, max_age=0, path=path, domain=domain, secure=secure,\n+            key,\n+            max_age=0,\n+            path=path,\n+            domain=domain,\n+            secure=secure,\n             expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            httponly=httponly,\n+            samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
  "7_resolved": false
}