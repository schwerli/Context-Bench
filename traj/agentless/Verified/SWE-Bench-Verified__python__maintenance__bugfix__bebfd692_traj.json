{
  "instance_id": "SWE-Bench-Verified__python__maintenance__bugfix__bebfd692",
  "original_id": "matplotlib__matplotlib-14623",
  "1_model_selected_files": [
    "lib/matplotlib/scale.py",
    "lib/matplotlib/axes/_base.py",
    "lib/matplotlib/axis.py",
    "lib/matplotlib/transforms.py"
  ],
  "2_embedding_selected_files": [
    "lib/matplotlib/scale.py",
    "lib/matplotlib/axes/_base.py",
    "lib/matplotlib/ticker.py",
    "lib/matplotlib/colors.py",
    "lib/matplotlib/axis.py",
    "lib/matplotlib/pyplot.py",
    "lib/matplotlib/axes/_axes.py",
    "lib/matplotlib/backend_tools.py",
    "lib/matplotlib/rcsetup.py",
    "lib/matplotlib/__init__.py",
    "lib/matplotlib/_constrained_layout.py",
    "lib/matplotlib/contour.py",
    "lib/matplotlib/axes/_subplots.py",
    "lib/matplotlib/mlab.py",
    "lib/matplotlib/axes/_secondary_axes.py",
    "lib/matplotlib/stackplot.py",
    "lib/matplotlib/axes/__init__.py",
    "lib/matplotlib/colorbar.py",
    "lib/matplotlib/_cm_listed.py",
    "lib/matplotlib/spines.py",
    "lib/matplotlib/figure.py",
    "lib/matplotlib/units.py",
    "lib/matplotlib/transforms.py",
    "lib/matplotlib/category.py"
  ],
  "3_final_combined_files": [
    "lib/matplotlib/scale.py",
    "lib/matplotlib/axes/_base.py",
    "lib/matplotlib/axis.py",
    "lib/matplotlib/ticker.py"
  ],
  "4_related_elements": {
    "lib/matplotlib/scale.py": [
      "class: LogScale\nfunction: LogScale.limit_range_for_scale\nfunction: LogScale.get_transform\nclass: ScaleBase\nfunction: ScaleBase.limit_range_for_scale\nclass: LogTransform\nclass: InvertedLogTransform\nvariable: _scale_mapping"
    ],
    "lib/matplotlib/axes/_base.py": [
      "class: _AxesBase\nfunction: _AxesBase.set_ylim\nfunction: _AxesBase.set_ybound\nfunction: _AxesBase.invert_yaxis\nfunction: _AxesBase._validate_converted_limits\nfunction: _AxesBase.set_yscale\nfunction: _AxesBase._update_transScale\nfunction: _AxesBase.set_xlim\nfunction: _AxesBase.set_xbound\nfunction: _AxesBase.invert_xaxis\nfunction: _AxesBase.set_xscale"
    ],
    "lib/matplotlib/axis.py": [
      "class: Axis\nfunction: Axis.limit_range_for_scale\nfunction: Axis.set_view_interval\nfunction: Axis.get_inverted\nfunction: Axis.set_inverted\nfunction: Axis._set_scale\nfunction: Axis.get_minpos\nclass: YAxis\nfunction: YAxis.get_minpos\nclass: XAxis\nfunction: XAxis.get_minpos"
    ]
  },
  "5_sampled_edit_locs_and_patches": [
    {
      "sample_index": 0,
      "edit_locs": {
        "lib/matplotlib/axes/_base.py": [
          "\nfunction: _AxesBase.set_ylim\nfunction: _AxesBase.set_xlim"
        ]
      },
      "patches": [
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..1653e6f 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,17 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # For log scales, preserve user-requested inverted axes (left > right)\n+        # by applying scale-specific range handling on a sorted pair, and then\n+        # restoring the original orientation.\n+        if self.get_xscale() == 'log' and left > right:\n+            lo, hi = right, left\n+            lo, hi = self.xaxis.get_major_locator().nonsingular(lo, hi)\n+            lo, hi = self.xaxis.limit_range_for_scale(lo, hi)\n+            left, right = hi, lo\n+        else:\n+            left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n+            left, right = self.xaxis.limit_range_for_scale(left, right)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3653,17 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # For log scales, preserve user-requested inverted axes (bottom > top)\n+        # by applying scale-specific range handling on a sorted pair, and then\n+        # restoring the original orientation.\n+        if self.get_yscale() == 'log' and bottom > top:\n+            lo, hi = top, bottom\n+            lo, hi = self.yaxis.get_major_locator().nonsingular(lo, hi)\n+            lo, hi = self.yaxis.limit_range_for_scale(lo, hi)\n+            bottom, top = hi, lo\n+        else:\n+            bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n+            bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..9b7dc6c 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,15 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n+        # Preserve user-requested orientation (including inversion) even if\n+        # scale-specific helpers reorder limits.\n+        _orig_inverted = left > right\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if _orig_inverted and left < right:\n+            left, right = right, left\n+        elif not _orig_inverted and left > right:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3651,15 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n+        # Preserve user-requested orientation (including inversion) even if\n+        # scale-specific helpers reorder limits.\n+        _orig_inverted = bottom > top\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if _orig_inverted and bottom < top:\n+            bottom, top = top, bottom\n+        elif not _orig_inverted and bottom > top:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..beae4be 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,12 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n+        reversed_limits = left > right\n+        left, right = self.xaxis.get_major_locator().nonsingular(\n+            min(left, right), max(left, right))\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if reversed_limits:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3648,12 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n+        reversed_limits = bottom > top\n+        bottom, top = self.yaxis.get_major_locator().nonsingular(\n+            min(bottom, top), max(bottom, top))\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if reversed_limits:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..304e7c4 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3247,6 +3247,9 @@ class _AxesBase(martist.Artist):\n         if right is None:\n             right = old_right\n \n+        # Remember user-requested orientation (increasing or decreasing).\n+        _want_decreasing = left > right\n+\n         if self.get_xscale() == 'log':\n             if left <= 0:\n                 cbook._warn_external(\n@@ -3266,6 +3269,10 @@ class _AxesBase(martist.Artist):\n                 f\"in singular transformations; automatically expanding.\")\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Some scalings/locators (e.g., log) may reorder the limits to be\n+        # increasing. If the user passed them in decreasing order, honor that.\n+        if _want_decreasing and left <= right:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3626,6 +3633,9 @@ class _AxesBase(martist.Artist):\n         if top is None:\n             top = old_top\n \n+        # Remember user-requested orientation (increasing or decreasing).\n+        _want_decreasing = bottom > top\n+\n         if self.get_yscale() == 'log':\n             if bottom <= 0:\n                 cbook._warn_external(\n@@ -3646,6 +3656,10 @@ class _AxesBase(martist.Artist):\n                 f\"expanding.\")\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Some scalings/locators (e.g., log) may reorder the limits to be\n+        # increasing. If the user passed them in decreasing order, honor that.\n+        if _want_decreasing and bottom <= top:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..bc971d6 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,12 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n+        # Preserve requested order (including inverted axes) even for non-linear scales\n+        reversed_limits = left > right\n+        left, right = self.xaxis.get_major_locator().nonsingular(min(left, right), max(left, right))\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if reversed_limits:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3648,12 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n+        # Preserve requested order (including inverted axes) even for non-linear scales\n+        reversed_limits = bottom > top\n+        bottom, top = self.yaxis.get_major_locator().nonsingular(min(bottom, top), max(bottom, top))\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if reversed_limits:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..d3d4952 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,13 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Apply range validation on sorted limits, then restore original order\n+        # to preserve inversion on log (and other) scales.\n+        need_inversion = left > right\n+        lo, hi = (right, left) if need_inversion else (left, right)\n+        lo, hi = self.xaxis.get_major_locator().nonsingular(lo, hi)\n+        lo, hi = self.xaxis.limit_range_for_scale(lo, hi)\n+        left, right = (hi, lo) if need_inversion else (lo, hi)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3649,13 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Apply range validation on sorted limits, then restore original order\n+        # to preserve inversion on log (and other) scales.\n+        need_inversion = bottom > top\n+        lo, hi = (top, bottom) if need_inversion else (bottom, top)\n+        lo, hi = self.yaxis.get_major_locator().nonsingular(lo, hi)\n+        lo, hi = self.yaxis.limit_range_for_scale(lo, hi)\n+        bottom, top = (hi, lo) if need_inversion else (lo, hi)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..f1a52fb 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,12 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve input order (allow inverted axes) even for log scales.\n+        reversed_input = left > right\n+        lo, hi = (right, left) if reversed_input else (left, right)\n+        lo, hi = self.xaxis.get_major_locator().nonsingular(lo, hi)\n+        lo, hi = self.xaxis.limit_range_for_scale(lo, hi)\n+        left, right = (hi, lo) if reversed_input else (lo, hi)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3648,12 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve input order (allow inverted axes) even for log scales.\n+        reversed_input = bottom > top\n+        lo, hi = (top, bottom) if reversed_input else (bottom, top)\n+        lo, hi = self.yaxis.get_major_locator().nonsingular(lo, hi)\n+        lo, hi = self.yaxis.limit_range_for_scale(lo, hi)\n+        bottom, top = (hi, lo) if reversed_input else (lo, hi)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..c832bcc 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,11 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n+        reversed_ = left > right\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if reversed_:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3647,11 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n+        reversed_ = bottom > top\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if reversed_:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..2219eb1 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,13 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve user-requested inversion by processing limits in ascending\n+        # order for scale-specific handling, then reapply inversion if needed.\n+        reversed_limits = left > right\n+        low, high = (right, left) if reversed_limits else (left, right)\n+        low, high = self.xaxis.get_major_locator().nonsingular(low, high)\n+        low, high = self.xaxis.limit_range_for_scale(low, high)\n+        left, right = (high, low) if reversed_limits else (low, high)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3649,13 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve user-requested inversion by processing limits in ascending\n+        # order for scale-specific handling, then reapply inversion if needed.\n+        reversed_limits = bottom > top\n+        low, high = (top, bottom) if reversed_limits else (bottom, top)\n+        low, high = self.yaxis.get_major_locator().nonsingular(low, high)\n+        low, high = self.yaxis.limit_range_for_scale(low, high)\n+        bottom, top = (high, low) if reversed_limits else (low, high)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..773d307 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3241,6 +3241,9 @@ class _AxesBase(martist.Artist):\n         left = self._validate_converted_limits(left, self.convert_xunits)\n         right = self._validate_converted_limits(right, self.convert_xunits)\n \n+        # Remember if the user explicitly passed reversed limits.\n+        keep_order_reversed = left is not None and right is not None and left > right\n+\n         old_left, old_right = self.get_xlim()\n         if left is None:\n             left = old_left\n@@ -3266,6 +3269,9 @@ class _AxesBase(martist.Artist):\n                 f\"in singular transformations; automatically expanding.\")\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # If the user explicitly passed reversed limits, preserve that.\n+        if keep_order_reversed and left <= right:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3619,6 +3625,9 @@ class _AxesBase(martist.Artist):\n         bottom = self._validate_converted_limits(bottom, self.convert_yunits)\n         top = self._validate_converted_limits(top, self.convert_yunits)\n \n+        # Remember if the user explicitly passed reversed limits.\n+        keep_order_reversed = bottom is not None and top is not None and bottom > top\n+\n         old_bottom, old_top = self.get_ylim()\n \n         if bottom is None:\n@@ -3646,6 +3655,9 @@ class _AxesBase(martist.Artist):\n                 f\"expanding.\")\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # If the user explicitly passed reversed limits, preserve that.\n+        if keep_order_reversed and bottom <= top:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n"
      ]
    },
    {
      "sample_index": 1,
      "edit_locs": {
        "lib/matplotlib/axes/_base.py": [
          "\nfunction: _AxesBase.set_xlim\nline: 3267\nfunction: _AxesBase.set_ylim\nline: 3647"
        ]
      },
      "patches": [
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..16aa006 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,13 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve user-requested inversion for all scales by applying\n+        # scale-specific range handling on sorted limits and restoring order.\n+        reversed_limits = right < left\n+        vmin, vmax = (right, left) if reversed_limits else (left, right)\n+        vmin, vmax = self.xaxis.get_major_locator().nonsingular(vmin, vmax)\n+        vmin, vmax = self.xaxis.limit_range_for_scale(vmin, vmax)\n+        left, right = ((vmax, vmin) if reversed_limits else (vmin, vmax))\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3649,13 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve user-requested inversion for all scales by applying\n+        # scale-specific range handling on sorted limits and restoring order.\n+        reversed_limits = top < bottom\n+        vmin, vmax = (top, bottom) if reversed_limits else (bottom, top)\n+        vmin, vmax = self.yaxis.get_major_locator().nonsingular(vmin, vmax)\n+        vmin, vmax = self.yaxis.limit_range_for_scale(vmin, vmax)\n+        bottom, top = ((vmax, vmin) if reversed_limits else (vmin, vmax))\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..9caf4d6 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,13 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n+        # Preserve axis inversion: validate limits using increasing order,\n+        # then restore original orientation if requested by the user.\n+        _reversed = left > right\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if _reversed:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3649,13 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n+        # Preserve axis inversion: validate limits using increasing order,\n+        # then restore original orientation if requested by the user.\n+        _reversed = bottom > top\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if _reversed:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..8f2acaa 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,14 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve requested axis inversion for logarithmic scales by\n+        # applying scale-specific range corrections to the ordered bounds\n+        # and then restoring the original order if needed.\n+        _reversed = left > right\n+        _lo, _hi = (right, left) if _reversed else (left, right)\n+        _lo, _hi = self.xaxis.get_major_locator().nonsingular(_lo, _hi)\n+        _lo, _hi = self.xaxis.limit_range_for_scale(_lo, _hi)\n+        left, right = ((_hi, _lo) if _reversed else (_lo, _hi))\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3650,14 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve requested axis inversion for logarithmic scales by\n+        # applying scale-specific range corrections to the ordered bounds\n+        # and then restoring the original order if needed.\n+        _reversed = bottom > top\n+        _lo, _hi = (top, bottom) if _reversed else (bottom, top)\n+        _lo, _hi = self.yaxis.get_major_locator().nonsingular(_lo, _hi)\n+        _lo, _hi = self.yaxis.limit_range_for_scale(_lo, _hi)\n+        bottom, top = ((_hi, _lo) if _reversed else (_lo, _hi))\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..0bb9d43 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,14 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n+        # Preserve user-requested axis inversion for all scales.\n+        _originally_inverted = left > right\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if _originally_inverted and left < right:\n+            # If locator/scale normalization reordered the limits,\n+            # restore the inverted orientation requested by the user.\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3650,14 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n+        # Preserve user-requested axis inversion for all scales.\n+        _originally_inverted = bottom > top\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if _originally_inverted and bottom < top:\n+            # If locator/scale normalization reordered the limits,\n+            # restore the inverted orientation requested by the user.\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..2615e29 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,11 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n+        reversed_axes = left > right\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if reversed_axes:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3647,11 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n+        reversed_axes = bottom > top\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if reversed_axes:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..5346655 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3260,12 +3260,16 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 right = old_right\n+        # Remember if the user requested an inverted axis (left > right).\n+        inverted = left > right\n         if left == right:\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        lo, hi = self.xaxis.get_major_locator().nonsingular(left, right)\n+        lo, hi = self.xaxis.limit_range_for_scale(lo, hi)\n+        # Preserve the requested direction after scale-specific adjustments.\n+        left, right = (hi, lo) if inverted else (lo, hi)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3639,13 +3643,17 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 top = old_top\n+        # Remember if the user requested an inverted axis (bottom > top).\n+        inverted = bottom > top\n         if bottom == top:\n             cbook._warn_external(\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        lo, hi = self.yaxis.get_major_locator().nonsingular(bottom, top)\n+        lo, hi = self.yaxis.limit_range_for_scale(lo, hi)\n+        # Preserve the requested direction after scale-specific adjustments.\n+        bottom, top = (hi, lo) if inverted else (lo, hi)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..dbcf1d2 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,16 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve axis inversion by sorting for scale-specific processing,\n+        # then swapping back if needed.\n+        _reversed = left > right\n+        _low, _high = (right, left) if _reversed else (left, right)\n+        _low, _high = self.xaxis.get_major_locator().nonsingular(_low, _high)\n+        _low, _high = self.xaxis.limit_range_for_scale(_low, _high)\n+        if _reversed:\n+            left, right = _high, _low\n+        else:\n+            left, right = _low, _high\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3652,16 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve axis inversion by sorting for scale-specific processing,\n+        # then swapping back if needed.\n+        _reversed = bottom > top\n+        _low, _high = (top, bottom) if _reversed else (bottom, top)\n+        _low, _high = self.yaxis.get_major_locator().nonsingular(_low, _high)\n+        _low, _high = self.yaxis.limit_range_for_scale(_low, _high)\n+        if _reversed:\n+            bottom, top = _high, _low\n+        else:\n+            bottom, top = _low, _high\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..ce841bf 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,14 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve user-specified axis direction (including inverted)\n+        # even on non-linear scales by normalizing to ascending order for\n+        # scale-specific limit processing, then restoring the original order.\n+        _inverted = left > right\n+        lo, hi = (right, left) if _inverted else (left, right)\n+        lo, hi = self.xaxis.get_major_locator().nonsingular(lo, hi)\n+        lo, hi = self.xaxis.limit_range_for_scale(lo, hi)\n+        left, right = (hi, lo) if _inverted else (lo, hi)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3650,14 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve user-specified axis direction (including inverted)\n+        # even on non-linear scales by normalizing to ascending order for\n+        # scale-specific limit processing, then restoring the original order.\n+        _inverted = bottom > top\n+        lo, hi = (top, bottom) if _inverted else (bottom, top)\n+        lo, hi = self.yaxis.get_major_locator().nonsingular(lo, hi)\n+        lo, hi = self.yaxis.limit_range_for_scale(lo, hi)\n+        bottom, top = (hi, lo) if _inverted else (lo, hi)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..c835d80 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3247,6 +3247,7 @@ class _AxesBase(martist.Artist):\n         if right is None:\n             right = old_right\n \n+        need_to_invert = False\n         if self.get_xscale() == 'log':\n             if left <= 0:\n                 cbook._warn_external(\n@@ -3260,12 +3261,17 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 right = old_right\n+            # Remember if the user requested inverted limits; some scale-specific\n+            # adjustments may reorder them, so we restore the requested order later.\n+            need_to_invert = left > right\n         if left == right:\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if self.get_xscale() == 'log' and need_to_invert:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3626,6 +3632,7 @@ class _AxesBase(martist.Artist):\n         if top is None:\n             top = old_top\n \n+        need_to_invert = False\n         if self.get_yscale() == 'log':\n             if bottom <= 0:\n                 cbook._warn_external(\n@@ -3639,6 +3646,9 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 top = old_top\n+            # Remember if the user requested inverted limits; some scale-specific\n+            # adjustments may reorder them, so we restore the requested order later.\n+            need_to_invert = bottom > top\n         if bottom == top:\n             cbook._warn_external(\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n@@ -3646,6 +3656,8 @@ class _AxesBase(martist.Artist):\n                 f\"expanding.\")\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if self.get_yscale() == 'log' and need_to_invert:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..0667919 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3260,12 +3260,17 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 right = old_right\n+            _requested_inverted = left > right\n+        else:\n+            _requested_inverted = False\n         if left == right:\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if _requested_inverted:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3639,6 +3644,9 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 top = old_top\n+            _requested_inverted = bottom > top\n+        else:\n+            _requested_inverted = False\n         if bottom == top:\n             cbook._warn_external(\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n@@ -3646,6 +3654,8 @@ class _AxesBase(martist.Artist):\n                 f\"expanding.\")\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if _requested_inverted:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n"
      ]
    },
    {
      "sample_index": 2,
      "edit_locs": {
        "lib/matplotlib/axes/_base.py": [
          "\nfunction: _AxesBase.set_xlim\nfunction: _AxesBase.set_ylim"
        ]
      },
      "patches": [
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..15ebe3b 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,12 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n+        # Preserve user-requested orientation for log scale (and others)\n+        inverted = right < left\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if inverted:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3648,12 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n+        # Preserve user-requested orientation for log scale (and others)\n+        inverted = top < bottom\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if inverted:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..24a8572 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,14 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve user-requested inversion (left > right) for all scales.\n+        inverted = left > right\n+        low, high = (right, left) if inverted else (left, right)\n+\n+        low, high = self.xaxis.get_major_locator().nonsingular(low, high)\n+        low, high = self.xaxis.limit_range_for_scale(low, high)\n+\n+        left, right = (high, low) if inverted else (low, high)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3650,14 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve user-requested inversion (bottom > top) for all scales.\n+        inverted = bottom > top\n+        low, high = (top, bottom) if inverted else (bottom, top)\n+\n+        low, high = self.yaxis.get_major_locator().nonsingular(low, high)\n+        low, high = self.yaxis.limit_range_for_scale(low, high)\n+\n+        bottom, top = (high, low) if inverted else (low, high)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..5f022b9 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,15 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve requested axis direction (including inverted axes) while\n+        # allowing scale-specific range validation to operate on an ordered pair.\n+        reversed_limits = left > right\n+        lo, hi = self.xaxis.get_major_locator().nonsingular(min(left, right), max(left, right))\n+        lo, hi = self.xaxis.limit_range_for_scale(lo, hi)\n+        if reversed_limits:\n+            left, right = hi, lo\n+        else:\n+            left, right = lo, hi\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3651,15 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve requested axis direction (including inverted axes) while\n+        # allowing scale-specific range validation to operate on an ordered pair.\n+        reversed_limits = bottom > top\n+        lo, hi = self.yaxis.get_major_locator().nonsingular(min(bottom, top), max(bottom, top))\n+        lo, hi = self.yaxis.limit_range_for_scale(lo, hi)\n+        if reversed_limits:\n+            bottom, top = hi, lo\n+        else:\n+            bottom, top = lo, hi\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..a0a6918 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,14 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve input order (allow inverted axes). Some locator/scale utilities\n+        # may return limits in increasing order; work on sorted limits and\n+        # restore orientation afterwards.\n+        _reversed = left > right\n+        lmin, lmax = (left, right) if not _reversed else (right, left)\n+        lmin, lmax = self.xaxis.get_major_locator().nonsingular(lmin, lmax)\n+        lmin, lmax = self.xaxis.limit_range_for_scale(lmin, lmax)\n+        left, right = (lmax, lmin) if _reversed else (lmin, lmax)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3650,14 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve input order (allow inverted axes). Some locator/scale utilities\n+        # may return limits in increasing order; work on sorted limits and\n+        # restore orientation afterwards.\n+        _reversed = bottom > top\n+        vmin, vmax = (bottom, top) if not _reversed else (top, bottom)\n+        vmin, vmax = self.yaxis.get_major_locator().nonsingular(vmin, vmax)\n+        vmin, vmax = self.yaxis.limit_range_for_scale(vmin, vmax)\n+        bottom, top = (vmax, vmin) if _reversed else (vmin, vmax)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..6e5311d 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,12 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve user-specified direction (increasing or decreasing).\n+        _reversed = left > right\n+        _low, _high = (right, left) if _reversed else (left, right)\n+        _low, _high = self.xaxis.get_major_locator().nonsingular(_low, _high)\n+        _low, _high = self.xaxis.limit_range_for_scale(_low, _high)\n+        left, right = (_high, _low) if _reversed else (_low, _high)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3648,12 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve user-specified direction (increasing or decreasing).\n+        _reversed = bottom > top\n+        _low, _high = (top, bottom) if _reversed else (bottom, top)\n+        _low, _high = self.yaxis.get_major_locator().nonsingular(_low, _high)\n+        _low, _high = self.yaxis.limit_range_for_scale(_low, _high)\n+        bottom, top = (_high, _low) if _reversed else (_low, _high)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..5a9a300 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,13 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve the requested axis direction (normal or inverted)\n+        # while validating ranges for the current scale.\n+        _reversed = right < left\n+        _low, _high = (right, left) if _reversed else (left, right)\n+        _low, _high = self.xaxis.get_major_locator().nonsingular(_low, _high)\n+        _low, _high = self.xaxis.limit_range_for_scale(_low, _high)\n+        left, right = (_high, _low) if _reversed else (_low, _high)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3649,13 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve the requested axis direction (normal or inverted)\n+        # while validating ranges for the current scale.\n+        _reversed = top < bottom\n+        _low, _high = (top, bottom) if _reversed else (bottom, top)\n+        _low, _high = self.yaxis.get_major_locator().nonsingular(_low, _high)\n+        _low, _high = self.yaxis.limit_range_for_scale(_low, _high)\n+        bottom, top = (_high, _low) if _reversed else (_low, _high)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..809d1a5 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3260,12 +3260,18 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 right = old_right\n+        # Preserve user-requested inversion for log scale: record order before\n+        # calling nonsingular/limit_range_for_scale which may reorder.\n+        reverse_order = (self.get_xscale() == 'log' and left > right)\n+\n         if left == right:\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if reverse_order:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3639,6 +3645,10 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 top = old_top\n+        # Preserve user-requested inversion for log scale: record order before\n+        # calling nonsingular/limit_range_for_scale which may reorder.\n+        reverse_order = (self.get_yscale() == 'log' and bottom > top)\n+\n         if bottom == top:\n             cbook._warn_external(\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n@@ -3646,6 +3656,8 @@ class _AxesBase(martist.Artist):\n                 f\"expanding.\")\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if reverse_order:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..cf073e7 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3247,6 +3247,9 @@ class _AxesBase(martist.Artist):\n         if right is None:\n             right = old_right\n \n+        # Remember if the user requested an inverted axis (left > right).\n+        inverted_request = left > right\n+\n         if self.get_xscale() == 'log':\n             if left <= 0:\n                 cbook._warn_external(\n@@ -3267,6 +3270,10 @@ class _AxesBase(martist.Artist):\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n \n+        # Restore the requested inversion if sanitizing reordered the limits.\n+        if inverted_request and left < right:\n+            left, right = right, left\n+\n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n             self._autoscaleXon = bool(auto)\n@@ -3626,6 +3633,9 @@ class _AxesBase(martist.Artist):\n         if top is None:\n             top = old_top\n \n+        # Remember if the user requested an inverted axis (bottom > top).\n+        inverted_request = bottom > top\n+\n         if self.get_yscale() == 'log':\n             if bottom <= 0:\n                 cbook._warn_external(\n@@ -3647,6 +3657,10 @@ class _AxesBase(martist.Artist):\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n \n+        # Restore the requested inversion if sanitizing reordered the limits.\n+        if inverted_request and bottom < top:\n+            bottom, top = top, bottom\n+\n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n             self._autoscaleYon = bool(auto)\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..287dc28 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,12 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n+        # Preserve user-requested orientation for log scales (inverted axes).\n+        inverted = left > right\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if self.get_xscale() == 'log' and inverted and left < right:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3648,12 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n+        # Preserve user-requested orientation for log scales (inverted axes).\n+        inverted = bottom > top\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if self.get_yscale() == 'log' and inverted and bottom < top:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..ee3f243 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3241,6 +3241,11 @@ class _AxesBase(martist.Artist):\n         left = self._validate_converted_limits(left, self.convert_xunits)\n         right = self._validate_converted_limits(right, self.convert_xunits)\n \n+        # Detect if the user explicitly requested inverted limits (left > right)\n+        requested_inverted = (\n+            left is not None and right is not None and left > right\n+        )\n+\n         old_left, old_right = self.get_xlim()\n         if left is None:\n             left = old_left\n@@ -3267,6 +3272,10 @@ class _AxesBase(martist.Artist):\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n \n+        # Restore requested inversion after any internal reordering by locators.\n+        if requested_inverted:\n+            left, right = right, left\n+\n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n             self._autoscaleXon = bool(auto)\n@@ -3619,6 +3628,11 @@ class _AxesBase(martist.Artist):\n         bottom = self._validate_converted_limits(bottom, self.convert_yunits)\n         top = self._validate_converted_limits(top, self.convert_yunits)\n \n+        # Detect if the user explicitly requested inverted limits (bottom > top)\n+        requested_inverted = (\n+            bottom is not None and top is not None and bottom > top\n+        )\n+\n         old_bottom, old_top = self.get_ylim()\n \n         if bottom is None:\n@@ -3647,6 +3661,10 @@ class _AxesBase(martist.Artist):\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n \n+        # Restore requested inversion after any internal reordering by locators.\n+        if requested_inverted:\n+            bottom, top = top, bottom\n+\n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n             self._autoscaleYon = bool(auto)\n"
      ]
    },
    {
      "sample_index": 3,
      "edit_locs": {
        "lib/matplotlib/axes/_base.py": [
          "\nfunction: _AxesBase.set_ylim\nfunction: _AxesBase.set_xlim"
        ]
      },
      "patches": [
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..d5d4064 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3260,12 +3260,19 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 right = old_right\n+        # Track if user requested inverted limits so we can preserve inversion\n+        # after scale-specific limit processing (which may reorder them).\n+        reversed_input = left > right\n         if left == right:\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # For log scales, preserve user-requested inversion that may have been\n+        # undone by limit_range_for_scale.\n+        if self.get_xscale() == 'log' and reversed_input:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3639,6 +3646,9 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 top = old_top\n+        # Track if user requested inverted limits so we can preserve inversion\n+        # after scale-specific limit processing (which may reorder them).\n+        reversed_input = bottom > top\n         if bottom == top:\n             cbook._warn_external(\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n@@ -3646,6 +3656,10 @@ class _AxesBase(martist.Artist):\n                 f\"expanding.\")\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # For log scales, preserve user-requested inversion that may have been\n+        # undone by limit_range_for_scale.\n+        if self.get_yscale() == 'log' and reversed_input:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..72f18d3 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,11 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve user-requested axis inversion while still validating the range.\n+        reversed_limits = left > right\n+        lo, hi = self.xaxis.get_major_locator().nonsingular(min(left, right), max(left, right))\n+        lo, hi = self.xaxis.limit_range_for_scale(lo, hi)\n+        left, right = (hi, lo) if reversed_limits else (lo, hi)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3647,11 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve user-requested axis inversion while still validating the range.\n+        reversed_limits = bottom > top\n+        lo, hi = self.yaxis.get_major_locator().nonsingular(min(bottom, top), max(bottom, top))\n+        lo, hi = self.yaxis.limit_range_for_scale(lo, hi)\n+        bottom, top = (hi, lo) if reversed_limits else (lo, hi)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..fbfb4f0 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,16 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve user-requested order (including inverted axes) by\n+        # performing range validation on sorted limits and re-applying\n+        # the original orientation afterwards.\n+        _reversed_limits = left > right\n+        _lo, _hi = (right, left) if _reversed_limits else (left, right)\n+\n+        _lo, _hi = self.xaxis.get_major_locator().nonsingular(_lo, _hi)\n+        _lo, _hi = self.xaxis.limit_range_for_scale(_lo, _hi)\n+\n+        left, right = (_hi, _lo) if _reversed_limits else (_lo, _hi)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3652,16 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve user-requested order (including inverted axes) by\n+        # performing range validation on sorted limits and re-applying\n+        # the original orientation afterwards.\n+        _reversed_limits = bottom > top\n+        _lo, _hi = (top, bottom) if _reversed_limits else (bottom, top)\n+\n+        _lo, _hi = self.yaxis.get_major_locator().nonsingular(_lo, _hi)\n+        _lo, _hi = self.yaxis.limit_range_for_scale(_lo, _hi)\n+\n+        bottom, top = (_hi, _lo) if _reversed_limits else (_lo, _hi)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..c4414f3 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3260,12 +3260,17 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 right = old_right\n+        # Record whether the user passed reversed limits to preserve inversion.\n+        preserve_inversion = left > right\n         if left == right:\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # If the user requested reversed limits (e.g., for inversion), restore that order.\n+        if preserve_inversion:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3639,6 +3644,8 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 top = old_top\n+        # Record whether the user passed reversed limits to preserve inversion.\n+        preserve_inversion = bottom > top\n         if bottom == top:\n             cbook._warn_external(\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n@@ -3646,6 +3653,9 @@ class _AxesBase(martist.Artist):\n                 f\"expanding.\")\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # If the user requested reversed limits (e.g., for inversion), restore that order.\n+        if preserve_inversion:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..90a9baa 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3247,6 +3247,10 @@ class _AxesBase(martist.Artist):\n         if right is None:\n             right = old_right\n \n+        # Remember the requested orientation so we can preserve it through\n+        # scale-specific normalization (e.g., on log scales).\n+        requested_inverted = left > right\n+\n         if self.get_xscale() == 'log':\n             if left <= 0:\n                 cbook._warn_external(\n@@ -3266,6 +3270,8 @@ class _AxesBase(martist.Artist):\n                 f\"in singular transformations; automatically expanding.\")\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if requested_inverted:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3626,6 +3632,10 @@ class _AxesBase(martist.Artist):\n         if top is None:\n             top = old_top\n \n+        # Remember the requested orientation so we can preserve it through\n+        # scale-specific normalization (e.g., on log scales).\n+        requested_inverted = bottom > top\n+\n         if self.get_yscale() == 'log':\n             if bottom <= 0:\n                 cbook._warn_external(\n@@ -3646,6 +3656,8 @@ class _AxesBase(martist.Artist):\n                 f\"expanding.\")\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if requested_inverted:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..13627c2 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,17 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve inverted limits for log scale by sorting for validation\n+        # and restoring the original order afterwards.\n+        if self.get_xscale() == 'log':\n+            inverted = left > right\n+            lo, hi = (right, left) if inverted else (left, right)\n+            lo, hi = self.xaxis.get_major_locator().nonsingular(lo, hi)\n+            lo, hi = self.xaxis.limit_range_for_scale(lo, hi)\n+            left, right = (hi, lo) if inverted else (lo, hi)\n+        else:\n+            left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n+            left, right = self.xaxis.limit_range_for_scale(left, right)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3653,17 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve inverted limits for log scale by sorting for validation\n+        # and restoring the original order afterwards.\n+        if self.get_yscale() == 'log':\n+            inverted = bottom > top\n+            lo, hi = (top, bottom) if inverted else (bottom, top)\n+            lo, hi = self.yaxis.get_major_locator().nonsingular(lo, hi)\n+            lo, hi = self.yaxis.limit_range_for_scale(lo, hi)\n+            bottom, top = (hi, lo) if inverted else (lo, hi)\n+        else:\n+            bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n+            bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..b45ad8e 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3260,12 +3260,17 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 right = old_right\n+        requested_inverted = left > right\n         if left == right:\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve user-requested inversion (e.g., set_xlim(max, min)),\n+        # even if the scale-specific processing reordered the limits.\n+        if requested_inverted and left < right:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3639,6 +3644,7 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 top = old_top\n+        requested_inverted = bottom > top\n         if bottom == top:\n             cbook._warn_external(\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n@@ -3646,6 +3652,10 @@ class _AxesBase(martist.Artist):\n                 f\"expanding.\")\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve user-requested inversion (e.g., set_ylim(max, min)),\n+        # even if the scale-specific processing reordered the limits.\n+        if requested_inverted and bottom < top:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..16d32c8 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,12 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # Preserve input order while ensuring nonsingular and scale constraints\n+        _reversed = left > right\n+        _low, _high = (right, left) if _reversed else (left, right)\n+        _low, _high = self.xaxis.get_major_locator().nonsingular(_low, _high)\n+        _low, _high = self.xaxis.limit_range_for_scale(_low, _high)\n+        left, right = ((_high, _low) if _reversed else (_low, _high))\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3648,12 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # Preserve input order while ensuring nonsingular and scale constraints\n+        _reversed = bottom > top\n+        _low, _high = (top, bottom) if _reversed else (bottom, top)\n+        _low, _high = self.yaxis.get_major_locator().nonsingular(_low, _high)\n+        _low, _high = self.yaxis.limit_range_for_scale(_low, _high)\n+        bottom, top = ((_high, _low) if _reversed else (_low, _high))\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..0e80788 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3260,12 +3260,16 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 right = old_right\n+        # Preserve user-requested axis direction (inverted or not).\n+        wasinverted = left > right\n         if left == right:\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if wasinverted:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3639,6 +3643,8 @@ class _AxesBase(martist.Artist):\n                     'log-scaled axis.\\n'\n                     'Invalid limit will be ignored.')\n                 top = old_top\n+        # Preserve user-requested axis direction (inverted or not).\n+        wasinverted = bottom > top\n         if bottom == top:\n             cbook._warn_external(\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n@@ -3646,6 +3652,8 @@ class _AxesBase(martist.Artist):\n                 f\"expanding.\")\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if wasinverted:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
        "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..986d5c1 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,15 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n+        # Preserve user-requested orientation (inverted or not) across\n+        # scale-specific range sanitization that may reorder limits.\n+        inverted = right < left\n+        if inverted:\n+            left, right = right, left\n         left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n         left, right = self.xaxis.limit_range_for_scale(left, right)\n+        if inverted:\n+            left, right = right, left\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3651,15 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n+        # Preserve user-requested orientation (inverted or not) across\n+        # scale-specific range sanitization that may reorder limits.\n+        inverted = top < bottom\n+        if inverted:\n+            bottom, top = top, bottom\n         bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n         bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        if inverted:\n+            bottom, top = top, bottom\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n"
      ]
    }
  ],
  "6_final_selected_patch": "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 3079800..1653e6f 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -3264,8 +3264,17 @@ class _AxesBase(martist.Artist):\n             cbook._warn_external(\n                 f\"Attempting to set identical left == right == {left} results \"\n                 f\"in singular transformations; automatically expanding.\")\n-        left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n-        left, right = self.xaxis.limit_range_for_scale(left, right)\n+        # For log scales, preserve user-requested inverted axes (left > right)\n+        # by applying scale-specific range handling on a sorted pair, and then\n+        # restoring the original orientation.\n+        if self.get_xscale() == 'log' and left > right:\n+            lo, hi = right, left\n+            lo, hi = self.xaxis.get_major_locator().nonsingular(lo, hi)\n+            lo, hi = self.xaxis.limit_range_for_scale(lo, hi)\n+            left, right = hi, lo\n+        else:\n+            left, right = self.xaxis.get_major_locator().nonsingular(left, right)\n+            left, right = self.xaxis.limit_range_for_scale(left, right)\n \n         self.viewLim.intervalx = (left, right)\n         if auto is not None:\n@@ -3644,8 +3653,17 @@ class _AxesBase(martist.Artist):\n                 f\"Attempting to set identical bottom == top == {bottom} \"\n                 f\"results in singular transformations; automatically \"\n                 f\"expanding.\")\n-        bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n-        bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n+        # For log scales, preserve user-requested inverted axes (bottom > top)\n+        # by applying scale-specific range handling on a sorted pair, and then\n+        # restoring the original orientation.\n+        if self.get_yscale() == 'log' and bottom > top:\n+            lo, hi = top, bottom\n+            lo, hi = self.yaxis.get_major_locator().nonsingular(lo, hi)\n+            lo, hi = self.yaxis.limit_range_for_scale(lo, hi)\n+            bottom, top = hi, lo\n+        else:\n+            bottom, top = self.yaxis.get_major_locator().nonsingular(bottom, top)\n+            bottom, top = self.yaxis.limit_range_for_scale(bottom, top)\n \n         self.viewLim.intervaly = (bottom, top)\n         if auto is not None:\n",
  "7_resolved": true
}