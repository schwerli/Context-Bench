{
    "instance_id": "SWE-PolyBench__javascript__maintenance__bugfix__108b2d38",
    "original_id": "prettier__prettier-14400",
    "1_model_selected_files": [
        "src/language-html/embed.js",
        "src/language-html/print/children.js",
        "src/language-html/get-node-content.js",
        "src/language-html/print/element.js",
        "src/language-html/printer-html.js"
    ],
    "2_embedding_selected_files": [
        "src/language-html/print-preprocess.js",
        "src/language-html/print/element.js",
        "src/language-html/printer-html.js",
        "src/language-js/embed/html.js",
        "src/language-html/embed.js",
        "src/language-html/print/tag.js",
        "src/language-html/syntax-attribute.js",
        "src/language-css/printer-postcss.js",
        "src/language-js/print/jsx.js",
        "src/language-css/print/comma-separated-value-group.js",
        "website/playground/PrettierFormat.js",
        "src/language-html/utils/index.js",
        "src/language-html/parser-html.js",
        "src/language-html/conditional-comment.js",
        "src/language-handlebars/printer-glimmer.js",
        "src/language-css/print/parenthesized-value-group.js",
        "src/language-handlebars/parser-glimmer.js",
        "src/main/multiparser.js",
        "src/language-js/embed/css.js",
        "src/language-yaml/printer-yaml.js",
        "src/language-markdown/printer-markdown.js",
        "src/language-html/clean.js",
        "website/playground/markdown.js",
        "src/language-html/get-node-content.js",
        "src/language-css/utils/stringify-node.js",
        "src/main/core.js",
        "src/language-css/parse/parse-value.js",
        "src/language-js/parse/postprocess/index.js",
        "website/static/worker.js",
        "src/document/debug.js",
        "src/language-js/printer-estree.js",
        "src/main/ast-to-doc.js",
        "src/language-markdown/unified-plugins/html-to-jsx.js",
        "src/language-css/clean.js",
        "src/language-css/print/sequence.js",
        "src/cli/format.js",
        "src/language-html/print/children.js",
        "src/language-html/syntax-vue.js",
        "src/language-html/options.js",
        "src/language-js/print/html-binding.js",
        "src/language-handlebars/clean.js",
        "src/language-js/parse/meriyah.js",
        "src/language-css/parser-postcss.js",
        "src/language-js/embed/graphql.js",
        "src/document/printer.js",
        "src/language-js/print/angular.js",
        "src/language-js/print/binaryish.js",
        "src/language-yaml/print/flow-mapping-sequence.js",
        "src/language-html/index.js",
        "src/language-js/parse/typescript.js",
        "src/language-js/print/template-literal.js",
        "scripts/tools/eslint-plugin-prettier-internal-rules/no-empty-flat-contents-for-if-break.js",
        "src/language-markdown/print-whitespace.js",
        "src/language-markdown/print-preprocess.js",
        "src/language-yaml/embed.js",
        "src/language-graphql/printer-graphql.js",
        "src/language-js/print/semicolon.js"
    ],
    "3_final_combined_files": [
        "src/language-html/embed.js",
        "src/language-html/print/children.js",
        "src/language-html/get-node-content.js",
        "src/language-html/print-preprocess.js",
        "src/language-html/print/element.js",
        "src/language-html/printer-html.js"
    ],
    "4_related_elements": {
        "src/language-html/embed.js": [
            "function: embed"
        ],
        "src/language-html/print/children.js": [
            "function: printChildren\nfunction: printChild\nfunction: printBetweenLine"
        ],
        "src/language-html/get-node-content.js": [
            ""
        ]
    },
    "5_sampled_edit_locs_and_patches": [
        {
            "sample_index": 0,
            "edit_locs": {
                "src/language-html/embed.js": [
                    "function: embed\nline: 299\nline: 323\nline: 331"
                ],
                "src/language-html/print/children.js": [
                    "function: printChildren\nline: 142\nline: 153"
                ],
                "src/language-html/get-node-content.js": [
                    ""
                ]
            },
            "patches": [
                "diff --git a/src/language-html/embed.js b/src/language-html/embed.js\nindex 8f385a7..71cdfe3 100644\n--- a/src/language-html/embed.js\n+++ b/src/language-html/embed.js\n@@ -323,9 +323,13 @@ function embed(path, options) {\n             return [\n               breakParent,\n               printOpeningTagPrefix(node, options),\n-              await textToDoc(value, textToDocOptions, {\n-                stripTrailingHardline: true,\n-              }),\n+              indent([\n+                hardline,\n+                await textToDoc(value, textToDocOptions, {\n+                  stripTrailingHardline: true,\n+                }),\n+              ]),\n+              hardline,\n               printClosingTagSuffix(node, options),\n             ];\n           };\n@@ -424,4 +428,4 @@ function embed(path, options) {\n   }\n }\n \n-export default embed;\n+export default embed;\n",
                "diff --git a/src/language-html/embed.js b/src/language-html/embed.js\nindex 8f385a7..d9ff53d 100644\n--- a/src/language-html/embed.js\n+++ b/src/language-html/embed.js\n@@ -323,9 +323,11 @@ function embed(path, options) {\n             return [\n               breakParent,\n               printOpeningTagPrefix(node, options),\n+              hardline,\n               await textToDoc(value, textToDocOptions, {\n                 stripTrailingHardline: true,\n               }),\n+              hardline,\n               printClosingTagSuffix(node, options),\n             ];\n           };\n@@ -424,4 +426,4 @@ function embed(path, options) {\n   }\n }\n \n-export default embed;\n+export default embed;\n"
            ]
        },
        {
            "sample_index": 1,
            "edit_locs": {
                "src/language-html/embed.js": [
                    "function: embed"
                ],
                "src/language-html/print/children.js": [
                    ""
                ],
                "src/language-html/get-node-content.js": [
                    ""
                ]
            },
            "patches": [
                "diff --git a/src/language-html/embed.js b/src/language-html/embed.js\nindex 8f385a7..d351c76 100644\n--- a/src/language-html/embed.js\n+++ b/src/language-html/embed.js\n@@ -298,7 +298,22 @@ function embed(path, options) {\n \n     case \"text\":\n       if (isScriptLikeTag(node.parent)) {\n-        const parser = inferElementParser(node.parent, options);\n+        let parser = inferElementParser(node.parent, options);\n+        // Fallback for <script> inside <svg> when no parser is inferred.\n+        // In SVG, the default script type is application/ecmascript; if there's\n+        // no explicit type, inferElementParser may return null. In that case,\n+        // default to formatting as JavaScript to avoid reflowing code as plain text.\n+        if (\n+          !parser &&\n+          options.parser === \"html\" &&\n+          node.parent &&\n+          node.parent.parent &&\n+          node.parent.parent.name &&\n+          String(node.parent.parent.name).toLowerCase() === \"svg\"\n+        ) {\n+          parser = \"babel\";\n+        }\n+\n         if (parser) {\n           return async (textToDoc) => {\n             const value =\n@@ -424,4 +439,4 @@ function embed(path, options) {\n   }\n }\n \n-export default embed;\n+export default embed;\n",
                "diff --git a/src/language-html/embed.js b/src/language-html/embed.js\nindex 8f385a7..e15307b 100644\n--- a/src/language-html/embed.js\n+++ b/src/language-html/embed.js\n@@ -298,7 +298,26 @@ function embed(path, options) {\n \n     case \"text\":\n       if (isScriptLikeTag(node.parent)) {\n-        const parser = inferElementParser(node.parent, options);\n+        let parser = inferElementParser(node.parent, options);\n+        if (!parser && options.parser === \"html\") {\n+          // In SVG, <script> without a recognized type should default to JavaScript\n+          // Fallback to \"babel\" when inside an <svg> tree\n+          let isInSvg = false;\n+          for (let ancestor = node.parent; ancestor; ancestor = ancestor.parent) {\n+            if (\n+              ancestor.type === \"element\" &&\n+              ancestor.name &&\n+              typeof ancestor.name === \"string\" &&\n+              ancestor.name.toLowerCase() === \"svg\"\n+            ) {\n+              isInSvg = true;\n+              break;\n+            }\n+          }\n+          if (isInSvg && node.parent.name === \"script\") {\n+            parser = \"babel\";\n+          }\n+        }\n         if (parser) {\n           return async (textToDoc) => {\n             const value =\n@@ -424,4 +443,4 @@ function embed(path, options) {\n   }\n }\n \n-export default embed;\n+export default embed;\n"
            ]
        }
    ],
    "6_final_selected_patch": "diff --git a/src/language-html/embed.js b/src/language-html/embed.js\nindex 8f385a7..71cdfe3 100644\n--- a/src/language-html/embed.js\n+++ b/src/language-html/embed.js\n@@ -323,9 +323,13 @@ function embed(path, options) {\n             return [\n               breakParent,\n               printOpeningTagPrefix(node, options),\n-              await textToDoc(value, textToDocOptions, {\n-                stripTrailingHardline: true,\n-              }),\n+              indent([\n+                hardline,\n+                await textToDoc(value, textToDocOptions, {\n+                  stripTrailingHardline: true,\n+                }),\n+              ]),\n+              hardline,\n               printClosingTagSuffix(node, options),\n             ];\n           };\n@@ -424,4 +428,4 @@ function embed(path, options) {\n   }\n }\n \n-export default embed;\n+export default embed;\n"
}