{
    "instance_id": "SWE-PolyBench__typescript__maintenance__bugfix__7dfdbbd1",
    "original_id": "mui__material-ui-19849",
    "1_model_selected_files": [
        "packages/material-ui-lab/src/TreeView/TreeView.js",
        "packages/material-ui-lab/src/TreeItem/TreeItem.js"
    ],
    "2_embedding_selected_files": [],
    "3_final_combined_files": [
        "packages/material-ui-lab/src/TreeView/TreeView.js",
        "packages/material-ui-lab/src/TreeItem/TreeItem.js"
    ],
    "4_related_elements": {
        "packages/material-ui-lab/src/TreeView/TreeView.js": [
            "function: TreeView\nvariable: childIds\nvariable: prevChildIds\nvariable: nodeMap\nvariable: firstCharMap\nvariable: visibleNodes\nfunction: buildVisible\nfunction: addNodeToNodeMap\nfunction: removeNodeFromNodeMap\nfunction: focusByFirstCharacter"
        ],
        "packages/material-ui-lab/src/TreeItem/TreeItem.js": [
            "function: TreeItem\nvariable: childIds\nvariable: expandable"
        ]
    },
    "5_sampled_edit_locs_and_patches": [
        {
            "sample_index": 0,
            "edit_locs": {
                "packages/material-ui-lab/src/TreeView/TreeView.js": [
                    "line: 420"
                ],
                "packages/material-ui-lab/src/TreeItem/TreeItem.js": [
                    "function: TreeItem"
                ]
            },
            "patches": [
                "diff --git a/packages/material-ui-lab/src/TreeView/TreeView.js b/packages/material-ui-lab/src/TreeView/TreeView.js\nindex ab649de..3b05327 100644\n--- a/packages/material-ui-lab/src/TreeView/TreeView.js\n+++ b/packages/material-ui-lab/src/TreeView/TreeView.js\n@@ -417,7 +417,11 @@ const TreeView = React.forwardRef(function TreeView(props, ref) {\n   const prevChildIds = React.useRef([]);\n   const [childrenCalculated, setChildrenCalculated] = React.useState(false);\n   React.useEffect(() => {\n-    const childIds = React.Children.map(children, child => child.props.nodeId) || [];\n+    const childIds =\n+      React.Children.toArray(children)\n+        .filter(child => React.isValidElement(child))\n+        .map(child => child.props && child.props.nodeId)\n+        .filter(id => id != null) || [];\n     if (arrayDiff(prevChildIds.current, childIds)) {\n       nodeMap.current[-1] = { parent: null, children: childIds };\n \n",
                "diff --git a/packages/material-ui-lab/src/TreeView/TreeView.js b/packages/material-ui-lab/src/TreeView/TreeView.js\nindex ab649de..7c880dd 100644\n--- a/packages/material-ui-lab/src/TreeView/TreeView.js\n+++ b/packages/material-ui-lab/src/TreeView/TreeView.js\n@@ -417,7 +417,12 @@ const TreeView = React.forwardRef(function TreeView(props, ref) {\n   const prevChildIds = React.useRef([]);\n   const [childrenCalculated, setChildrenCalculated] = React.useState(false);\n   React.useEffect(() => {\n-    const childIds = React.Children.map(children, child => child.props.nodeId) || [];\n+    const childIds = (React.Children.map(children, child => {\n+      if (!React.isValidElement(child)) {\n+        return null;\n+      }\n+      return child.props && child.props.nodeId != null ? child.props.nodeId : null;\n+    }) || []).filter(id => id != null);\n     if (arrayDiff(prevChildIds.current, childIds)) {\n       nodeMap.current[-1] = { parent: null, children: childIds };\n \n"
            ]
        },
        {
            "sample_index": 1,
            "edit_locs": {
                "packages/material-ui-lab/src/TreeView/TreeView.js": [
                    "line: 421"
                ],
                "packages/material-ui-lab/src/TreeItem/TreeItem.js": [
                    "function: TreeItem"
                ]
            },
            "patches": [
                "diff --git a/packages/material-ui-lab/src/TreeView/TreeView.js b/packages/material-ui-lab/src/TreeView/TreeView.js\nindex ab649de..b5d1b5d 100644\n--- a/packages/material-ui-lab/src/TreeView/TreeView.js\n+++ b/packages/material-ui-lab/src/TreeView/TreeView.js\n@@ -417,7 +417,12 @@ const TreeView = React.forwardRef(function TreeView(props, ref) {\n   const prevChildIds = React.useRef([]);\n   const [childrenCalculated, setChildrenCalculated] = React.useState(false);\n   React.useEffect(() => {\n-    const childIds = React.Children.map(children, child => child.props.nodeId) || [];\n+    const childIds = [];\n+    React.Children.forEach(children, child => {\n+      if (React.isValidElement(child) && child.props && child.props.nodeId != null) {\n+        childIds.push(child.props.nodeId);\n+      }\n+    });\n     if (arrayDiff(prevChildIds.current, childIds)) {\n       nodeMap.current[-1] = { parent: null, children: childIds };\n \n",
                "diff --git a/packages/material-ui-lab/src/TreeView/TreeView.js b/packages/material-ui-lab/src/TreeView/TreeView.js\nindex ab649de..5d3049e 100644\n--- a/packages/material-ui-lab/src/TreeView/TreeView.js\n+++ b/packages/material-ui-lab/src/TreeView/TreeView.js\n@@ -417,7 +417,9 @@ const TreeView = React.forwardRef(function TreeView(props, ref) {\n   const prevChildIds = React.useRef([]);\n   const [childrenCalculated, setChildrenCalculated] = React.useState(false);\n   React.useEffect(() => {\n-    const childIds = React.Children.map(children, child => child.props.nodeId) || [];\n+    const childIds = React.Children.toArray(children)\n+      .filter(child => React.isValidElement(child) && child.type && child.type.muiName === 'MuiTreeItem')\n+      .map(child => child.props.nodeId);\n     if (arrayDiff(prevChildIds.current, childIds)) {\n       nodeMap.current[-1] = { parent: null, children: childIds };\n \n"
            ]
        }
    ],
    "6_final_selected_patch": "diff --git a/packages/material-ui-lab/src/TreeView/TreeView.js b/packages/material-ui-lab/src/TreeView/TreeView.js\nindex ab649de..3b05327 100644\n--- a/packages/material-ui-lab/src/TreeView/TreeView.js\n+++ b/packages/material-ui-lab/src/TreeView/TreeView.js\n@@ -417,7 +417,11 @@ const TreeView = React.forwardRef(function TreeView(props, ref) {\n   const prevChildIds = React.useRef([]);\n   const [childrenCalculated, setChildrenCalculated] = React.useState(false);\n   React.useEffect(() => {\n-    const childIds = React.Children.map(children, child => child.props.nodeId) || [];\n+    const childIds =\n+      React.Children.toArray(children)\n+        .filter(child => React.isValidElement(child))\n+        .map(child => child.props && child.props.nodeId)\n+        .filter(id => id != null) || [];\n     if (arrayDiff(prevChildIds.current, childIds)) {\n       nodeMap.current[-1] = { parent: null, children: childIds };\n \n"
}