{
    "instance_id": "SWE-PolyBench__python__maintenance__bugfix__84e0afe2",
    "original_id": "huggingface__transformers-24238",
    "1_model_selected_files": [
        "src/transformers/generation/configuration_utils.py"
    ],
    "2_embedding_selected_files": [],
    "3_final_combined_files": [
        "src/transformers/generation/configuration_utils.py"
    ],
    "4_related_elements": {
        "src/transformers/generation/configuration_utils.py": [
            "function: GenerationConfig.from_dict\nfunction: GenerationConfig.from_pretrained\nfunction: GenerationConfig.__init__\nfunction: GenerationConfig.update\nfunction: GenerationConfig._dict_from_json_file"
        ]
    },
    "5_sampled_edit_locs_and_patches": [
        {
            "sample_index": 0,
            "edit_locs": {
                "src/transformers/generation/configuration_utils.py": [
                    "function: GenerationConfig.from_dict\nline: 572\nline: 573\nline: 574\nline: 575\nline: 576"
                ]
            },
            "patches": [
                "diff --git a/src/transformers/generation/configuration_utils.py b/src/transformers/generation/configuration_utils.py\nindex 2273e60..ac12405 100644\n--- a/src/transformers/generation/configuration_utils.py\n+++ b/src/transformers/generation/configuration_utils.py\n@@ -569,9 +569,8 @@ class GenerationConfig(PushToHubMixin):\n         if \"_commit_hash\" in kwargs and \"_commit_hash\" in config_dict:\n             kwargs[\"_commit_hash\"] = config_dict[\"_commit_hash\"]\n \n-        # remove all the arguments that are in the config_dict\n-\n-        config = cls(**config_dict, **kwargs)\n+        # Initialize from the config_dict, then apply any overrides via `update` to avoid duplicate kwargs in `__init__`.\n+        config = cls(**config_dict)\n         unused_kwargs = config.update(**kwargs)\n \n         logger.info(f\"Generate config {config}\")\n",
                "diff --git a/src/transformers/generation/configuration_utils.py b/src/transformers/generation/configuration_utils.py\nindex 2273e60..38f9f39 100644\n--- a/src/transformers/generation/configuration_utils.py\n+++ b/src/transformers/generation/configuration_utils.py\n@@ -569,9 +569,12 @@ class GenerationConfig(PushToHubMixin):\n         if \"_commit_hash\" in kwargs and \"_commit_hash\" in config_dict:\n             kwargs[\"_commit_hash\"] = config_dict[\"_commit_hash\"]\n \n-        # remove all the arguments that are in the config_dict\n+        # Merge kwargs into a copy of config_dict so that overrides work without passing duplicate kwargs.\n+        # Note: _commit_hash precedence was handled above.\n+        config_dict_copy = dict(config_dict)\n+        config_dict_copy.update(kwargs)\n \n-        config = cls(**config_dict, **kwargs)\n+        config = cls(**config_dict_copy)\n         unused_kwargs = config.update(**kwargs)\n \n         logger.info(f\"Generate config {config}\")\n"
            ]
        },
        {
            "sample_index": 1,
            "edit_locs": {
                "src/transformers/generation/configuration_utils.py": [
                    "function: GenerationConfig.from_dict\nline: 572\nline: 574\nline: 575\nline: 576"
                ]
            },
            "patches": [
                "diff --git a/src/transformers/generation/configuration_utils.py b/src/transformers/generation/configuration_utils.py\nindex 2273e60..ed01ddd 100644\n--- a/src/transformers/generation/configuration_utils.py\n+++ b/src/transformers/generation/configuration_utils.py\n@@ -569,9 +569,8 @@ class GenerationConfig(PushToHubMixin):\n         if \"_commit_hash\" in kwargs and \"_commit_hash\" in config_dict:\n             kwargs[\"_commit_hash\"] = config_dict[\"_commit_hash\"]\n \n-        # remove all the arguments that are in the config_dict\n-\n-        config = cls(**config_dict, **kwargs)\n+        # Instantiate from the base dict only to avoid passing duplicate kwargs; then apply overrides via `update`.\n+        config = cls(**config_dict)\n         unused_kwargs = config.update(**kwargs)\n \n         logger.info(f\"Generate config {config}\")\n",
                "diff --git a/src/transformers/generation/configuration_utils.py b/src/transformers/generation/configuration_utils.py\nindex 2273e60..92b71a0 100644\n--- a/src/transformers/generation/configuration_utils.py\n+++ b/src/transformers/generation/configuration_utils.py\n@@ -569,10 +569,16 @@ class GenerationConfig(PushToHubMixin):\n         if \"_commit_hash\" in kwargs and \"_commit_hash\" in config_dict:\n             kwargs[\"_commit_hash\"] = config_dict[\"_commit_hash\"]\n \n-        # remove all the arguments that are in the config_dict\n-\n-        config = cls(**config_dict, **kwargs)\n-        unused_kwargs = config.update(**kwargs)\n+        # Merge the config_dict with kwargs, letting kwargs override values present in config_dict.\n+        # Only pass non-overlapping kwargs to `update` to avoid passing duplicate keys to the initializer.\n+        init_kwargs = dict(config_dict)\n+        overlapping_keys = set(init_kwargs.keys()) & set(kwargs.keys())\n+        for key in overlapping_keys:\n+            init_kwargs[key] = kwargs[key]\n+        extra_kwargs = {k: v for k, v in kwargs.items() if k not in init_kwargs}\n+\n+        config = cls(**init_kwargs)\n+        unused_kwargs = config.update(**extra_kwargs)\n \n         logger.info(f\"Generate config {config}\")\n         if return_unused_kwargs:\n"
            ]
        }
    ],
    "6_final_selected_patch": "diff --git a/src/transformers/generation/configuration_utils.py b/src/transformers/generation/configuration_utils.py\nindex 2273e60..ac12405 100644\n--- a/src/transformers/generation/configuration_utils.py\n+++ b/src/transformers/generation/configuration_utils.py\n@@ -569,9 +569,8 @@ class GenerationConfig(PushToHubMixin):\n         if \"_commit_hash\" in kwargs and \"_commit_hash\" in config_dict:\n             kwargs[\"_commit_hash\"] = config_dict[\"_commit_hash\"]\n \n-        # remove all the arguments that are in the config_dict\n-\n-        config = cls(**config_dict, **kwargs)\n+        # Initialize from the config_dict, then apply any overrides via `update` to avoid duplicate kwargs in `__init__`.\n+        config = cls(**config_dict)\n         unused_kwargs = config.update(**kwargs)\n \n         logger.info(f\"Generate config {config}\")\n"
}