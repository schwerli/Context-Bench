{
    "instance_id": "SWE-PolyBench__javascript__maintenance__bugfix__d1cb6b19",
    "original_id": "sveltejs__svelte-1923",
    "1_model_selected_files": [
        "src/compile/Component.ts"
    ],
    "2_embedding_selected_files": [
        "src/compile/render-dom/wrappers/InlineComponent/index.ts",
        "src/compile/render-dom/wrappers/Element/Binding.ts",
        "src/compile/render-dom/wrappers/EachBlock.ts",
        "src/compile/render-dom/wrappers/shared/addEventHandlers.ts",
        "src/internal/keyed-each.js",
        "src/compile/nodes/shared/Expression.ts",
        "src/compile/render-ssr/handlers/EachBlock.ts",
        "src/compile/nodes/Element.ts",
        "src/internal/Component.js",
        "src/compile/Component.ts",
        "src/compile/render-dom/index.ts",
        "src/compile/render-dom/wrappers/Element/index.ts",
        "src/internal/lifecycle.js",
        "src/compile/nodes/EachBlock.ts",
        "src/parse/state/mustache.ts",
        "src/compile/render-dom/wrappers/Window.ts",
        "src/compile/nodes/EventHandler.ts",
        "src/compile/render-dom/wrappers/Element/Attribute.ts",
        "src/compile/render-ssr/handlers/Element.ts",
        "src/compile/render-ssr/handlers/InlineComponent.ts",
        "site/static/workers/bundler.js",
        "src/internal/await-block.js",
        "src/internal/scheduler.js",
        "src/compile/nodes/InlineComponent.ts",
        "site/static/curl.js",
        "src/internal/ssr.js",
        "src/compile/nodes/Binding.ts",
        "src/compile/render-ssr/Renderer.ts",
        "site/src/routes/repl/_components/events.js",
        "site/static/workers/compiler.js",
        "site/content/examples/immutable/flash.js",
        "src/compile/nodes/Window.ts",
        "src/compile/render-dom/wrappers/shared/addActions.ts",
        "src/compile/render-dom/Block.ts",
        "src/internal/utils.js",
        "src/internal/dom.js",
        "src/compile/render-dom/wrappers/RawMustacheTag.ts",
        "src/compile/render-dom/wrappers/MustacheTag.ts",
        "src/compile/render-dom/wrappers/AwaitBlock.ts",
        "src/compile/render-dom/wrappers/IfBlock.ts",
        "src/compile/render-dom/wrappers/Slot.ts",
        "src/internal/index.js",
        "src/compile/render-dom/wrappers/Element/StyleAttribute.ts",
        "src/compile/render-ssr/handlers/HtmlTag.ts",
        "src/parse/state/tag.ts",
        "src/compile/render-dom/wrappers/shared/Tag.ts",
        "site/src/routes/guide/_sections.js",
        "src/compile/render-ssr/handlers/Tag.ts",
        "src/internal/transitions.js",
        "src/compile/render-ssr/handlers/DebugTag.ts",
        "src/utils/annotateWithScopes.ts",
        "src/internal/spread.js",
        "src/compile/render-dom/wrappers/Fragment.ts",
        "src/compile/render-ssr/handlers/Text.ts",
        "src/compile/render-ssr/handlers/Slot.ts",
        "site/src/routes/repl/_components/_codemirror.js"
    ],
    "3_final_combined_files": [
        "src/compile/Component.ts",
        "src/compile/render-dom/wrappers/InlineComponent/index.ts",
        "src/compile/render-dom/wrappers/Element/Binding.ts",
        "src/compile/render-dom/wrappers/EachBlock.ts"
    ],
    "4_related_elements": {
        "src/compile/render-dom/wrappers/Element/Binding.ts": [
            "class: BindingWrapper\nfunction: getEventHandler\nfunction: BindingWrapper.munge"
        ],
        "src/compile/Component.ts": [
            "function: Component.getUniqueName\nfunction: Component.getUniqueNameMaker"
        ],
        "src/compile/render-dom/wrappers/InlineComponent/index.ts": [
            ""
        ]
    },
    "5_sampled_edit_locs_and_patches": [
        {
            "sample_index": 0,
            "edit_locs": {
                "src/compile/render-dom/wrappers/Element/Binding.ts": [
                    "function: BindingWrapper.munge\nfunction: getEventHandler"
                ],
                "src/compile/Component.ts": [
                    "function: getUniqueName"
                ],
                "src/compile/render-dom/wrappers/InlineComponent/index.ts": [
                    ""
                ]
            },
            "patches": [
                "diff --git a/src/compile/Component.ts b/src/compile/Component.ts\nindex e8e70df..483482f 100644\n--- a/src/compile/Component.ts\n+++ b/src/compile/Component.ts\n@@ -1,3 +1,4 @@\n+\n import MagicString, { Bundle } from 'magic-string';\n import { walk, childKeys } from 'estree-walker';\n import { getLocator } from 'locate-character';\n@@ -331,6 +332,8 @@ export default class Component {\n \t\t\t\talias = `${name}_${i++}`\n \t\t\t);\n \t\t\tlocalUsedNames.add(alias);\n+\t\t\t// Ensure names generated with the local maker are globally tracked as well\n+\t\t\tthis.usedNames.add(alias);\n \t\t\treturn alias;\n \t\t};\n \t}\n@@ -1052,4 +1055,4 @@ function process_meta(component, nodes) {\n \t}\n \n \treturn meta;\n-}\n+}\n",
                "diff --git a/src/compile/Component.ts b/src/compile/Component.ts\nindex e8e70df..feb407f 100644\n--- a/src/compile/Component.ts\n+++ b/src/compile/Component.ts\n@@ -330,6 +330,7 @@ export default class Component {\n \t\t\t\tlocalUsedNames.has(alias);\n \t\t\t\talias = `${name}_${i++}`\n \t\t\t);\n+\t\t\tthis.usedNames.add(alias);\n \t\t\tlocalUsedNames.add(alias);\n \t\t\treturn alias;\n \t\t};\n"
            ]
        },
        {
            "sample_index": 1,
            "edit_locs": {
                "src/compile/Component.ts": [
                    "function: Component.getUniqueNameMaker\nline: 333"
                ],
                "src/compile/render-dom/wrappers/InlineComponent/index.ts": [
                    ""
                ],
                "src/compile/render-dom/wrappers/Element/Binding.ts": [
                    ""
                ]
            },
            "patches": [
                "diff --git a/src/compile/Component.ts b/src/compile/Component.ts\nindex e8e70df..2492fc8 100644\n--- a/src/compile/Component.ts\n+++ b/src/compile/Component.ts\n@@ -1,3 +1,4 @@\n+\n import MagicString, { Bundle } from 'magic-string';\n import { walk, childKeys } from 'estree-walker';\n import { getLocator } from 'locate-character';\n@@ -330,7 +331,10 @@ export default class Component {\n \t\t\t\tlocalUsedNames.has(alias);\n \t\t\t\talias = `${name}_${i++}`\n \t\t\t);\n+\t\t\t// Reserve the generated alias both locally and globally to avoid collisions\n+\t\t\t// across different blocks (e.g., event handlers inside and outside {#each}).\n \t\t\tlocalUsedNames.add(alias);\n+\t\t\tthis.usedNames.add(alias);\n \t\t\treturn alias;\n \t\t};\n \t}\n@@ -1052,4 +1056,4 @@ function process_meta(component, nodes) {\n \t}\n \n \treturn meta;\n-}\n+}\n",
                "diff --git a/src/compile/Component.ts b/src/compile/Component.ts\nindex e8e70df..cfe6df0 100644\n--- a/src/compile/Component.ts\n+++ b/src/compile/Component.ts\n@@ -331,6 +331,7 @@ export default class Component {\n \t\t\t\talias = `${name}_${i++}`\n \t\t\t);\n \t\t\tlocalUsedNames.add(alias);\n+\t\t\tthis.usedNames.add(alias);\n \t\t\treturn alias;\n \t\t};\n \t}\n"
            ]
        }
    ],
    "6_final_selected_patch": "diff --git a/src/compile/Component.ts b/src/compile/Component.ts\nindex e8e70df..483482f 100644\n--- a/src/compile/Component.ts\n+++ b/src/compile/Component.ts\n@@ -1,3 +1,4 @@\n+\n import MagicString, { Bundle } from 'magic-string';\n import { walk, childKeys } from 'estree-walker';\n import { getLocator } from 'locate-character';\n@@ -331,6 +332,8 @@ export default class Component {\n \t\t\t\talias = `${name}_${i++}`\n \t\t\t);\n \t\t\tlocalUsedNames.add(alias);\n+\t\t\t// Ensure names generated with the local maker are globally tracked as well\n+\t\t\tthis.usedNames.add(alias);\n \t\t\treturn alias;\n \t\t};\n \t}\n@@ -1052,4 +1055,4 @@ function process_meta(component, nodes) {\n \t}\n \n \treturn meta;\n-}\n+}\n"
}