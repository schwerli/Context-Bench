{
    "instance_id": "SWE-PolyBench__typescript__maintenance__bugfix__48e5846a",
    "original_id": "mui__material-ui-23229",
    "1_model_selected_files": [
        "packages/material-ui/src/Autocomplete/Autocomplete.js",
        "packages/material-ui/src/useAutocomplete/useAutocomplete.js",
        "packages/material-ui-lab/src/Autocomplete/Autocomplete.js",
        "packages/material-ui/src/InputAdornment/InputAdornment.js"
    ],
    "2_embedding_selected_files": [],
    "3_final_combined_files": [
        "packages/material-ui/src/Autocomplete/Autocomplete.js",
        "packages/material-ui/src/useAutocomplete/useAutocomplete.js",
        "packages/material-ui-lab/src/Autocomplete/Autocomplete.js"
    ],
    "4_related_elements": {
        "packages/material-ui/src/useAutocomplete/useAutocomplete.js": [
            "function: useAutocomplete\nfunction: getRootProps\nfunction: getInputProps\nfunction: handleClick\nfunction: handleMouseDown\nfunction: handleInputMouseDown\nfunction: handleOpen\nfunction: handlePopupIndicator\nvariable: open\nvariable: inputValue\nvariable: id"
        ],
        "packages/material-ui/src/Autocomplete/Autocomplete.js": [
            "function: Autocomplete\nfunction: styles"
        ],
        "packages/material-ui-lab/src/Autocomplete/Autocomplete.js": [
            ""
        ]
    },
    "5_sampled_edit_locs_and_patches": [
        {
            "sample_index": 0,
            "edit_locs": {
                "packages/material-ui/src/useAutocomplete/useAutocomplete.js": [
                    "function: handleClick\nline: 883\nline: 884\nline: 885\nline: 886\nline: 887\nline: 888\nline: 889\nline: 890\nline: 891\nline: 892\nline: 893\nline: 894\nline: 895"
                ],
                "packages/material-ui/src/Autocomplete/Autocomplete.js": [
                    ""
                ],
                "packages/material-ui-lab/src/Autocomplete/Autocomplete.js": [
                    ""
                ]
            },
            "patches": [
                "diff --git a/packages/material-ui/src/useAutocomplete/useAutocomplete.js b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\nindex f70c10c..009a604 100644\n--- a/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n+++ b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n@@ -1,3 +1,4 @@\n+\n /* eslint-disable no-constant-condition */\n import * as React from 'react';\n import { setRef, useEventCallback, useControlled, unstable_useId as useId } from '../utils';\n@@ -880,7 +881,7 @@ export default function useAutocomplete(props) {\n   };\n \n   // Focus the input when interacting with the combobox\n-  const handleClick = () => {\n+  const handleClick = (event) => {\n     inputRef.current.focus();\n \n     if (\n@@ -892,6 +893,12 @@ export default function useAutocomplete(props) {\n     }\n \n     firstFocus.current = false;\n+\n+    // Open the popup when clicking anywhere inside the combobox root,\n+    // so that there's no \"deadzone\" between the input and endAdornment.\n+    if (!open) {\n+      handleOpen(event);\n+    }\n   };\n \n   const handleInputMouseDown = (event) => {\n@@ -973,11 +980,19 @@ export default function useAutocomplete(props) {\n     }),\n     getClearProps: () => ({\n       tabIndex: -1,\n-      onClick: handleClear,\n+      onClick: (event) => {\n+        // Avoid triggering root onClick when clicking the clear button\n+        event.stopPropagation();\n+        handleClear(event);\n+      },\n     }),\n     getPopupIndicatorProps: () => ({\n       tabIndex: -1,\n-      onClick: handlePopupIndicator,\n+      onClick: (event) => {\n+        // Avoid triggering root onClick when clicking the popup indicator\n+        event.stopPropagation();\n+        handlePopupIndicator(event);\n+      },\n     }),\n     getTagProps: ({ index }) => ({\n       key: index,\n@@ -1025,4 +1040,4 @@ export default function useAutocomplete(props) {\n     focusedTag,\n     groupedOptions,\n   };\n-}\n+}\n",
                "diff --git a/packages/material-ui/src/useAutocomplete/useAutocomplete.js b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\nindex f70c10c..9cda5fe 100644\n--- a/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n+++ b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n@@ -1,3 +1,4 @@\n+\n /* eslint-disable no-constant-condition */\n import * as React from 'react';\n import { setRef, useEventCallback, useControlled, unstable_useId as useId } from '../utils';\n@@ -880,7 +881,7 @@ export default function useAutocomplete(props) {\n   };\n \n   // Focus the input when interacting with the combobox\n-  const handleClick = () => {\n+  const handleClick = (event) => {\n     inputRef.current.focus();\n \n     if (\n@@ -892,6 +893,18 @@ export default function useAutocomplete(props) {\n     }\n \n     firstFocus.current = false;\n+\n+    // Open the popup when clicking anywhere inside the component (e.g., between label and adornments)\n+    // but avoid double-toggling when clicking directly on the input or on tags/indicators.\n+    if (event && event.target && event.target.getAttribute('id') !== id) {\n+      // Don't open when clicking on a selected tag\n+      if (event.target.closest && event.target.closest('[data-tag-index]')) {\n+        return;\n+      }\n+      if (!open) {\n+        handleOpen(event);\n+      }\n+    }\n   };\n \n   const handleInputMouseDown = (event) => {\n@@ -973,11 +986,21 @@ export default function useAutocomplete(props) {\n     }),\n     getClearProps: () => ({\n       tabIndex: -1,\n-      onClick: handleClear,\n+      'data-clear-indicator': true,\n+      onClick: (event) => {\n+        // Prevent root click handler from also firing\n+        event.stopPropagation();\n+        handleClear(event);\n+      },\n     }),\n     getPopupIndicatorProps: () => ({\n       tabIndex: -1,\n-      onClick: handlePopupIndicator,\n+      'data-popup-indicator': true,\n+      onClick: (event) => {\n+        // Prevent root click handler from also firing\n+        event.stopPropagation();\n+        handlePopupIndicator(event);\n+      },\n     }),\n     getTagProps: ({ index }) => ({\n       key: index,\n@@ -1025,4 +1048,4 @@ export default function useAutocomplete(props) {\n     focusedTag,\n     groupedOptions,\n   };\n-}\n+}\n"
            ]
        },
        {
            "sample_index": 1,
            "edit_locs": {
                "packages/material-ui/src/useAutocomplete/useAutocomplete.js": [
                    "function: handleClick\nline: 883\nline: 895"
                ],
                "packages/material-ui/src/Autocomplete/Autocomplete.js": [
                    ""
                ],
                "packages/material-ui-lab/src/Autocomplete/Autocomplete.js": [
                    ""
                ]
            },
            "patches": [
                "diff --git a/packages/material-ui/src/useAutocomplete/useAutocomplete.js b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\nindex f70c10c..80c0184 100644\n--- a/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n+++ b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n@@ -1,3 +1,4 @@\n+\n /* eslint-disable no-constant-condition */\n import * as React from 'react';\n import { setRef, useEventCallback, useControlled, unstable_useId as useId } from '../utils';\n@@ -880,7 +881,7 @@ export default function useAutocomplete(props) {\n   };\n \n   // Focus the input when interacting with the combobox\n-  const handleClick = () => {\n+  const handleClick = (event) => {\n     inputRef.current.focus();\n \n     if (\n@@ -892,6 +893,20 @@ export default function useAutocomplete(props) {\n     }\n \n     firstFocus.current = false;\n+\n+    // Open the popup when clicking anywhere inside the combobox except on the input itself\n+    // or the clear/popup indicator buttons. This avoids a \"deadzone\" where clicks do nothing.\n+    const target = event && event.target ? event.target : null;\n+    const isOnInput =\n+      target && typeof target.getAttribute === 'function' && target.getAttribute('id') === id;\n+    const isOnPopupIndicator =\n+      target && typeof target.closest === 'function' && target.closest('[data-mui-autocomplete-popup-indicator]');\n+    const isOnClearIndicator =\n+      target && typeof target.closest === 'function' && target.closest('[data-mui-autocomplete-clear-indicator]');\n+\n+    if (!isOnInput && !isOnPopupIndicator && !isOnClearIndicator && !open) {\n+      handleOpen(event);\n+    }\n   };\n \n   const handleInputMouseDown = (event) => {\n@@ -974,10 +989,12 @@ export default function useAutocomplete(props) {\n     getClearProps: () => ({\n       tabIndex: -1,\n       onClick: handleClear,\n+      'data-mui-autocomplete-clear-indicator': true,\n     }),\n     getPopupIndicatorProps: () => ({\n       tabIndex: -1,\n       onClick: handlePopupIndicator,\n+      'data-mui-autocomplete-popup-indicator': true,\n     }),\n     getTagProps: ({ index }) => ({\n       key: index,\n@@ -1025,4 +1042,4 @@ export default function useAutocomplete(props) {\n     focusedTag,\n     groupedOptions,\n   };\n-}\n+}\n",
                "diff --git a/packages/material-ui/src/useAutocomplete/useAutocomplete.js b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\nindex f70c10c..3759bcc 100644\n--- a/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n+++ b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n@@ -1,3 +1,4 @@\n+\n /* eslint-disable no-constant-condition */\n import * as React from 'react';\n import { setRef, useEventCallback, useControlled, unstable_useId as useId } from '../utils';\n@@ -643,6 +644,10 @@ export default function useAutocomplete(props) {\n   };\n \n   const handleClear = (event) => {\n+    // Prevent root click handlers from triggering (e.g. opening the popup)\n+    if (event && typeof event.stopPropagation === 'function') {\n+      event.stopPropagation();\n+    }\n     ignoreFocus.current = true;\n     setInputValueState('');\n \n@@ -865,6 +870,10 @@ export default function useAutocomplete(props) {\n   };\n \n   const handlePopupIndicator = (event) => {\n+    // Don't let this click bubble to the root which could cause a second toggle.\n+    if (event && typeof event.stopPropagation === 'function') {\n+      event.stopPropagation();\n+    }\n     if (open) {\n       handleClose(event, 'toggleInput');\n     } else {\n@@ -880,7 +889,7 @@ export default function useAutocomplete(props) {\n   };\n \n   // Focus the input when interacting with the combobox\n-  const handleClick = () => {\n+  const handleClick = (event) => {\n     inputRef.current.focus();\n \n     if (\n@@ -891,6 +900,11 @@ export default function useAutocomplete(props) {\n       inputRef.current.select();\n     }\n \n+    // If the click is not on the input itself, open the popup when closed.\n+    if (event && event.target && event.target.getAttribute('id') !== id && !open) {\n+      handleOpen(event);\n+    }\n+\n     firstFocus.current = false;\n   };\n \n@@ -1025,4 +1039,4 @@ export default function useAutocomplete(props) {\n     focusedTag,\n     groupedOptions,\n   };\n-}\n+}\n"
            ]
        }
    ],
    "6_final_selected_patch": "diff --git a/packages/material-ui/src/useAutocomplete/useAutocomplete.js b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\nindex f70c10c..009a604 100644\n--- a/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n+++ b/packages/material-ui/src/useAutocomplete/useAutocomplete.js\n@@ -1,3 +1,4 @@\n+\n /* eslint-disable no-constant-condition */\n import * as React from 'react';\n import { setRef, useEventCallback, useControlled, unstable_useId as useId } from '../utils';\n@@ -880,7 +881,7 @@ export default function useAutocomplete(props) {\n   };\n \n   // Focus the input when interacting with the combobox\n-  const handleClick = () => {\n+  const handleClick = (event) => {\n     inputRef.current.focus();\n \n     if (\n@@ -892,6 +893,12 @@ export default function useAutocomplete(props) {\n     }\n \n     firstFocus.current = false;\n+\n+    // Open the popup when clicking anywhere inside the combobox root,\n+    // so that there's no \"deadzone\" between the input and endAdornment.\n+    if (!open) {\n+      handleOpen(event);\n+    }\n   };\n \n   const handleInputMouseDown = (event) => {\n@@ -973,11 +980,19 @@ export default function useAutocomplete(props) {\n     }),\n     getClearProps: () => ({\n       tabIndex: -1,\n-      onClick: handleClear,\n+      onClick: (event) => {\n+        // Avoid triggering root onClick when clicking the clear button\n+        event.stopPropagation();\n+        handleClear(event);\n+      },\n     }),\n     getPopupIndicatorProps: () => ({\n       tabIndex: -1,\n-      onClick: handlePopupIndicator,\n+      onClick: (event) => {\n+        // Avoid triggering root onClick when clicking the popup indicator\n+        event.stopPropagation();\n+        handlePopupIndicator(event);\n+      },\n     }),\n     getTagProps: ({ index }) => ({\n       key: index,\n@@ -1025,4 +1040,4 @@ export default function useAutocomplete(props) {\n     focusedTag,\n     groupedOptions,\n   };\n-}\n+}\n"
}