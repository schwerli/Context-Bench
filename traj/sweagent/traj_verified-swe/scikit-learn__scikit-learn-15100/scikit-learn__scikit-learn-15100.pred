{"model_name_or_path": "output", "instance_id": "scikit-learn__scikit-learn-15100", "model_patch": "diff --git a/repro_strip_accents.py b/repro_strip_accents.py\nnew file mode 100644\nindex 000000000..123df3b86\n--- /dev/null\n+++ b/repro_strip_accents.py\n@@ -0,0 +1,18 @@\n+from sklearn.feature_extraction.text import strip_accents_unicode\n+import unicodedata\n+\n+# s1: precomposed \u00f1 (U+00F1)\n+s1 = chr(241)\n+# s2: decomposed n + combining tilde (U+006E U+0303)\n+s2 = chr(110) + chr(771)\n+\n+print('s1:', s1, [hex(ord(c)) for c in s1])\n+print('s2:', s2, [hex(ord(c)) for c in s2])\n+\n+print('normalized s1 equals original?', unicodedata.normalize('NFKD', s1) == s1)\n+print('normalized s2 equals original?', unicodedata.normalize('NFKD', s2) == s2)\n+\n+print('strip_accents_unicode(s1):', strip_accents_unicode(s1))\n+print('strip_accents_unicode(s2):', strip_accents_unicode(s2))\n+print('Expected both to be \"n\"')\n+print('Does s2 remain unchanged?', strip_accents_unicode(s2) == s2)\ndiff --git a/sklearn/feature_extraction/text.py b/sklearn/feature_extraction/text.py\nindex bb5a9d646..d3f87b2dd 100644\n--- a/sklearn/feature_extraction/text.py\n+++ b/sklearn/feature_extraction/text.py\n@@ -129,11 +129,14 @@ def strip_accents_unicode(s):\n         Remove accentuated char for any unicode symbol that has a direct\n         ASCII equivalent.\n     \"\"\"\n+    # Always normalize to NFKD and then remove combining characters.\n+    # Previously, this function returned the input unchanged if it was already\n+    # in NFKD form. That behavior failed to strip accents for strings that were\n+    # decomposed (e.g., \"n\" + combining tilde). By consistently filtering out\n+    # combining marks, we ensure both precomposed and decomposed forms are\n+    # normalized to their simple counterparts.\n     normalized = unicodedata.normalize('NFKD', s)\n-    if normalized == s:\n-        return s\n-    else:\n-        return ''.join([c for c in normalized if not unicodedata.combining(c)])\n+    return ''.join(c for c in normalized if not unicodedata.combining(c))\n \n \n def strip_accents_ascii(s):\n"}