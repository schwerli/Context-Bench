diff --git a/astropy/io/fits/diff.py b/astropy/io/fits/diff.py
index 100cdf1b8..52c8177be 100644
--- a/astropy/io/fits/diff.py
+++ b/astropy/io/fits/diff.py
@@ -1449,17 +1449,27 @@ class TableDataDiff(_BaseDiff):
                 arrb.dtype, np.floating
             ):
                 diffs = where_not_allclose(arra, arrb, rtol=self.rtol, atol=self.atol)
-            elif "P" in col.format:
-                diffs = (
-                    [
-                        idx
-                        for idx in range(len(arra))
-                        if not np.allclose(
-                            arra[idx], arrb[idx], rtol=self.rtol, atol=self.atol
-                        )
-                    ],
-                )
+            elif (col.format and ("P" in col.format or "Q" in col.format)):
+                # For variable-length array columns (P = 32-bit descriptor,
+                # Q = 64-bit descriptor), compare per-row arrays to avoid
+                # ambiguous truth values and handle differing lengths.
+                diff_indices = []
+                for idx in range(len(arra)):
+                    a_row = arra[idx]
+                    b_row = arrb[idx]
+                    try:
+                        equal = np.allclose(a_row, b_row, rtol=self.rtol, atol=self.atol)
+                    except Exception:
+                        # Fallback for non-numeric or shape-mismatched arrays
+                        try:
+                            equal = np.array_equal(a_row, b_row)
+                        except Exception:
+                            equal = (a_row == b_row)
+                    if not equal:
+                        diff_indices.append(idx)
+                diffs = (diff_indices,)
             else:
+                # For non-VLA columns, use vectorized comparison.
                 diffs = np.where(arra != arrb)
 
             self.diff_total += len(set(diffs[0]))
diff --git a/diffbug.fits b/diffbug.fits
new file mode 100644
index 000000000..fb6df78b7
Binary files /dev/null and b/diffbug.fits differ
diff --git a/diffbug_p.fits b/diffbug_p.fits
new file mode 100644
index 000000000..67693752e
Binary files /dev/null and b/diffbug_p.fits differ
diff --git a/repro_vla_diff.py b/repro_vla_diff.py
new file mode 100644
index 000000000..0b14459eb
--- /dev/null
+++ b/repro_vla_diff.py
@@ -0,0 +1,6 @@
+from astropy.io import fits
+col = fits.Column(name='a', format='QD', array=[[0], [0, 0]])
+hdu = fits.BinTableHDU.from_columns([col])
+hdu.writeto('diffbug.fits', overwrite=True)
+print(fits.FITSDiff('diffbug.fits', 'diffbug.fits').identical)
+fits.printdiff('diffbug.fits', 'diffbug.fits')
diff --git a/vla_a.fits b/vla_a.fits
new file mode 100644
index 000000000..fb6df78b7
Binary files /dev/null and b/vla_a.fits differ
diff --git a/vla_b.fits b/vla_b.fits
new file mode 100644
index 000000000..e2c86f531
Binary files /dev/null and b/vla_b.fits differ
