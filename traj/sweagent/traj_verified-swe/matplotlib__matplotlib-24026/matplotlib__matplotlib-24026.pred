{"model_name_or_path": "output", "instance_id": "matplotlib__matplotlib-24026", "model_patch": "diff --git a/lib/matplotlib/stackplot.py b/lib/matplotlib/stackplot.py\nindex c580043eeb..23e825e6d8 100644\n--- a/lib/matplotlib/stackplot.py\n+++ b/lib/matplotlib/stackplot.py\n@@ -7,6 +7,7 @@ https://stackoverflow.com/q/2225995/\n \"\"\"\n \n import numpy as np\n+import itertools\n \n from matplotlib import _api\n \n@@ -69,8 +70,12 @@ def stackplot(axes, x, *args,\n     y = np.row_stack(args)\n \n     labels = iter(labels)\n+    # Do not modify the Axes property cycle; if colors are provided, use them\n+    # directly for the filled areas, cycling as necessary.\n     if colors is not None:\n-        axes.set_prop_cycle(color=colors)\n+        color_cycle = itertools.cycle([colors]) if isinstance(colors, str) else itertools.cycle(colors)\n+    else:\n+        color_cycle = None\n \n     # Assume data passed has not been 'stacked', so stack it here.\n     # We'll need a float buffer for the upcoming calculations.\n@@ -108,7 +113,7 @@ def stackplot(axes, x, *args,\n         stack += first_line\n \n     # Color between x = 0 and the first array.\n-    color = axes._get_lines.get_next_color()\n+    color = next(color_cycle) if color_cycle is not None else axes._get_lines.get_next_color()\n     coll = axes.fill_between(x, first_line, stack[0, :],\n                              facecolor=color, label=next(labels, None),\n                              **kwargs)\n@@ -117,7 +122,7 @@ def stackplot(axes, x, *args,\n \n     # Color between array i-1 and array i\n     for i in range(len(y) - 1):\n-        color = axes._get_lines.get_next_color()\n+        color = next(color_cycle) if color_cycle is not None else axes._get_lines.get_next_color()\n         r.append(axes.fill_between(x, stack[i, :], stack[i + 1, :],\n                                    facecolor=color, label=next(labels, None),\n                                    **kwargs))\ndiff --git a/tmp/repro_stackplot.py b/tmp/repro_stackplot.py\nnew file mode 100644\nindex 0000000000..588f090bee\n--- /dev/null\n+++ b/tmp/repro_stackplot.py\n@@ -0,0 +1,14 @@\n+import sys\n+sys.path.insert(0, \"/testbed/lib\")\n+\n+import matplotlib.pyplot as plt\n+from matplotlib.patches import Rectangle\n+import numpy as np\n+\n+my_data = np.array([[1, 1, 1], [1, 2, 3], [4, 3, 2]])\n+fig, ax = plt.subplots()\n+ax.plot([1, 3], [1, 3], color='C0')\n+ax.add_patch(Rectangle(xy=(1.5, 1.5), width=0.5, height=0.5, facecolor='C1'))\n+ax.stackplot([1, 2, 3], my_data, colors=['C2', 'C3', 'C4'])\n+plt.savefig('/testbed/tmp/stackplot.png')\n+print('Saved /testbed/tmp/stackplot.png')\ndiff --git a/tmp/stackplot.png b/tmp/stackplot.png\nnew file mode 100644\nindex 0000000000..7b5107118e\nBinary files /dev/null and b/tmp/stackplot.png differ\n"}