{"model_name_or_path": "output", "instance_id": "pydata__xarray-7233", "model_patch": "diff --git a/repro_coarsen_construct_coords.py b/repro_coarsen_construct_coords.py\nnew file mode 100644\nindex 00000000..d2e17d8f\n--- /dev/null\n+++ b/repro_coarsen_construct_coords.py\n@@ -0,0 +1,20 @@\n+import numpy as np\n+import xarray as xr\n+\n+# Build MVCE from PR\n+\n+da = xr.DataArray(np.arange(24), dims=[\"time\"])  # time is a bare dimension, not a coordinate\n+# non-dimensional coordinate depending on time\n+\n+da = da.assign_coords(day=365 * da)\n+\n+ds = da.to_dataset(name=\"T\")\n+\n+print(\"Original ds:\\n\", ds)\n+\n+result = ds.coarsen(time=12).construct(time=(\"year\", \"month\"))\n+\n+print(\"\\nResult of ds.coarsen(time=12).construct(time=(\\\"year\\\", \\\"month\\\")):\\n\", result)\n+\n+print(\"\\nIs 'day' still a coordinate?\", 'day' in result.coords)\n+print(\"Dims without coordinates:\", [d for d in result.dims if d not in result.coords])\ndiff --git a/repro_coarsen_construct_coords_edgecases.py b/repro_coarsen_construct_coords_edgecases.py\nnew file mode 100644\nindex 00000000..7019d2b4\n--- /dev/null\n+++ b/repro_coarsen_construct_coords_edgecases.py\n@@ -0,0 +1,27 @@\n+import numpy as np\n+import xarray as xr\n+\n+# Edge case: dataset with dimension coordinate 'x' and non-dim coord 'foo'\n+\n+x = np.arange(8)\n+foo = xr.DataArray(x**2, dims=[\"x\"], name=\"foo\")\n+\n+# DataArray with dimension coordinate 'x'\n+da = xr.DataArray(x, dims=[\"x\"], coords={\"x\": x}, name=\"a\")\n+# Add non-dim coord foo (depends on x)\n+da = da.assign_coords(foo=foo)\n+\n+print(\"Original da:\\n\", da)\n+\n+# Coarsen along x by 4 and construct\n+result_da = da.coarsen(x=4).construct(x=(\"block\", \"within\"))\n+print(\"\\nResult da after construct:\\n\", result_da)\n+print(\"Coords present:\", list(result_da.coords))\n+\n+# Dataset variant\n+\n+ds = da.to_dataset(name=\"a\")\n+print(\"\\nOriginal ds:\\n\", ds)\n+result_ds = ds.coarsen(x=4).construct(x=(\"block\", \"within\"))\n+print(\"\\nResult ds after construct:\\n\", result_ds)\n+print(\"Coords present:\", list(result_ds.coords))\ndiff --git a/xarray/core/rolling.py b/xarray/core/rolling.py\nindex c194ec08..e9eafcac 100644\n--- a/xarray/core/rolling.py\n+++ b/xarray/core/rolling.py\n@@ -973,7 +973,8 @@ class Coarsen(CoarsenArithmetic, Generic[T_Xarray]):\n             else:\n                 reshaped[key] = var\n \n-        should_be_coords = set(window_dim) & set(self.obj.coords)\n+        # Preserve all original non-dimensional coordinates as coordinates after construct\n+        should_be_coords = set(self.obj.coords)\n         result = reshaped.set_coords(should_be_coords)\n         if isinstance(self.obj, DataArray):\n             return self.obj._from_temp_dataset(result)\n"}