{"model_name_or_path": "output", "instance_id": "scikit-learn__scikit-learn-26194", "model_patch": "diff --git a/repro_roc_threshold.py b/repro_roc_threshold.py\nnew file mode 100644\nindex 000000000..8c2ede453\n--- /dev/null\n+++ b/repro_roc_threshold.py\n@@ -0,0 +1,17 @@\n+import numpy as np\n+from sklearn.metrics import roc_curve\n+\n+\n+def main():\n+    rng = np.random.RandomState(42)\n+    y_true = rng.randint(0, 2, size=100)\n+    y_score = rng.rand(100)\n+    fpr, tpr, thresholds = roc_curve(y_true, y_score)\n+    print(\"Thresholds head:\", thresholds[:5], \"... max:\", thresholds.max(), \"min:\", thresholds.min())\n+    assert thresholds.max() <= 1, \"Thresholds exceed 1 for probability estimates\"\n+    assert thresholds.min() >= 0, \"Thresholds below 0 for probability estimates\"\n+    print(\"Reproduction check passed: thresholds within [0, 1]\")\n+\n+\n+if __name__ == \"__main__\":\n+    main()\ndiff --git a/sklearn/metrics/_ranking.py b/sklearn/metrics/_ranking.py\nindex 0cdead923..1a0685a6f 100644\n--- a/sklearn/metrics/_ranking.py\n+++ b/sklearn/metrics/_ranking.py\n@@ -1083,7 +1083,13 @@ def roc_curve(\n     # to make sure that the curve starts at (0, 0)\n     tps = np.r_[0, tps]\n     fps = np.r_[0, fps]\n-    thresholds = np.r_[thresholds[0] + 1, thresholds]\n+    # When y_score are probability estimates in [0, 1], ensure the added\n+    # threshold does not exceed 1. Otherwise, keep the previous behavior of\n+    # using max(y_score) + 1.\n+    extra_threshold = thresholds[0] + 1\n+    if thresholds.max() <= 1 and thresholds.min() >= 0:\n+        extra_threshold = 1.0\n+    thresholds = np.r_[extra_threshold, thresholds]\n \n     if fps[-1] <= 0:\n         warnings.warn(\n"}