{"model_name_or_path": "output", "instance_id": "sympy__sympy-21847", "model_patch": "diff --git a/repro_itermonomials_bug.py b/repro_itermonomials_bug.py\nnew file mode 100644\nindex 0000000000..86e914422d\n--- /dev/null\n+++ b/repro_itermonomials_bug.py\n@@ -0,0 +1,18 @@\n+import sympy as sp\n+from sympy.polys.orderings import monomial_key\n+\n+x1, x2, x3 = sp.symbols('x1, x2, x3')\n+states = [x1, x2, x3]\n+max_degrees = 3\n+min_degrees = 3\n+monomials = sorted(sp.itermonomials(states, max_degrees, min_degrees=min_degrees), \n+                   key=monomial_key('grlex', states))\n+print(\"Monomials with min_degrees=3, max_degrees=3:\")\n+print(monomials)\n+\n+# Also test with max_degrees increased\n+max_degrees2 = 4\n+monomials2 = sorted(sp.itermonomials(states, max_degrees2, min_degrees=min_degrees), \n+                    key=monomial_key('grlex', states))\n+print(\"Monomials with min_degrees=3, max_degrees=4:\")\n+print(monomials2)\ndiff --git a/sympy/polys/monomials.py b/sympy/polys/monomials.py\nindex 0e84403307..373d498294 100644\n--- a/sympy/polys/monomials.py\n+++ b/sympy/polys/monomials.py\n@@ -127,7 +127,8 @@ def itermonomials(variables, max_degrees, min_degrees=None):\n                 for variable in item:\n                     if variable != 1:\n                         powers[variable] += 1\n-                if max(powers.values()) >= min_degree:\n+                # Use total degree for filtering rather than max exponent of a single variable\n+                if sum(powers.values()) >= min_degree:\n                     monomials_list_comm.append(Mul(*item))\n             yield from set(monomials_list_comm)\n         else:\n@@ -139,7 +140,8 @@ def itermonomials(variables, max_degrees, min_degrees=None):\n                 for variable in item:\n                     if variable != 1:\n                         powers[variable] += 1\n-                if max(powers.values()) >= min_degree:\n+                # Use total degree for filtering in the non-commutative case as well\n+                if sum(powers.values()) >= min_degree:\n                     monomials_list_non_comm.append(Mul(*item))\n             yield from set(monomials_list_non_comm)\n     else:\n"}