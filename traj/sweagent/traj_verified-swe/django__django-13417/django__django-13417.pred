{"model_name_or_path": "output", "instance_id": "django__django-13417", "model_patch": "diff --git a/django/db/models/query.py b/django/db/models/query.py\nindex 85cd8311a7..e47e5160d3 100644\n--- a/django/db/models/query.py\n+++ b/django/db/models/query.py\n@@ -1219,15 +1219,25 @@ class QuerySet:\n         \"\"\"\n         Return True if the QuerySet is ordered -- i.e. has an order_by()\n         clause or a default ordering on the model (or is empty).\n+\n+        For queries with GROUP BY, default model ordering is suppressed in SQL\n+        unless an explicit order_by() or extra(order_by=...) is provided.\n+        In such cases, ordered should be False.\n         \"\"\"\n         if isinstance(self, EmptyQuerySet):\n             return True\n+        # Explicit ordering always results in an ORDER BY clause.\n         if self.query.extra_order_by or self.query.order_by:\n             return True\n-        elif self.query.default_ordering and self.query.get_meta().ordering:\n-            return True\n-        else:\n+        # If the query performs grouping, default model ordering is not applied\n+        # to the SQL output (see compiler.as_sql()). Therefore, consider it\n+        # unordered in this case.\n+        if self.query.group_by is not None:\n             return False\n+        # Otherwise, respect the model's default ordering if present.\n+        if self.query.default_ordering and self.query.get_meta().ordering:\n+            return True\n+        return False\n \n     @property\n     def db(self):\ndiff --git a/repro_ordered_groupby.py b/repro_ordered_groupby.py\nnew file mode 100644\nindex 0000000000..6b5de0fd7d\n--- /dev/null\n+++ b/repro_ordered_groupby.py\n@@ -0,0 +1,34 @@\n+# Reproduction script for QuerySet.ordered with GROUP BY.\n+# It constructs a minimal fake model with Meta.ordering and a QuerySet\n+# whose underlying Query has group_by=True and no explicit order_by.\n+# Expected: ordered should be False when GROUP BY is present without explicit ordering.\n+# Current behavior (before fix): ordered is True due to default ordering.\n+\n+from django.db.models import sql\n+from django.db.models.query import QuerySet\n+\n+class Meta:\n+    ordering = ['name']\n+\n+class FakeModel:\n+    _meta = Meta()\n+\n+# Create a Query and set group_by=True to simulate annotation with aggregate\n+q = sql.Query(FakeModel)\n+q.group_by = True\n+# No explicit order_by set and default_ordering is True by default\n+\n+qs = QuerySet(model=FakeModel, query=q)\n+print(\"group_by:\", q.group_by)\n+print(\"default_ordering:\", q.default_ordering)\n+print(\"meta.ordering:\", q.get_meta().ordering)\n+print(\"explicit order_by:\", q.order_by)\n+print(\"explicit extra_order_by:\", q.extra_order_by)\n+print(\"QuerySet.ordered:\", qs.ordered)\n+\n+# Now simulate explicit ordering to ensure .ordered becomes True.\n+q2 = sql.Query(FakeModel)\n+q2.group_by = True\n+q2.order_by = ('num_notes',)\n+qs2 = QuerySet(model=FakeModel, query=q2)\n+print(\"With explicit order_by, QuerySet.ordered:\", qs2.ordered)\n"}